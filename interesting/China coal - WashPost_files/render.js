(function($,window){var core=window.wp_pb=window.wp_pb||{};var nav=core.nav=core.nav||{};var wpHeader={init:function(){if($("#page").hasClass("ie8"))return;else{if($("#pb-root .pb-f-page-header-v2").length){var $header=$(".pb-f-page-header-v2");$("#pb-root").before($header)}if(window.ActiveXObject||"ActiveXObject"in window){$("#main-sections-nav").addClass("ie");$("#wp-header").addClass("ie")}$("#sections-menu-off-canvas ul.side-nav li").each(function(){if($(this).hasClass("nav-screenreader-link"))return;
var item=$(this).find("\x3ea"),itemText=item.html().replace(/\s+/g,"").replace(/\&/g,"-").toLowerCase(),itemLink=item.attr("href");if($(this).hasClass("main-nav"))item.attr("href",itemLink+"?nid\x3dmenu_nav_"+itemText);else if($(this).hasClass("sub-nav-item")){var mainItem=$(this).parents(".main-nav").find("\x3ea").text().replace(/\s+/g,"").replace(/\&/g,"-").toLowerCase();item.attr("href",itemLink+"?nid\x3dmenu_nav_"+mainItem+"-"+itemText)}});$("#sections-menu-wide li").each(function(){var item=
$(this).find("a"),itemText=item.html().replace(/\s+/g,"").replace(/\&/g,"-").toLowerCase(),itemLink=item.attr("href");item.attr("href",itemLink+"?nid\x3dtop_nav_"+itemText)});(function(){var searchIconHovered;$("#search-btn").click(function(e){if($(this).hasClass("closed")){$(this).removeClass("closed").addClass("opened");$("#search-field").removeClass("closed").addClass("opened");$("#search-field").focus()}else if($(this).hasClass("opened"))$("#search-form").submit()});$("#search-btn").bind("mouseover",
function(){if($(this).hasClass("opened"))searchIconHovered=true}).bind("mouseout",function(){if($(this).hasClass("opened"))searchIconHovered=false});$("#search-field").blur(function(e){if($(this).hasClass("opened")&&!searchIconHovered){$(this).removeClass("opened").addClass("closed");$("#search-btn").removeClass("opened").addClass("closed")}});$("#search-form, #nav-search-mobile").submit(function(event){if($(this).find("input[type\x3dtext]").val()){try{s.sendDataToOmniture("Search Submit","event2",
{"eVar38":$(this).find("input[type\x3dtext]").val(),"eVar1":s.pageName})}catch(e){}return true}else return false})})();(function(){var timer;$("#logged-in-status .nav-sign-in").hover(function(e){$("#nav-subscribe").addClass("signIn-hover")},function(e){$("#nav-subscribe").removeClass("signIn-hover")});$("#sections-menu-off-canvas li a").hover(function(e){$(this).addClass("hover-name");$(this).parent().addClass("unhover-list")},function(e){$(this).removeClass("hover-name");$(this).parent().removeClass("unhover-list")});
$("#nav-user").click(function(){$("#user-menu").toggleClass("nav-user-show")});$("#settings-nav-btn").click(function(){if($("#logged-in-status").hasClass("logged-in"))$("#user-menu").toggleClass("nav-user-show");else $(".sign-up-buttons").toggleClass("nav-user-show")});function delayHover(element){timer=setTimeout(function(){$("#main-sections-nav").addClass("subNavigation");$(element).addClass("hover")},75)}$(".main-nav").hover(function(){delayHover($(this))},function(){$(this).removeClass("hover");
$("#main-sections-nav").removeClass("subNavigation");clearTimeout(timer)});if($(window).width()<=480)$(".main-nav").click(function(){location.href=$(this).find(".main-nav-item").attr("href")})})()}},setupNav:function(){$.fn.appendLinkItems=function(links,surroundingTag){var element=this;surroundingTag=surroundingTag||"\x3cli\x3e";$.each(links,function(i,link){var a=$("\x3ca\x3e");if(link.title)a.text(link.title);if(link.html)a.html(link.html);if(link.href)a.attr("href",link.href);if(link.attr)a.attr(link.attr);
element.append($(surroundingTag).append(a).addClass(link.selected?"selected":""))});return this};nav.setIdentityMenu=function(menu){var element=$("#user-menu ul");element.children("li").remove();element.appendLinkItems(menu)};nav.closeDropdowns=function(){$("#wp-header .dropdown-trigger.active").each(function(){$(this).removeClass("active");$("#"+$(this).data("menu")).hide()});$(".leaderboard").removeClass("hideAd")};nav.showNav=function(){if(typeof window.wp_pb=="object"&&typeof window.wp_pb.report==
"function"){wp_pb.report("nav","start_open",true);setTimeout(function(){$("#wp-header").removeClass("bar-hidden");wp_pb.report("nav","finish_open",true)},250)}};nav.hideNav=function(){if(typeof window.wp_pb=="object"&&typeof window.wp_pb.report=="function"){wp_pb.report("nav","start_close",true);setTimeout(function(){wp_pb.report("nav","finish_close",true);$("#wp-header").addClass("bar-hidden")},250)}};$(".section-menu-btn").click(function(event){event.stopPropagation();event.preventDefault();var _clickElement=
$(this),_menuElement=$("#main-sections-nav");if(_menuElement.hasClass("active")){$("body").removeClass("left-menu left-menu-pb");_clickElement.removeClass("active");_menuElement.removeClass("active");if(typeof window.wp_pb=="object"&&typeof window.wp_pb.report=="function"){wp_pb.report("nav","menu_start_close",true);setTimeout(function(){wp_pb.report("nav","menu_finish_close",true)},500)}}else{_menuElement.css("height",$(window).height()-45);$("body").addClass("left-menu left-menu-pb");_clickElement.addClass("active");
_menuElement.addClass("active");if(typeof window.wp_pb=="object"&&typeof window.wp_pb.report=="function"){wp_pb.report("nav","menu_start_open",true);setTimeout(function(){wp_pb.report("nav","menu_finish_open",true)},500)}}calcSubnavPosition()})},setScrollEvents:function(){var isHomepage=$("#logo-in-nav").hasClass("homePage"),scrollPos=$(this).scrollTop(),isMobileDevice=isMobile(),notificationBar=$(".pb-f-page-notification-bar"),notificationOffset=0;if(notificationBar.length)notificationOffset=notificationBar.outerHeight();
if(isHomepage){$("#logo-in-nav").removeClass("nav-display-show").addClass("nav-display-hide");$(window).scroll(function(){var navchange=false,widthbreak=768,window_width=$(window).width(),y_scroll_pos=window.pageYOffset,scroll_pos_test=80;if(window_width>=widthbreak)if(y_scroll_pos>scroll_pos_test&&navchange==false){navchange=true;$("#sections-menu-wide").removeClass("nav-display-show").addClass("nav-display-hide");$("#logo-in-nav").addClass("nav-display-show").removeClass("nav-display-hide")}else if(y_scroll_pos<=
0){navchange=false;if(!$("#section-menu-btn").hasClass("active")){$("#logo-in-nav").removeClass("nav-display-show").addClass("nav-display-hide");$("#sections-menu-wide").addClass("nav-display-show").removeClass("nav-display-hide")}}if($("#main-sections-nav").hasClass("active"))calcSubnavPosition()})}else if(!isHomepage||isMobileDevice){var timeOutTime=50,scrollHeight=150;if(isMobileDevice){scrollHeight=30;timeOutTime=25}$(window).scroll(function(){if(!$("#section-menu-btn").hasClass("active")){var currentPos=
$(this).scrollTop();if(currentPos+80<scrollPos||currentPos===0){var copyPos=currentPos;setTimeout(function(){var lastPos=$(this).scrollTop();if(copyPos-lastPos>scrollHeight||currentPos===0){nav.showNav();scrollPos=currentPos}},timeOutTime)}else if(currentPos-80>scrollPos&&currentPos>50+notificationOffset){nav.hideNav();scrollPos=currentPos}$("#user-menu").removeClass("nav-user-show");$(".sign-up-buttons").removeClass("nav-user-show")}if($("#main-sections-nav").hasClass("active"))calcSubnavPosition()})}$(window).resize(function(){nav.closeDropdowns();
if($("body").hasClass("left-menu"))$("#main-sections-nav").css("height",$(window).height()-45)});$(document).ready(function(){wp_pb.register("nav","force-show",function(){nav.showNav()})})},setIdentity:function(){var idp;nav.getIdentityProvider=function(){return idp};nav.setIdentityProvider=function(provider){var ef=function(){};idp={};idp.name=provider.name||"";idp.getUserId=provider.getUserId||ef;idp.getUserMenu=provider.getUserMenu||ef;idp.getSignInLink=provider.getSignInLink||ef;idp.getRegistrationLink=
provider.getRegistrationLink||ef;idp.isUserLoggedIn=provider.isUserLoggedIn||ef;idp.isUserSubscriber=provider.isUserSubscriber||ef;idp.render=provider.render||function(){if(idp.isUserLoggedIn()){$("#nav-user .username").text(idp.getUserId());nav.setIdentityMenu(idp.getUserMenu());$("#nav-user, #user-menu").removeClass("hidden");if(idp.isUserSubscriber()==="0"){$("#user-menu ul li:first-child").after($("#nav-subscribe").clone());$("#user-menu  #nav-subscribe").removeClass("hidden")}$("#user-menu ul li:first-child").after($("#nav-reading-list").clone().removeClass("hidden"));
$("#logged-in-status").addClass("logged-in")}else{$("#sign-in-link").attr("href",idp.getSignInLink()+"\x26nid\x3dtop_pb_signin");$(".nav-sign-in").removeClass("hidden");$("#nav-subscribe").removeClass("hidden");$("#nav-subscribe-mobile").removeClass("hidden")}};nav.renderIdentity()};nav.renderIdentity=function(callback){callback=callback||function(){};if(idp)idp.render();callback(idp)};var showIdentity=$("#nav-user").data("show-identity");var current=window.location.href.split("?")[0];var twpIdentity=
{name:"TWP",getUserId:function(){var username=TWP.Util.User.getUserName();var userid=TWP.Util.User.getUserId();if(typeof username=="string"&&username.length>0)return username;else return userid},getUserMenu:function(){return[{"title":"Profile","href":TWP.signin.profileurl+current+"\x26refresh\x3dtrue"},{"title":"Log out","href":TWP.signin.logouturl_page}]},getSignInLink:function(){return TWP.signin.loginurl_page+current},getRegistrationLink:function(){return TWP.signin.registrationurl_page+current},
isUserSubscriber:function(){sub=document.cookie.match(/rplsb=([0-9]+)/)?RegExp.$1:"";return sub},isUserLoggedIn:function(){return TWP.Util.User?TWP.Util.User.getAuthentication():false}};if(showIdentity){var init=(new Date).getTime();(function checkTWP(){if(!nav.getIdentityProvider())if(TWP&&TWP.signin&&TWP.Util){nav.setIdentityProvider(twpIdentity);nav.renderIdentity()}else{var now=(new Date).getTime();window.setTimeout(function(){checkTWP()},200)}})()}}};function isMobile(){if(navigator.userAgent.match(/Android/i)||
navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Kindle/i)||navigator.userAgent.match(/Windows Phone/i))return true;else return false}function calcSubnavPosition(){$("#sections-menu-off-canvas \x3e ul \x3e li").each(function(){if(!$("#main-sections-nav").hasClass("active"))return;if($(this).hasClass("has-sub")){var movetop=$(this).find("ul").height()/2-10,offsetY=$(this).offset().top-
$(window).scrollTop();if(offsetY<94)movetop=0;else if(offsetY-movetop<95)movetop=offsetY-95;$(this).find("ul").css("top","-"+movetop+"px")}})}wpHeader.init();wpHeader.setupNav();wpHeader.setScrollEvents();wpHeader.setIdentity()})(jQuery,window);
(function($,TWP,undefined){var AD_LOAD_TIMEOUT=7E3;var AD_SCROLL_HIDE_TIMEOUT=600;var AD_SIZER_INTERVAL=200;var AD_POS_INTERVAL=200;var AD_MIN_VISIBLE=2E3;var AD_HEIGHT_OUTER=181;var ANIM_SPEED=250;var console=new TWP.Tools.logger("leaderboard");var applyStickiness=function(){$(function(){getFeature().on("DOMNodeInserted",function(e){var $el=$(e.target),id=$el.attr("id");if($el.is("iframe")&&id&&!/(hidden)/g.test(id)){getFeature().off("DOMNodeInserted");afterAdInserted($el)}});function removeSticky(){setTimeout(function(){var $f=
getFeature();$f.addClass("lb-hidden");setTimeout(function(){$f.removeClass("lb-hidden");console.log("remove sticky top");$("html").removeClass("lb-persist-top-true")},ANIM_SPEED);if(darkTheme())$f.css({width:""})},AD_MIN_VISIBLE)}function afterAdInserted($ad){var iframeError;var afterLoaded=function(){console.log("call after load");var bindEvents=function(){if(darkTheme())$(window).on("resize.lb-ad-sizer scroll.lb-ad-sizer",debounce(function(){if($(window).scrollTop()>getFeature().offset().top){getFeature().css({width:getFrameWidth()});
$(window).off("resize.lb-ad-sizer scroll.lb-ad-sizer");removeSticky()}},AD_SIZER_INTERVAL,false));$(window).on("scroll.lb-sticky",debounce(function(e){e.stopPropagation();if($(window).scrollTop()>getFeature().offset().top){$("html").addClass("lb-persist-top-true");$(window).off("scroll.lb-sticky");removeSticky()}},AD_POS_INTERVAL,false))};if($(window).scrollTop()>getFeature().offset().top){$("html").addClass("lb-persist-top-true");if(darkTheme())getFeature().css({width:getFrameWidth()});removeSticky()}else bindEvents()};
iframeError=setTimeout(function(){console.log("error");afterLoaded()},AD_LOAD_TIMEOUT);$ad.on("load",function(){console.log("loaded");afterLoaded();clearTimeout(iframeError)})}})};if(!!TWP.Features.Ad.Leaderboard.sticky)applyStickiness();if(!!TWP.Features.Ad.Leaderboard.belowSharebar)applySharebarPosition();$(window.document).on("abtest-ready",function(e,ABT){var test=ABT.get("ads-leaderboard");getFeature().attr("moat-test-id",[getFeature().attr("moat-id")||"unknown/unknown",test.name||"control"].join("-"));
if(test.is("below_sharebar"))applySharebarPosition();if(test.is("sticky"))applyStickiness()});function applySharebarPosition(){var $leaderboard=getFeature();var $shareBar=getSharebar();return $leaderboard.insertAfter($shareBar)}function getFeature(){return $(".pb-f-ad-leaderboard")}function getSharebar(){return $(".pb-f-sharebars-top-share-bar")}function getNavbar(){return $("#nav-bar")}function debounce(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=
function(){timeout=null;if(!immediate)func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args)}}function getFrameWidth(){return $("#pb-root").width()}function darkTheme(){return $("body").hasClass("pb-theme-dark")}})(jQuery,TWP);
(function(){var socialTools={myRoot:".top-sharebar-wrapper",init:function(myRoot){stickyShareBar.init();var self=this;myRoot=myRoot||this.myRoot;$myRoot=$(myRoot);$myRoot.each(function(index,myRootElement){if(wp_pb.StaticMethods.staticPostShare)wp_pb.StaticMethods.staticPostShare.init($(myRootElement),$(myRootElement).data("postshare"));var $root=$(myRootElement),$individualTool=$(".tool:not(.more, .read-later-bookmark, .read-later-list)",$root),$socialToolsWrapper=$(".social-tools-wrapper",$root),
$socialToolsMoreBtn=$(".tool.more",$socialToolsWrapper),$socialToolsAdditional=$(".social-tools-additional",$root),width=window.innerWidth>0?window.innerWidth:screen.width,isMobile=mobile_browser===1&&width<480?true:false;$socialToolsMoreBtn.off("click").on("click",this,function(ev){$socialToolsMoreBtn.hide();$socialToolsAdditional.show("fast",function(ev){$root.addClass("expanded");$(".social-tools",$socialToolsAdditional).animate({"margin-left":0},4250)}).css("display","inline")});$individualTool.bind({click:function(event){var shareType=
$(this).attr("class");shareType=typeof shareType!="undefined"?shareType.split(" ")[0].trim():"";self.trackTraffic("share."+shareType,shareType+"_bar")}});if(wp_pb&&wp_pb.BrowserInfo&&wp_pb.BrowserInfo.tablet)$root.addClass("tablet");$root.removeClass("unprocessed")});this.enableReadLater($myRoot)},trackTraffic:function(name,eVar27){if(typeof window.sendDataToOmniture==="function"){var omnitureVars={"eVar1":typeof window.s=="object"&&s&&s.eVar1,"eVar2":typeof window.s=="object"&&s&&s.eVar2,"eVar8":typeof window.s==
"object"&&s&&s.eVar8,"eVar17":typeof window.s=="object"&&s&&s.eVar17,"eVar27":eVar27};try{sendDataToOmniture(name,"event6",omnitureVars)}catch(e){}}},enableReadLater:function($root){var $notificationBar=$(".social-notification-bar",$root),$bookMark=$(".read-later-bookmark",$root);if($bookMark.length){$root.readingList=new wp_pb.StaticMethods.staticReadingList;var wapo_login_id=document.cookie.match(/wapo_login_id=([^;]+)/)?RegExp.$1:"",doActions=function(isExist){var func=isExist?$root.readingList.remove:
$root.readingList.save,perfom=func.call(undefined,window.location.href);perfom.then(function(){if(isExist){$bookMark.find(".fa").removeClass("fa-bookmark").addClass("fa-bookmark-o");$bookMark.data("isExist",false)}else{$bookMark.find(".fa").removeClass("fa-bookmark-o").addClass("fa-bookmark");$bookMark.data("isExist",true);$notificationBar.toggleClass("show");setTimeout(function(){$notificationBar.toggleClass("show")},4E3)}});return perfom},setCookie=function(cname,cvalue,exmins){var d=new Date,expires=
"";if(exmins){d.setTime(d.getTime()+exmins*60*1E3);expires="expires\x3d"+d.toUTCString()}document.cookie=cname+"\x3d"+cvalue+"; "+expires};if(wapo_login_id)$root.readingList.checkExist(window.location.href).then(function(response){if(response.value)$bookMark.find(".fa").removeClass("fa-bookmark-o").addClass("fa-bookmark");$bookMark.data("isExist",response.value);var isFromSignIn=document.cookie.match(/read-later-after-login-save=([^;]+)/)?RegExp.$1:"";if(isFromSignIn){if(!response.value)doActions(response.value);
setCookie("read-later-after-login-save","",-20)}});$bookMark.off("click").on("click",function(ev){var isExist=$bookMark.data("isExist");doActions(isExist)});$(".login-btn",$root).off("click").on("click",function(){setCookie("read-later-after-login-save",true,20);var trafficeName="read_later-login";self.trackTraffic(trafficeName,trafficeName);window.location.href=TWP.signin.loginurl_page+encodeURIComponent(window.location.href);return false});$(".create-account-btn",$root).off("click").on("click",
function(){setCookie("read-later-after-login-save",true,20);var trafficeName="read_later-create-account";self.trackTraffic(trafficeName,trafficeName);window.location.href=TWP.signin.registrationurl_page+"?destination\x3d"+encodeURIComponent(window.location.href);return false});$(".read-later-list",$root).off("click").on("click",function(){window.location.href=wp_pb.contextPath+"/readinglist/?tid\x3dtop-share-bar";return false})}}};var stickyShareBar={setElmTop:function($sharebarElm,top){$sharebarElm.css({"top":top})},
navMenuToggle:function($sharebarElm,$navBar){wp_pb.register("nav","start_open",function(){this.setElmTop($sharebarElm,$navBar.height())},this);wp_pb.register("nav","start_close",function(){this.setElmTop($sharebarElm,0)},this);wp_pb.register("magnet","start_open",function(){this.setElmTop($sharebarElm,150)},this)},fixedPosition:function($sharebarElm,sharebarTop,$navBar){var currentTop=$(window).scrollTop();if(currentTop>sharebarTop){if(!$sharebarElm.hasClass("top-sharebar-fixed")){$sharebarElm.addClass("top-sharebar-fixed");
this.setElmTop($sharebarElm,$navBar.height())}}else{$sharebarElm.removeClass("top-sharebar-fixed");this.setElmTop($sharebarElm,0)}},moveOutOfRoot:function($sharebarElm){var $pbRoot=$("#pb-root");if($pbRoot.css("max-width")!=="none"){var $sharebarRoot=$sharebarElm.parent();var $leaderboard=$(".pb-f-ad-leaderboard");$pbRoot.before($leaderboard);$pbRoot.before($sharebarRoot)}},init:function(){var $sharebarElm=$(".sticky-top-sharebar"),self=this;if(!$sharebarElm.length)return;this.moveOutOfRoot($sharebarElm);
var sharebarTop=$sharebarElm.offset().top;var $header=$("#wp-header"),$navBar=$("#nav-bar");if($header.css("position")==="fixed"&&$(window).scrollTop()>sharebarTop)this.fixedPosition($sharebarElm,sharebarTop,$navBar);$(window).off("scroll.sharebar").on("scroll.sharebar",function(){self.fixedPosition($sharebarElm,sharebarTop,$navBar)});$(document).ready(function(){self.navMenuToggle($sharebarElm,$navBar)})}};window.TWP=TWP||{};TWP.SocialTools=TWP.SocialTools||socialTools;TWP.SocialTools.init()})();
(function($){window._essentials_onrender=function(Essentials){var $target=$("#essentials-topper");var name=Essentials.name;var data=Essentials.data;var pdata=Essentials.getPersistentData();var status=pdata[Essentials.contentPath];var count=!!name&&!!data?data.results.length:undefined;var tcount;if(!!Essentials.name&&$(".cf-essentials-module").length!=0){$target.show();$(function(){if(count){switch(count){case 1:tcount="One";break;case 2:tcount="Two";break;case 3:tcount="Three";break;case 4:tcount=
"Four";break;case 5:tcount="Five";break;default:tcount="";break}$(('\x3ch2\x3e\x3cspan class\x3d"status vg-check status-icon status-%s"\x3e\x3c/span\x3e '+'\x3cspan class\x3d"status-count"\x3e'+tcount+" Essentials\x3c/span\x3e "+'\x3cspan class\x3d"status-kicker"\x3e%k\x3c/span\x3e'+"\x3c/h2\x3e").replace("%s","undefined"==typeof status?"scroll":"read").replace("%k",data.kicker.text)).appendTo($target);$target.on("click.essentials-topper",function(e){wp_pb.report("essentials-topper","click",{$target:$target});
wp_pb.report("essentials","scrollto",{$from:$target})})}})}}})(jQuery);
(function($){var textResizer={currIncrementMax:4,currIncrementUnit:2,currIncrementIndex:0,init:function(myRoot,resizeableElementList,clickElement){myRoot=myRoot||"#article-body article, .related-story, .liveblog-intro, #liveblog-story-list .description, #full-recipe .article-content";resizeableElementList=resizeableElementList||"p, li";clickElement=clickElement||".tool.textresizer";this.root=$(myRoot);this.resizeableElements=$(resizeableElementList,this.root);if($(".related-story").prev("h3").length>
0){this.resizeableElements.push($(".related-story").prev("h3"));this.resizeableElements.push($(".related-story h4 a"))}$(clickElement).on("click",this,this.resize)},resize:function(event){var currObj=event.data;if(currObj.currIncrementIndex==currObj.currIncrementMax){currObj.currIncrementIndex=0;currObj.currIncrementUnit=currObj.currIncrementUnit==2?-2:2}currObj.currIncrementIndex=currObj.currIncrementIndex+1;currObj.resizeableElements.each(function(){elm=$(this);currSize=parseFloat(elm.css("font-size"),
5);var result=currSize+currObj.currIncrementUnit;elm.css("font-size",result);wp_pb.report("textresizer","resized",result)})}};var trackTraffic=function(name){if(typeof window.sendDataToOmniture==="function"){var omnitureVars={"eVar1":typeof window.s=="object"&&s&&s.eVar1,"eVar2":typeof window.s=="object"&&s&&s.eVar2,"eVar8":typeof window.s=="object"&&s&&s.eVar8,"eVar17":typeof window.s=="object"&&s&&s.eVar17,"eVar27":name};try{sendDataToOmniture(name+".click","event6",omnitureVars)}catch(e){}}};$(".tool.textresizer, .tool.print").bind("click",
function(){var name=$(this).attr("class").split(" ")[0].trim();trackTraffic(name)});window.TWP=TWP||{};TWP.TextResizer=TWP.TextResizer||textResizer;TWP.TextResizer.init()})(jQuery);
(function($){var $article=$("#article-body"),$d=$(document),$w=$(window),$b=$("body");window.cr_on=false;$("iframe[data-src]",$article).each(function(i){var $this=$(this);$this.attr("src",$this.attr("data-src"))});$("#about-the-authors").click(function(e){var $this=$(this);var $container=$this.closest(".multi-author-bio");if(!!$container){if($container.hasClass("open"))$container.removeClass("open").addClass("closed");else $container.removeClass("closed").addClass("open");wp_pb.report("global","domChanged")}});
var $tables=$("div.extra table",$article);$tables.each(function(){var $table=$(this),$bars=$(".barchart",$table),longestBar=0;$bars.each(function(i){var $bar=$(this),w=$bar.attr("width");if(!isNaN(w)){w=w*1;longestBar=w>longestBar?w:longestBar}});$bars.each(function(i){var $bar=$(this),w=$bar.attr("width");if(!isNaN(w)){w=w*1;var scale=$article.width()>480?.85:.75;relativeWidth=scale*(Math.ceil(100*(w/longestBar)*100)/100);$bar.css("width",relativeWidth+"%")}})});var hasResizableIframe=false;$("iframe[width][height]",
$article).each(function(i){var $iframe=$(this),w=$iframe.attr("width"),h=$iframe.attr("height");if(!isNaN(w)&&!isNaN(h)){$iframe.attr("data-aspect-ratio",w/h);if($iframe.attr("width")!=$article.width()){var hFudgeFactor=$iframe.attr("src").match(/instagram.com/)?40:0;$iframe.attr("width",Math.round($article.width()));$iframe.attr("height",Math.round($article.width()/$iframe.attr("data-aspect-ratio"))+hFudgeFactor)}if(!hasResizableIframe){hasResizableIframe=true;$w.resize(function(ev){$("iframe[data-aspect-ratio]",
$article).each(function(i){var $ifr=$(this);hFF=$ifr.attr("src").match(/instagram.com/)?40:0;$ifr.attr("width",Math.round($article.width()));$ifr.attr("height",Math.round($article.width()/$ifr.attr("data-aspect-ratio"))+hFF)})})}}});$(window.document).on("abtest-ready",function(e,ABT){var test=ABT.get("posttv_embeds-blurb");var inlineVideo=$article.find(".inline-video");var inlineVideoCaption=inlineVideo.find(".inline-video-caption");if(test.is("hidden")){inlineVideoCaption.addClass("no-blurb");inlineVideo.find(".pb-caption").each(function(){var $caption=
$(this);var captionText=$caption.text();if(captionText.match(/(\(.*\))\s?$/))$caption.text(RegExp.$1);else $caption.text("")})}inlineVideoCaption.show()})})(jQuery);
(function($){var defaultNewsLetter={frequency:"Daily",headline:"Get the Today's Headlines Newsletter",id:"post_newsletter1",name:"Today's Headlines",tagline:"Free daily updates delivered just for you.",template:"signup-confirm-heads",variable:"vars[intent_heads]"},defaultNewsLetters=[{frequency:"Daily",headline:"Get the Today's Headlines Newsletter",id:"post_newsletter1",name:"Today's Headlines",tagline:"Free daily updates delivered just for you.",template:"signup-confirm-heads",variable:"vars[intent_heads]"},
{frequency:"Daily",headline:"Get the Read In Newsletter",id:"post_newsletter112",name:"Read In",tagline:"Free daily updates delivered just for you.",template:"signup-confirm-readin",variable:"vars[intent_readin]"},{frequency:"Weekly",headline:"Get the Lean \x26 Fit Newsletter",id:"post_newsletter8",name:"Lean \x26 Fit",tagline:"Free weekly updates delivered just for you.",template:"signup-confirm-lean",variable:"vars[intent_lean]"},{frequency:"Twice-weekly",headline:"Get the Checkpoint Newsletter",
id:"post_newsletter130",name:"Checkpoint",tagline:"Free twice-weekly updates delivered just for you.",template:"signup-confirm-check",variable:"vars[intent_check]"}],washPostId,subscribeEmail,showInStreamNewsletter=function(){$("#signup-box-instream").show()},hideInStreamNewsletter=function(){$("#signup-box-instream").hide()},showInStreamSignUpForm=function(){$("#subscribe-form-inStream").show();$("#loggedInBtn").hide()},showInStreamSignUpButton=function(){$("#subscribe-form-inStream").hide();$("#loggedInBtn").show()},
showErrorMsgInStream=function(message){if(message)$(".error-msg-inStream").text(message).show()},hideErrorMsgInStream=function(){$(".error-msg-inStream").hide()},setInStreamNewsLetter=function(data){$("#headline-instream").append(data.headline);$("#tagline-instream").text(data.tagline)},setInStreamRecommendations=function(data){$("#suggestions-inStream .recommended").each(function(index){$(this).find("p").text("Get "+data[index].name+" ("+data[index].frequency+")");$(this).find("input[type\x3d'checkbox']").attr("value",
data[index].id);$(this).find("input[type\x3d'checkbox']").attr("name",data[index].name)})},toggleInStreamRecommendations=function(show){if(show){$("#subscribe-form-inStream, #loggedInBtn, #tagline-instream").hide();$("#suggestions-inStream, .checked-icon, #confirmation-instream, #all-newsletters-inStream").show()}else $("#suggestions-inStream, .might-like").hide()},showConfirmationInStream=function(){$("#subscribe-form-inStream, #loggedInBtn, #tagline-instream").hide();$(".checked-icon, #confirmation-instream, #all-newsletters-inStream").show()},
getUserId=function(){return document.cookie.match(/wapo_login_id=([^;]+)/)?RegExp.$1:""},getWapoId=function(){return document.cookie.match(/wapo_secure_login_id=([^;]+)/)?RegExp.$1:""},getPageData=function(){var section=$("#section-instream").text(),subSection=$("#subsection-instream").text(),blog=$("#blogname-instream").text(),data={};washPostId=getUserId();if(washPostId!=="")data.washPostId=washPostId;if(blog)data.blog=blog;if(subSection)data.subSection=subSection;if(section)data.section=section;
return data},getInStreamNewsletter=function(){var data=getPageData();return $.ajax({type:"POST",dataType:"json",contentType:"application/json",url:"https://recommendation-newsletter.wpdigital.net/Newsletter/api/newsletter",data:JSON.stringify(data)})},getInStreamRecommendations=function(newsletters){var data=getPageData();data.newsletters=newsletters;return $.ajax({type:"POST",dataType:"json",contentType:"application/json",url:"https://recommendation-newsletter.wpdigital.net/Newsletter/api/newsletters",
data:JSON.stringify(data)})},subscribeInStream=function(email){var data,url;if(washPostId!==""){url="https://subscribe.washingtonpost.com/person/newsletter/subscribe";data={"wapoLoginID":washPostId,"wapoSecureID":getWapoId(),"userAgent":navigator.userAgent,"newsletterName":window.Newsletter.id,"metadata":[{"name":"nl_start_method","value":"EI"},{"name":"nl_start_location","value":"IS"}]}}else if(email){url="https://subscribe.washingtonpost.com/person/newsletter/subscribe-email";data={"email":email,
"newsletterName":window.Newsletter.id,"metadata":[{"name":"nl_start_method","value":"EI"},{"name":"nl_start_location","value":"IS"}]}}if($("#signup-box-instream").hasClass("bottomArticle"))data.metadata=[{"name":"nl_start_method","value":"EI"},{"name":"nl_start_location","value":"ISB"}];$.ajax({type:"POST",dataType:"json",contentType:"application/json",url:url,data:JSON.stringify(data),success:function(data){if(data.status=="SUCCESS"){sendCustomTrackProps("event60,event91",trackProps(window.Newsletter.name,
1,"simple"),"Newsletter In Stream Sign-up");setUpInStreamRecommendations([window.Newsletter.id])}else showErrorMsgInStream("Error while subscribing, please try later.")},error:function(request,status,error){showErrorMsgInStream("Error while subscribing, please try later.")}})},subscribeBundleInStream=function(){var data,url,newsletters=[],newsletterNames=[];$("#suggestions-inStream input:checked").each(function(index){newsletters.push($(this).val());newsletterNames.push({name:$(this).attr("name"),
position:$(this).attr("data-pos")})});if(newsletters.length>0&&newsletterNames.length>0){if(washPostId!==""){url="https://subscribe.washingtonpost.com/person/newsletter/subscribe-list";data={"wapoLoginID":washPostId,"wapoSecureID":getWapoId(),"userAgent":navigator.userAgent,"newsletters":newsletters,"metadata":[{"name":"nl_start_method","value":"EA"},{"name":"nl_start_location","value":"IS"}]}}else if(subscribeEmail){url="https://subscribe.washingtonpost.com/person/newsletter/subscribe-list-email";
data={"email":subscribeEmail,"newsletters":newsletters,"metadata":[{"name":"nl_start_method","value":"EA"},{"name":"nl_start_location","value":"IS"}]}}if($("#signup-box-instream").hasClass("bottomArticle"))data.metadata=[{"name":"nl_start_method","value":"EA"},{"name":"nl_start_location","value":"ISB"}];$.ajax({type:"POST",dataType:"json",contentType:"application/json",url:url,data:JSON.stringify(data),success:function(data){if(data.status=="SUCCESS"){for(var i=0;i<newsletterNames.length;i++)sendCustomTrackProps("event60,event91",
trackProps(newsletterNames[i].name,newsletterNames[i].position,"enhanced"),"Newsletter Right Rail Sign-up Bundle");setUpInStreamRecommendations(newsletters,true);toggleInStreamRecommendations(false)}else showErrorMsgInStream("Error while subscribing, please try later.")},error:function(request,status,error){showErrorMsgInStream("Error while subscribing, please try later.")}})}},setUpInStreamRecommendations=function(newsletterId,confirmBundleSubscribe){var recommendations=getInStreamRecommendations([window.Newsletter.id]);
recommendations.done(function(data){if(!$.isEmptyObject(data.newsletters)&&data.newsletters.length>=3&&!confirmBundleSubscribe){window.Newsletters=data.newsletters;setInStreamRecommendations(data.newsletters);toggleInStreamRecommendations(true);for(var i=0;i<data.newsletters.length-1;i++)sendCustomTrackProps("event59",trackProps(data.newsletters[i+1].name,i+1,"enhanced"),"Newsletter Right Rail Show Recommendations")}else toggleInStreamRecommendations(false);showConfirmationInStream()});recommendations.fail(function(){if(!confirmBundleSubscribe){window.Newsletters=
defaultNewsLetters;setInStreamRecommendations(defaultNewsLetters);toggleInStreamRecommendations(true)}})},setUpInStreamNewsletter=function(newsletter){window.Newsletter=newsletter;setInStreamNewsLetter(newsletter);showInStreamNewsletter();if(getUserId()!=="")showInStreamSignUpButton();else showInStreamSignUpForm()},applyInStream=function(variant,version){var mainNewsletter=getInStreamNewsletter();mainNewsletter.done(function(data){if(!$.isEmptyObject(data.newsletter)){setUpInStreamNewsletter(data.newsletter);
setTimeout(function(){sendCustomTrackProps("event59",trackProps(window.Newsletter.name,1,"simple"),"Newsletter In Stream successfull API Call")},5E3)}else hideInStreamNewsletter()});mainNewsletter.fail(function(){setUpInStreamNewsletter(defaultNewsLetter);sendCustomTrackProps("event50",trackProps(window.Newsletter.name,1),"Newsletter In Stream API failure case")});$(".subscribe-btn-inStream").click(function(){subscribeEmail=$("#email-inStream").val(),re=/[A-Z0-9._%+-]+@[A-Z0-9.-]+.[A-Z]{2,4}/igm;
if(subscribeEmail==""||!re.test(subscribeEmail))showErrorMsgInStream("Please enter a valid email address");else{hideErrorMsgInStream();subscribeInStream(subscribeEmail)}return false});$("#loggedInBtn").click(function(){subscribeInStream()});$("#subscribe-bundle-inStream").click(function(){subscribeBundleInStream()});$("#cancel-bundle-inStream").click(function(){sendCustomTrackProps("event58",trackProps(),"No Thanks, Newsletter Right Rail Sign-up Bundle ");toggleInStreamRecommendations(false)})};$(window.document).on("abtest-ready",
function(e,ABT){if(window.wp_content_type=="front")applyInStream();else if(window.wp_content_type=="blog"||window.wp_content_type=="article"){var testArticle=ABT.get("newsletters-articleUnits");if(testArticle.is("bottom"))applyInStream(testArticle)}});var forceShow=$("#signup-box-instream").data("force");if(!!forceShow)applyInStream("instream");function trackProps(newsletterName,index,enhancedKey){var subsection=window.wp_subsection||"";var contentType=window.wp_content_type||"";var props={"eVar2":subsection,
"prop2":subsection,"prop3":contentType,"eVar17":contentType};if(newsletterName&&index)props.eVar26="nl_instream_"+enhancedKey+"_"+newsletterName.toLowerCase().split(" ").join("-")+"_"+index;return props}function sendCustomTrackProps(eventKey,props,name){if(!!window.s)window.s.sendDataToOmniture(name||"PB Feature - Page-Newsletter",eventKey,props,{wait:true})}})(jQuery);
(function($){var $socialToolsBottom=$(".social-tools-bottom"),$individualTools=$socialToolsBottom.children(),config={"omnitureEvent":"event6"};$(".social-tools-wrapper-bottom").each(function(index,myRootElement){if(wp_pb.StaticMethods.staticPostShare)wp_pb.StaticMethods.staticPostShare.init($(myRootElement),$(myRootElement).data("postshare"))});$individualTools.on("click",function(e){if(typeof window.sendDataToOmniture==="function"){var shareType=$(this).data("sharetype"),eventName=config.omnitureEvent,
omnitureVars={"eVar1":typeof window.s=="object"&&s&&s.eVar1,"eVar2":typeof window.s=="object"&&s&&s.eVar2,"eVar8":typeof window.s=="object"&&s&&s.eVar8,"eVar17":typeof window.s=="object"&&s&&s.eVar17,"eVar27":""};omnitureVars.eVar27=shareType+"_bottom";try{sendDataToOmniture("share."+shareType,eventName,omnitureVars)}catch(e){console.log(e)}}})})(jQuery);
$(function() {
    wp_pb = window.wp_pb || {};
    wp_pb.CommentLoader = wp_pb.CommentLoader || function(){
        var width = (window.innerWidth > 0) ? window.innerWidth : screen.width,
            isMobile = ((wp_pb && wp_pb.BrowserInfo && wp_pb.BrowserInfo.mobile_browser === 1) && width < 480 ) ? true : false,
            loadDeferred = ($('.echo_container.defer').length > 0) ? true : false,
            loadDeferredMobile = ($('.echo_container.deferMobile').length > 0) ? true : false,
            noMobile = ($('.echo_container.no-mobile').length > 0 && isMobile) ? true : false,
            $window = $(window),
            $echoPlaceholder = $('.echo_container_placeholder'),
            loadThreshhold = .70,
            env = wp_pb.environment || "production",
            apiBaseURL = (env == 'production')?'https://comments-api.ext.nile.works':'https://comments-api-staging.ext.nile.works',
            forceShowComments = $(document).getUrlParam("sc"), //get any relevant QS parameters
            commentOverlay = {
                    overlayElements: {
                        overlay: '#comment_overlay',
                        articleWrapper: '.article-wrapper',
                        articleTopper: '.article-topper',
                        articleParent: '.story-stream',
                    },
                    onClose: function(data) {
                        data.overlay = data.overlay || $(commentOverlay.overlayElements.overlay);
                        data.overlay.addClass('overlay-closed');

                        /*** STORYLINE COMMENTS CODE; DEPRECATED ***/
                        /*  $(window.document).off('scroll.TWP.Comments');
                            if (!data.action || data.action != 'story_closed') {
                                $('#story-stream-tools').css('display','block');
                            }
                        */
                    },
                    onOpen: function(data) {
                        //hack to make the comments overlay work with the site menu open. LP will revisit.
                        if($('body').is('.left-menu')) {
                            $('#site-menu-btn').click();
                            setTimeout(function() {
                                data.overlay.addClass('overlay-fixed').removeClass('overlay-absolute');
                                data.overlayWrapper.removeClass('overlay-closed');
                            }, 600);
                        } else {
                            data.overlay.addClass('overlay-fixed').removeClass('overlay-absolute');
                            data.overlayWrapper.removeClass('overlay-closed');
                        }

                    },
                    onScroll: function(event){

                    },
                    closeSelector: "a.close"};


        var loadComments = function() {
            if (!noMobile) {
                if (typeof wp_e2 == 'undefined' || typeof wp_e2.initStatus == 'undefined') {
                    //echo code below.  Comment out for in-house
                    //var domain = (env == "production") ? "js.washingtonpost.com" : "qaprev.digitalink.com";
                    //TWPHead && TWPHead.load("//" + domain + "/1d/hjs/twp-comments.js" + "?token=b20140708165000");
                    //end echo code
                    //in-house code below.  Comment out for Echo production
                    var domain = (env == "production") ? "//js.washingtonpost.com/pb" : "/pb";
                    var outputtype = (env == "production") ? "&outputType=javascript" : "&outputType=javascript";
                    var resourceToken = wp_pb.resourceToken || '201504300950';
                    TWPHead && TWPHead.load( domain + "/1d/hjs/twp-comments.js" + "?token=" + resourceToken + outputtype);
                    //end in-house code
                }
            }
        };


        var showComments = function(data) {

            loadComments();
            $window.off('scroll.showComments');

            var $overlay = $(commentOverlay.overlayElements.overlay);  //check for overlay element

            if ($overlay.length == 0) {  //standard functionality
                $('.comment-summary.summary-expanded, .comment-summary.summary-expanded-mobile, .comment-summary.summary-expanded-desktop')
                    .slideUp('fast', function() {
                        $('.echo_container.comments-collapsed').removeClass('comments-collapsed')
                            .addClass('comments-expanded')
                            .slideDown('fast', function() {
                                wp_pb.report('global', 'domChanged');
                            });
                        $(this).addClass('summary-collapsed').removeClass('summary-expanded summary-expanded-mobile summary-expanded-desktop');
                        if (typeof window.sendDataToOmniture === 'function') {
                            try {
                                sendDataToOmniture('echo.gotoComments', 'event5', {
                                    "eVar26": "go to comments"
                                });
                            } catch (err) {}
                        }
                    });
                $echoPlaceholder.parent()[0].scrollIntoView();

            } else {
                //comments displayed in side/overlay
                //comments moved to appropriate place in DOM, positioned, and refreshed.

                if (typeof data == 'undefined') {
                    //do nothing
                    return;
                }

                $overlayWrapper = data.elm.parents(commentOverlay.overlayElements.articleWrapper);

                if(!$overlay.is('.overlay-closed')) {
                    //if the comments are open, close them
                    wp_pb.report('comments', 'commentsMultiClosed', {'overlay': $overlay, 'overlayWrapper': $overlayWrapper})
                } else {
                    //otherwise, open the comments
                    $overlay.find(commentOverlay.closeSelector).on('click',function(event){
                        event.stopPropagation();
                        wp_pb.report('comments','commentsMultiClosed', {'overlay':$overlay,'overlayWrapper':$overlayWrapper})
                    });

                    //move to appropriate place in DOM
                    $overlayWrapper.after($overlay);
                    var top = (data && data.location && data.location.offset().top) || $(document).scrollTop();

                    //refresh
                    if (typeof data.guid !== 'undefined') {
                        var allow_comments = ($overlayWrapper.find('.pb-comment-wrapper').attr('data-allow-comments')==='true')?true:false;
                        wp_e2.refreshComments({"id":"#" + $overlay.find('.echo_container.comments').attr('id'), "url":data.guid, "allow_comments":allow_comments});
                    }

                    wp_pb.report('comments', 'commentsMultiOpened',{'parent':$overlayWrapper.parent($(commentOverlay.overlayElements.articleParent)),'overlay':$overlay,'overlayWrapper':$overlayWrapper});
                }
            }

        };

        var loadCommentCount = function (elms){
            //echo code.  comment out for in-house
            //var apiBaseURL = '//api.echoenabled.com';//production (Echo)
            //end echo

            var echoCountApi =  apiBaseURL + '/v2/mux' +
                                '?appkey='  + ((TWP.Data.echo_appkey != 'undefined')?TWP.Data.echo_appkey:'prod.washpost.com') +
                                '&requests=';
            var query = "(childrenof:'{guid}'" +
             encodeURI("source:washpost.com (((state:Untouched AND user.state:ModeratorApproved) OR (state:CommunityFlagged,ModeratorApproved,ModeratorDeleted AND -user.state:ModeratorBanned,ModeratorDeleted) )))"
                + ' children: 2 (((state:Untouched AND user.state:ModeratorApproved) OR (state:CommunityFlagged,ModeratorApproved AND -user.state:ModeratorBanned,ModeratorDeleted) ) )');

            /*
    [{  "id":"count1",
        "method":"count",
        "q":"((childrenof: //www.washingtonpost.com/world/middle_east/palestinians-form-new-unity-government-including-hamas/2014/06/02/c681d5c6-ea46-11e3-9f5c-9075d5508f0a_story.html source:washpost.com (((state:Untouched user.state:ModeratorApproved) OR (state:CommunityFlagged,ModeratorApproved,ModeratorDeleted -user.state:ModeratorBanned,ModeratorDeleted) OR (-state:SystemFlagged,ModeratorFlagged user.id:'http://washingtonpost.com/vr5H9gYg8K7QKi4eY3QuCsBEPSO0NNloQjBe0ZqhSs1oGeVxxhJF5A==/')) AND ( -markers:ignore ) ) )) itemsPerPage: 15 sortOrder:reverseChronological safeHTML:aggressive children: 2 childrenSortOrder:chronological childrenItemsPerPage:3 (((state:Untouched user.state:ModeratorApproved) OR (state:CommunityFlagged,ModeratorApproved -user.state:ModeratorBanned,ModeratorDeleted) OR (-state:SystemFlagged,ModeratorFlagged user.id:'http://washingtonpost.com/vr5H9gYg8K7QKi4eY3QuCsBEPSO0NNloQjBe0ZqhSs1oGeVxxhJF5A==/')) AND ( -markers:ignore ) )"}]
            */
            var muxArray = new Array();

            var dataUrl;

            $(elms).each(function(index,el) {
                var thisData =  $(el).attr('guid') || $(el).attr('data');
                if (typeof thisData != 'undefined') {
                    query = query.replace("{guid}",thisData);
                    muxArray.push( {"id":thisData,"method":"count","q":query});
                 }
            });
            jQuery.ajax({
                url: echoCountApi + JSON.stringify(muxArray),
                dataType: 'jsonp',
                cache: true})
                .done(function(data,status ){
                    if (status != "error") {
                        $.each(data,function(index,el){
                            var count = (el.result != "error")?el.count:((el.errorCode && el.errorCode == "more_than")?'5000+':'');
                            $(".echo-counter[guid='"+index +"']").html(count);
                        })
                    }
                });

        };

        var resetFixed = function(data) {
            var $shareBarHeight = $('.sticky-top-sharebar'), $streamHeader = $('.echo-apps-conversations-streamHeader');
            if (data == 'opened' && $('.bar-hidden').length === 0 ) {
                $streamHeader.addClass('nav-open');
            } else {
                $streamHeader.removeClass('nav-open');
            }
        };

        var init = function() {
            //register callbacks
            wp_pb.register('comments', 'showComments', showComments, this);

            wp_pb.register('comments', 'commentsReady', function() {
                if (forceShowComments === '1') {
                    showComments();
                }
            });

            wp_pb.register('nav', 'finish_open', function() {
                resetFixed('opened');
            });

            wp_pb.register('nav', 'finish_close', function(){
                resetFixed('closed');
            });

            wp_pb.register('nav', 'menu_start_open', function(){
                var $overlay = $(commentOverlay.overlayElements.overlay);  //check for overlay element
                if ($overlay.length > 0) {  //standard functionality
                    $overlay.parent().hide();
                }
            });

            wp_pb.register('nav', 'menu_finish_close', function(){
                var $overlay = $(commentOverlay.overlayElements.overlay);  //check for overlay element
                if ($overlay.length > 0) {  //standard functionality
                    $overlay.parent().show();
                }
            });


            wp_pb.register('comments', 'commentsMultiOpened',commentOverlay.onOpen);
            wp_pb.register('comments', 'commentsMultiClosed',commentOverlay.onClose);

            //add events
            $('.comment-summary').click(function() {
                //showComments();
                //populating the data object so that the overlay comments panel has enough info to open
                var data = {
                    elm: $(this),
                    guid: $(this).find('.echo_container').attr('guid')
                };
                wp_pb.report('comments', 'showComments', data);
            });


            if (noMobile) {
                $('.pb-f-page-comments').hide();
            }

            if (isMobile) {
                $('.comment-summary.jump').hide();
            }


            //load comments as appropriate
            if (isMobile && loadDeferredMobile) {
                //only load count on standard count element.  Comments loaded on click of comment-summary
                loadCommentCount('.echo-counter');
            } else if (!isMobile && loadDeferred) {
                //load comment count on standard count element first
                loadCommentCount('.echo-counter');
                //set up scroll events.  Comments will load on scroll or click of comment count, comment-summary
                $window.on('scroll.showComments', function() {
                    if ($window.scrollTop() / $echoPlaceholder.offset().top >= loadThreshhold) {
                        //showComments();
                        loadComments();
                    }
                    if ($window.scrollTop() >= $echoPlaceholder.offset().top ) {
                        showComments();
                    }
                });
            } else {
                loadComments();
            }
        }
        return{init:init,showComments:showComments,loadCommentCount:loadCommentCount};
    } ();
    wp_pb.CommentLoader.init();
});
(function(){jQuery.support.cors=true;function myAjax(url,params,success,failure){$.ajax(url,params).done(success).fail(function(jqXHR,textStatus,error){params.dataType="jsonp";if(error.toString().match(/Access is denied/))$.ajax(url,params).done(success).fail(failure);else if(failure)failure(jqXHR,textStatus,error)})}var version=21;var $=jQuery;var T=TWP.Perso.Tools;var $body=$("body");var $window=$(window);var $document=$(document);var $sponsored=null;var $container=null;var $pbcontainer=null;var isHomepage=
false;var $homepageElem=null;var $homepageCards=null;var log=new TWP.Tools.logger("HYBRID");var errorUrl="https://recommendation-hybrid.wpdigital.net/hybrid/hybrid-filter/error.json";var serviceUrl="https://recommendation-hybrid.wpdigital.net/hybrid/hybrid-filter/hybrid.json";var trackingUrl="https://recommendation-hybrid.wpdigital.net/hybrid/hybrid-filter/tracker.json";var visiblityUrl="https://recommendation-hybrid.wpdigital.net/hybrid/hybrid-filter/visible.json";var darwin=null;var experience=
{abtest:"none",abvariant:"default"};var videoUser=null;var videoUUIDs=[];var output="";var validOnes=[];var status=null;var visible=false;var requestResult=null;var trackRenderedAllCalled=false;$document.on("abtest-ready",function(ev,ABT){log.debug("Darwin : Ready");if(!status)darwin=ABT});function isVideoUser(){if(videoUser==null){var videoUser=false;var videos=T.store.getJSONItem("twpVideoHistory");if(videos)for(var uuid in videos)if(videos.hasOwnProperty(uuid)){videoUUIDs.push(uuid);var timestamp=
videos[uuid].timestamp;if(timestamp>Date.now()-3600*1E3)videoUser=true}if(T.store.getJSONItem("usersegments","segmentsFlag.9013442807"))videoUser=true}return videoUser}function chooseExperience(){var variation;log.debug("Choosing experience");if(/force-uk=1/.test(document.location.toString())){experience.abtest="uk";experience.abvariant="uk";return}if(/force-video=1/.test(document.location.toString())){experience.abtest="video";experience.abvariant="video";return}if(darwin)if(T.store.getJSONItem("usersegments",
"segmentsFlag.3605630552")){variation=darwin.get("recommendation-uk");experience.abtest="uk";if(variation.is("uk"))experience.abvariant="uk"}else{if(isVideoUser()){experience.abtest="video";experience.abvariant="video"}}else experience.abvariant="nodarwin"}function isValid(recommendation){return recommendation&&recommendation.url&&recommendation.responsetype&&recommendation.headline&&recommendation.summary&&recommendation.photo&&recommendation.photo.path}function render(recommendations){if(!recommendations||
recommendations.length==0)return _failure("No recommendations");for(var i=0;i<recommendations.length;i++)if(isValid(recommendations[i]))validOnes.push(recommendations[i]);if(validOnes.length==0)return _failure("No valid recommendations");if(visible)trackRenderedAll();log.debug("Render",function(){if(isHomepage)_renderHomepage(validOnes);else _renderArticle(validOnes)});trackLoadedSuccess()}function _renderHomepage(recommendations){var card=null;$homepageElem.find(".label").text("Post Recommends");
var img=renderImgURL(recommendations[0],480,320);$homepageElem.find("img").attr("src",img).attr("data-hi-res-src",img).attr("data-low-res-src",img);$homepageElem.find("section-story-photo-1 a").attr("href",renderURL(recommendations[0])).attr("title",recommendations[0].headline);for(var i=0;i<recommendations.length;i++){card=$($homepageCards[i]);if(card){card.find("a").html(recommendations[i].headline).attr("href",renderURL(recommendations[i])).attr("title",recommendations[i].headline);card.find(".blurb").html(recommendations[i].summary)}}}
function _renderArticle(recommendations){var idx=0;var reco=null;var html="";var classes="";for(var i=0;i<recommendations.length;i++){log.debug("Render item ("+i+")");html=html+renderItem(recommendations[i],idx,recommendations.length);idx=idx+1}html='\x3cdiv class\x3d"postrecommends contentfeed'+classes+'"\x3e'+'\x3cdiv class\x3d"content-strip"\x3e'+'\x3cdiv class\x3d"label-wrapper"\x3e'+'\x3cspan class\x3d"label label-kicker"\x3eThe Post Recommends\x3c/span\x3e'+"\x3c/div\x3e"+'\x3cdiv class\x3d"clear"\x3e\x3c/div\x3e'+
html+'\x3cdiv class\x3d"clear"\x3e\x3c/div\x3e'+"\x3c/div\x3e"+"\x3c/div\x3e";if(html!=output){output=html;$sponsored=$("#slug_postrecommends");$sponsored.remove();$container.html(output);$container.find(".content-strip \x3e .label-wrapper").before($sponsored);$pbcontainer.show();$pbcontainer.after('\x3cdiv class\x3d"clear"\x3e\x3c/div\x3e');status="rendered"}}function renderURL(recommendation){return recommendation.url+"?tid\x3d"+recommendation.responsetype}function renderImgURL(recommendation,w,
h){var url=recommendation.photo.path;return"https://img.washingtonpost.com/wp-apps/imrs.php?src\x3d"+encodeURIComponent(url)+"\x26w\x3d"+w+"\x26h\x3d"+h}function renderClasses(recommendation,index,total){var classes="";if(recommendation.responsetype.match(/video/))classes=classes+"video ";if(index==0)classes=classes+"first ";if(index==total-1)classes=classes+"last";return classes}function renderItem(recommendation,index,total){var node=$($("#postrecommends-article-template").html());node.addClass(renderClasses(recommendation,
index,total));var headline=node.find(".headline a");headline.html(recommendation.headline);headline.attr("href",renderURL(recommendation));var linkImg=node.find(".photo-wrapper a");linkImg.attr("href",renderURL(recommendation));var blurb=node.find(".blurb");blurb.html(recommendation.summary);var img='\x3cimg src\x3d"'+renderImgURL(recommendation,480,320)+'"'+' data-hi-res-src\x3d"'+renderImgURL(recommendation,480,320)+'"'+' data-low-res-src\x3d"'+renderImgURL(recommendation,112,75)+'"'+' data-threshold\x3d"112" class\x3d"courtesy-of-the-resizer"\x3e';
node.find(".photo-wrapper img").replaceWith(img);if(recommendation.responsetype.match(/video/)){var time="";if(recommendation.videoDuration&&recommendation.videoDuration>1E3){var seconds=Math.floor(recommendation.videoDuration/1E3);var minutes=Math.floor(seconds/60);seconds=seconds%60;if(seconds<10)seconds="0"+seconds.toString();time=minutes+":"+seconds}var caption='\x3cdiv class\x3d"standalone-overlay posttv-playlist-text-play-btn"\x3e'+'\x3ca class\x3d"video-play" href\x3d"'+renderURL(recommendation)+
'"\x3e'+'\x3cspan class\x3d"fa fa-play icon-left"\x3e\x3c/span\x3e\x3cspan\x3ePlay Video\x3c/span\x3e'+'\x3cspan class\x3d"duration"\x3e'+time+"\x3c/span\x3e"+"\x3c/a\x3e"+"\x3c/div\x3e";blurb.after(caption)}return node[0].outerHTML}function trackClicks(){$container.on("click","a",null,function(ev){var link=this;log.debug("Click",function(){var href=link.href;var tid=href.replace(/.*\?tid=/,"");log.debug("URL : "+href);trackClicked(href,tid);setTimeout(function(){log.debug("Redirecting");document.location=
href},200)});return false})}function getBasicParams(){var params={version:version};params["url"]=document.location.toString().replace(/\?.*/,"");params["s_vi"]=T.SVI.get();params["user2281234048"]=T.store.getJSONItem("usersegments","segmentsFlag.2281234048");params["user2582021445"]=T.store.getJSONItem("usersegments","segmentsFlag.2582021445");params["user3605630552"]=T.store.getJSONItem("usersegments","segmentsFlag.3605630552");params["user9013442807"]=T.store.getJSONItem("usersegments","segmentsFlag.9013442807");
params["abtest"]=experience.abtest;params["abvariant"]=experience.abvariant;return params}function init(){status="initializing";log.debug("Setting up click handlers");trackClicks();chooseExperience();log.debug("Setting parameters");var params=getBasicParams();if(experience.abtest=="video"&&experience.abvariant=="video")params["videoUUID"]=videoUUIDs.join("|");if(isHomepage){params["placement"]="homepage";params["count"]=$homepageCards.length}log.debug("Requesting recommendations");requestResult="launching";
var ajaxSuccess=function(data){requestResult="OK";try{log.debug("Received",function(){render(data["results"])})}catch(e){return _failure(e)}};var ajaxFailure=function(jqXHR,textStatus,error){try{requestResult=textStatus+" ("+jqXHR.status+")"}catch(e){requestResult=textStatus}return _failure("Failed request : "+requestResult)};myAjax(serviceUrl,{data:params,dataType:"json",type:"POST"},ajaxSuccess,ajaxFailure);status="requested";requestResult="launched";trackRequested()}function trackLoadedSuccess(){}
function trackLoadedFailure(){}function trackRequested(){}function trackVisible(){if(status)myAjax(visiblityUrl,{data:{visible:status},dataType:"json",type:"POST"});if(status=="rendered")trackRenderedAll();try{var pbPos=Math.floor($pbcontainer.offset().top);var scroll=Math.floor($body.scrollTop());var height=window.innerHeight;if(status!="rendered"){log.debug("Position : "+pbPos+"/"+scroll+"/"+height);trackError("Visible but not yet rendered : "+requestResult)}}catch(e){trackError(e)}}function trackClicked(url,
tid){T.Omniture.send("post_recommends","",{prop69:tid},log);var params=getBasicParams();params["log"]=log.text();params["rectype"]=tid;params["clickurl"]=url.replace(/\?.*/,"").replace(/https?:/,"");log.debug("Calling tracker.json");myAjax(trackingUrl,{data:params,dataType:"json",type:"POST"})}function trackRenderedAll(){if(!trackRenderedAllCalled){trackRenderedAllCalled=true;var param=[];for(var i=0;i<validOnes.length;i++)param.push(validOnes[i].responsetype);T.Omniture.send("post_recommends","",
{prop72:param.join(",")},log)}}function trackError(e){var params={error:e.toString(),log:log.text(),version:version,location:document.location.toString()};if(e.stack)params.stack=e.stack.toString();myAjax(errorUrl,{data:params,dataType:"json",type:"POST"})}function _preload(){try{log.debug("Requesting",init)}catch(e){trackError(e)}}function _visible(){log.debug("Visible",function(){visible=true;try{trackVisible()}catch(e){trackError(e)}})}function _failure(error){log.debug("Failure",function(){$pbcontainer.hide();
trackError(error);trackLoadedFailure();status="failed"})}$(function(){log.debug("DOM Ready",function(){try{log.debug("Finding containers");$container=$("#post-recommends");$pbcontainer=$container.parent();if($("html").hasClass("homepage")){isHomepage=true;$homepageElem=$(".pb-f-homepage-card:last");$homepageCards=$homepageElem.find("ul.story-list \x3e li");$pbcontainer.remove();$pbcontainer=$homepageElem}log.debug("Setting up scroll listener");T.Events.smartPreload($pbcontainer,{preload:_preload,
visible:_visible,screens:2})}catch(e){trackError(e)}})})})();
(function(){$(window.document).on("abtest-ready",function(e,ABT){var test=ABT.get("ads-outbrain");if(test.is("enabled")){var $feature=$(".pb-f-page-outbrain");$feature.show();var $container=$("#outbrain-container");$container.addClass("OUTBRAIN");var obSc=document.createElement("script");obSc.src="//widgets.outbrain.com/outbrain.js";obSc.async="async";obSc.type="text/javascript";$container.append(obSc)}})})(jQuery);
!function(a,b,c){var d=a[b],e=c(a,a.document);a[b]=e,a[b].noConflict=function(){return a[b]=d,e}}(this,"VisSense",function(a,b,c){function d(a,b){return function(){var d=arguments;return g(function(){a.apply(c,d)},b||0)}}function e(a,b){var c=q;return function(){var d=this,e=arguments;c(),c=g(function(){a.apply(d,e)},b)}}function f(a,b){var d=p(b),e=p(a);return d||e?d&&e?(j(Object.keys(b),function(d){a[d]===c&&(a[d]=b[d])}),a):d?b:a:b}function g(a,b){var c=setTimeout(function(){a()},b||0);return function(){clearTimeout(c)}}
function h(a,b){return function(){return(o(a)?a():a)?b():c}}function i(a,b,c){for(var d=-1,e=Object.keys(b),f=e.length,g=o(c);++d<f;){var h=e[d];a[h]=g?c(a[h],b[h],h,a,b):b[h]}return a}function j(a,b,d){for(var e=0,f=a.length;f>e;e++){var g=b.call(d,a[e],e,a);if(g!==c)return g}}function k(a){return a}function l(a){return a!==c}function m(a){return a&&"object"==typeof a&&"number"==typeof a.length&&"[object Array]"===Object.prototype.toString.call(a)||!1}function n(a){return a&&1===a.nodeType||!1}function o(a){return"function"==
typeof a||!1}function p(a){var b=typeof a;return"function"===b||a&&"object"===b||!1}function q(){}function r(){return(new Date).getTime()}function s(a){var b,d=!1;return function(){return d||(b=a.apply(c,arguments),d=!0),b}}function t(a,b,c){var d=q,e=!1;return function(){var f=r(),h=arguments,i=function(){e=f,a.apply(c,h)};e&&e+b>f?(d(),d=g(i,b)):(e=f,g(i,0))}}function u(b){var c=b||a;return{height:c.innerHeight,width:c.innerWidth}}function v(b,c){return(c||a).getComputedStyle(b,null)}function w(a,
b){return a.getPropertyValue(b)}function x(a,b){b||(b=v(a));var c=w(b,"display");if("none"===c)return!1;var d=a.parentNode;return n(d)?x(d):!0}function y(b,c){if(b===(c||a).document)return!0;if(!b||!b.parentNode)return!1;var d=v(b,c),e=w(d,"visibility");return"hidden"===e||"collapse"===e?!1:x(b,d)}function z(a,b){return!a||a.width<=0||a.height<=0?!1:a.bottom>0&&a.right>0&&a.top<b.height&&a.left<b.width}function A(a,b){var c=a.getBoundingClientRect(),d=u(b);if(!z(c,d)||!y(a))return 0;var e=0,f=0;return c.top>=
0?e=Math.min(c.height,d.height-c.top):c.bottom>0&&(e=Math.min(d.height,c.bottom)),c.left>=0?f=Math.min(c.width,d.width-c.left):c.right>0&&(f=Math.min(d.width,c.right)),Math.round(e*f/(c.height*c.width)*1E3)/1E3}function B(b){return!F(b||a).isHidden()}function C(b,c){if(!(this instanceof C))return new C(b,c);if(!n(b))throw new Error("not an element node");this._element=b,this._config=f(c,{fullyvisible:1,hidden:0,referenceWindow:a,percentageHook:A,visibilityHooks:[]});var d=F(this._config.referenceWindow);
this._config.visibilityHooks.push(function(){return!d.isHidden()})}function D(a,b){var c=a.state(),d=c.percentage;return b&&d===b.percentage&&b.percentage===b.previous.percentage?b:c.hidden?C.VisState.hidden(d,b):c.fullyvisible?C.VisState.fullyvisible(d,b):C.VisState.visible(d,b)}function E(a,b){var c=f(b,{strategy:[new E.Strategy.PollingStrategy,new E.Strategy.EventStrategy],async:!1});this._visobj=a,this._state={},this._started=!1;var d="*#"+r();this._pubsub=new G({async:c.async,anyTopicName:d}),
this._events=[d,"start","stop","update","hidden","visible","fullyvisible","percentagechange","visibilitychange"],this._strategy=new E.Strategy.CompositeStrategy(c.strategy),this._strategy.init(this),this._pubsub.on("update",function(a){var b=a._state.percentage,c=a._state.previous.percentage;b!==c&&a._pubsub.publish("percentagechange",[a,b,c])}),this._pubsub.on("update",function(a){a._state.code!==a._state.previous.code&&a._pubsub.publish("visibilitychange",[a])}),this._pubsub.on("visibilitychange",
function(a){a._state.visible&&!a._state.previous.visible&&a._pubsub.publish("visible",[a])}),this._pubsub.on("visibilitychange",function(a){a._state.fullyvisible&&a._pubsub.publish("fullyvisible",[a])}),this._pubsub.on("visibilitychange",function(a){a._state.hidden&&a._pubsub.publish("hidden",[a])}),j(this._events,function(a){o(c[a])&&this.on(a,c[a])},this)}var F=function(b){return function(a,b){var c=function(a,b){return{property:a,event:b}},d="visibilitychange",e=[c("webkitHidden","webkit"+d),c("msHidden",
"ms"+d),c("mozHidden","moz"+d),c("hidden",d)],f=j(e,function(c){return a[c.property]!==b?{isHidden:function(){return!!a[c.property]||!1},onVisibilityChange:function(b){return a.addEventListener(c.event,b,!1),function(){a.removeEventListener(c.event,b,!1)}}}:void 0});return f||{isHidden:function(){return!1},onVisibilityChange:function(){return q}}}((b||a).document)},G=function(a){function b(a){this._cache={},this._onAnyCache=[],this._config=f(a,{async:!1,anyTopicName:"*"})}var c=function(a,b){j(a,
function(a){a(b)})};return b.prototype.on=function(b,c){if(!o(c))return q;var e=function(b){return c.apply(a,b||[])},f=this._config.async?d(e):e,g=function(a,b,c){return function(){var c=b.indexOf(a);return c>-1?(b.splice(c,1),!0):!1}};return b===this._config.anyTopicName?(this._onAnyCache.push(f),g(f,this._onAnyCache,"*")):(this._cache[b]||(this._cache[b]=[]),this._cache[b].push(f),g(f,this._cache[b],b))},b.prototype.publish=function(a,b){var e=(this._cache[a]||[]).concat(a===this._config.anyTopicName?
[]:this._onAnyCache),f=!!this._config.async,g=f?d(c):function(a,b){return c(a,b),q};return g(e,b||[])},b}();C.prototype.state=function(){var a=j(this._config.visibilityHooks,function(a){return a(this._element)?void 0:C.VisState.hidden(0)},this);return a||function(a,b){var c=b.percentageHook(a,b.referenceWindow);return c<=b.hidden?C.VisState.hidden(c):c>=b.fullyvisible?C.VisState.fullyvisible(c):C.VisState.visible(c)}(this._element,this._config)},C.prototype.percentage=function(){return this.state().percentage},
C.prototype.element=function(){return this._element},C.prototype.referenceWindow=function(){return this._config.referenceWindow},C.prototype.isFullyVisible=function(){return this.state().fullyvisible},C.prototype.isVisible=function(){return this.state().visible},C.prototype.isHidden=function(){return this.state().hidden},C.fn=C.prototype,C.of=function(a,b){return new C(a,b)};var H={HIDDEN:[0,"hidden"],VISIBLE:[1,"visible"],FULLY_VISIBLE:[2,"fullyvisible"]};return C.VisState=function(){function a(a,
b,c){return c&&delete c.previous,{code:a[0],state:a[1],percentage:b,previous:c||{},fullyvisible:a[0]===H.FULLY_VISIBLE[0],visible:a[0]===H.VISIBLE[0]||a[0]===H.FULLY_VISIBLE[0],hidden:a[0]===H.HIDDEN[0]}}return{hidden:function(b,c){return a(H.HIDDEN,b,c)},visible:function(b,c){return a(H.VISIBLE,b,c)},fullyvisible:function(b,c){return a(H.FULLY_VISIBLE,b,c)}}}(),E.prototype.visobj=function(){return this._visobj},E.prototype.publish=function(a,b){var c=this._events.indexOf(a)>=0;if(c)throw new Error('Cannot publish internal event "'+
a+'" from external scope.');return this._pubsub.publish(a,b)},E.prototype.state=function(){return this._state},E.prototype.start=function(a){if(this._started)return this;var b=f(a,{async:!1});return this._cancelAsyncStart&&this._cancelAsyncStart(),b.async?this.startAsync():(this.update(),this._pubsub.publish("start",[this]),this._strategy.start(this),this._started=!0,this)},E.prototype.startAsync=function(a){this._cancelAsyncStart&&this._cancelAsyncStart();var b=this,c=g(function(){b.start(i(f(a,
{}),{async:!1}))});return this._cancelAsyncStart=function(){c(),b._cancelAsyncStart=null},this},E.prototype.stop=function(){this._cancelAsyncStart&&this._cancelAsyncStart(),this._started&&(this._strategy.stop(this),this._pubsub.publish("stop",[this])),this._started=!1},E.prototype.update=function(){this._state=D(this._visobj,this._state),this._pubsub.publish("update",[this])},E.prototype.on=function(a,b){return this._pubsub.on(a,b)},E.Builder=function(){var a=function(a,b){var c=null,d=a.strategy===
!1,e=!d&&(a.strategy||b.length>0);if(e){var f=!!a.strategy,g=m(a.strategy),h=f?g?a.strategy:[a.strategy]:[];c=h.concat(b)}else c=d?[]:a.strategy;return c};return function(b){var c={},d=[],e=[],f=!1,g=null;return{set:function(a,b){return c[a]=b,this},strategy:function(a){return d.push(a),this},on:function(a,b){return e.push([a,b]),this},build:function(h){var i=function(){var h=a(c,d);c.strategy=h;var i=b.monitor(c);return j(e,function(a){i.on(a[0],a[1])}),f=!0,g=i},k=f?g:i();return o(h)?h(k):k}}}}(),
E.Strategy=function(){},E.Strategy.prototype.init=q,E.Strategy.prototype.start=q,E.Strategy.prototype.stop=q,E.Strategy.CompositeStrategy=function(a){this._strategies=m(a)?a:[a]},E.Strategy.CompositeStrategy.prototype=Object.create(E.Strategy.prototype),E.Strategy.CompositeStrategy.prototype.init=function(a){j(this._strategies,function(b){o(b.init)&&b.init(a)})},E.Strategy.CompositeStrategy.prototype.start=function(a){j(this._strategies,function(b){o(b.start)&&b.start(a)})},E.Strategy.CompositeStrategy.prototype.stop=
function(a){j(this._strategies,function(b){o(b.stop)&&b.stop(a)})},E.Strategy.PollingStrategy=function(a){this._config=f(a,{interval:1E3}),this._started=!1},E.Strategy.PollingStrategy.prototype=Object.create(E.Strategy.prototype),E.Strategy.PollingStrategy.prototype.start=function(a){return this._started||(this._clearInterval=function(b){var c=setInterval(function(){a.update()},b);return function(){clearInterval(c)}}(this._config.interval),this._started=!0),this._started},E.Strategy.PollingStrategy.prototype.stop=
function(){return this._started?(this._clearInterval(),this._started=!1,!0):!1},E.Strategy.EventStrategy=function(a){this._config=f(a,{throttle:50}),this._config.debounce>0&&(this._config.throttle=+this._config.debounce),this._started=!1},E.Strategy.EventStrategy.prototype=Object.create(E.Strategy.prototype),E.Strategy.EventStrategy.prototype.start=function(a){return this._started||(this._removeEventListeners=function(b){var c=F(a.visobj().referenceWindow()),d=c.onVisibilityChange(b);return addEventListener("scroll",
b,!1),addEventListener("resize",b,!1),addEventListener("touchmove",b,!1),function(){removeEventListener("touchmove",b,!1),removeEventListener("resize",b,!1),removeEventListener("scroll",b,!1),d()}}(t(function(){a.update()},this._config.throttle)),this._started=!0),this._started},E.Strategy.EventStrategy.prototype.stop=function(){return this._started?(this._removeEventListeners(),this._started=!1,!0):!1},C.VisMon=E,C.PubSub=G,C.fn.monitor=function(a){return new E(this,a)},C.Utils={async:d,debounce:e,
defaults:f,defer:g,extend:i,forEach:j,fireIf:h,identity:k,isArray:m,isDefined:l,isElement:n,isFunction:o,isObject:p,isPageVisible:B,isVisibleByStyling:y,noop:q,now:r,once:s,throttle:t,percentage:A,VisibilityApi:F(),createVisibilityApi:F,_viewport:u,_isInViewport:z,_isDisplayed:x,_computedStyle:v,_styleProperty:w},C});
!function(e,t){typeof module!="undefined"?module.exports=t():typeof define=="function"&&typeof define.amd=="object"?define(t):this[e]=t()}("domready",function(e){function p(e){h=1;while(e=t.shift())e()}var t=[],n,r=!1,i=document,s=i.documentElement,o=s.doScroll,u="DOMContentLoaded",a="addEventListener",f="onreadystatechange",l="readyState",c=o?/^loaded|^c/:/^loaded|c/,h=c.test(i[l]);return i[a]&&i[a](u,n=function(){i.removeEventListener(u,n,r),p()},r),o&&i.attachEvent(f,n=function(){/^c/.test(i[l])&&
(i.detachEvent(f,n),p())}),e=o?function(n){self!=top?h?n():t.push(n):function(){try{s.doScroll("left")}catch(t){return setTimeout(function(){e(n)},50)}n()}()}:function(e){h?e():t.push(e)}});
(function($,wp_pb,wp_get_import){if(!(document.location.toString().match(/from-prime-time-hearthrob-to-hollywood-freak/)||document.location.toString().match(/islamic-states-embrace-of-social-media-puts-tech-companies-in-a-bind/)))return;domready(function(){debug("DOM Ready");domReady=true;article=$("#article-body")});var $b=$("body");var $w=$(window);var $d=$(document);var init=function(){};var initNoKmap=function(){};var start=Date.now();var $html=$("html");var $body=$("body");var $window=$(window);
var $header=$("#wp-header");var ad=null;var closer=null;var signup=null;var footer=null;var article=null;var sidebar=null;var children=null;var container=null;var selector=".kmap-info, .kmap-keyword, .kmap-inline-trigger, .kmap-person-trigger, .kmap-series-trigger, .kmap-theme-buttons";var sidebarActivated=false;var initialScroll=0;var pr=false;var darwin=false;var abdarwin=false;var abvariant=null;var devmode=false;var domReady=false;var mockupData="";var mockupReady=false;var featureStarted=false;
var sviFull=document.cookie.match(/s_vi=([^;]+)/)?RegExp.$1:"";var visibility={};var screenSize=0;var toRemove=[];if(document.location.toString().match(/[?&#]kmap=1/)||window.localStorage&&window.localStorage.getItem("kmap"))$(window.document).on("abtest-before",function(e,ABT){debug("Forcing experience in Darwin");trackEvent("ready","darwin-before");abvariant="experiment";ABT.forceTest("knowledgemap-experiment1","experiment")});if(document.location.toString().match(/[?&#]pr=1/))pr=true;var initFeature=
function(){if(!domReady||!mockupReady||!darwin){if(domready&&mockupReady&&!darwin&&Date.now()-start<5E3)setTimeout(initFeature,100);if(Date.now()-start<6E4)setTimeout(initFeature,100);else debug("Giving up");return}if(featureStarted)return;else{featureStarted=true;if(darwin){abdarwin=true;var variation=darwin.get("knowledgemap-experiment1");if(variation.is("experiment"))abvariant="experiment"}else debug("Darwin not ready");if(abvariant=="experiment"){if(devmode)article.html(mockupData);else article.append(mockupData);
debug("Initializing");init();debug("Tracking pageview");trackEvent("experiment","pageview");debug("Initializing (done)")}else{article.append(mockupData);debug("Initializing");initNoKmap();debug("Tracking pageview");trackEvent("default","pageview");debug("Initializing (done)")}}};setTimeout(initFeature,200);$(window.document).on("abtest-ready",function(e,ABT){darwin=ABT;debug("Darwin is ready");trackEvent("ready","darwin");initFeature()});var logs=[];var groupLevel=0;function debug(msg){msgline="[DBGKMAP] "+
msg+" ("+(Date.now()-start)+"ms)";logs.push(msgline);if(window.localStorage&&localStorage.getItem("debug-knowledge-map"))console.log(msgline)}function debugGroupStart(name){groupLevel=groupLevel+1;msgline="[DBGKMAP] "+name;logs.push("\x3e\x3e "+msgline);if(window.localStorage&&localStorage.getItem("debug-knowledge-map"))if(window.console&&console.group)console.group(msgline)}function debugGroupEnd(){groupLevel=groupLevel-1;msgline="[DBGKMAP] "+name;logs.push("\x3c\x3c "+msgline);if(window.localStorage&&
localStorage.getItem("debug-knowledge-map"))if(window.console&&console.groupEnd)console.groupEnd()}function debounce(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args)}}function updateUrlParam(url,key,value){value=encodeURIComponent(value);var n=new RegExp("([?\x26])"+key+"\x3d.*?(\x26|$)",
"i");var i=-1!==url.indexOf("?")?"\x26":"?";return url.match(n)?url.replace(n,"$1"+key+"\x3d"+value+"$2"):url+i+key+"\x3d"+value}debug("Adding fonts CSS");$("head").append('\x3clink rel\x3d"stylesheet" href\x3d"/pb/resources/css/fonts.css?_\x3d'+wp_pb.resourceToken+'" type\x3d"text/css"/\x3e');if(window.localStorage&&localStorage.getItem("kmap-development-mockup-url")&&localStorage.getItem("kmap-development-mockup-css")){devmode=true;var mockupURL=localStorage.getItem("kmap-development-mockup-url");
var mockupCSS=localStorage.getItem("kmap-development-mockup-css");$("head").append('\x3clink rel\x3d"stylesheet" href\x3d"'+mockupCSS+'" type\x3d"text/css"/\x3e');$.get(mockupURL,{},function(data){debug("Downloading mockup HTML (done)");mockupData=data;mockupReady=true;abvariant="experiment"},"html")}else $.get("https://www.washingtonpost.com/wp-stat/html/post/isis.html",{},function(data){debug("Downloading mockup HTML (done)");mockupData=data;mockupReady=true});var handleBodyscroll=function(){if(window.innerWidth<=
768&&container.hasClass("visible"))$html.addClass("noscroll");else $html.removeClass("noscroll")};var handleScrollAndResize=function(){if(devmode)return;handleBodyscroll();var sidebarPosition=sidebar.offset();var scrollPosition=$window.scrollTop();var topPosition=0;if($header.hasClass("bar-hidden"))topPosition=0;else topPosition=$("#nav-bar").outerHeight();if($(".top-sharebar-fixed").length>0)topPosition=topPosition+$(".top-sharebar-fixed").outerHeight();if(scrollPosition+topPosition>sidebarPosition.top){container.addClass("sticky");
container.css("top",topPosition);container.css("left",sidebarPosition.left);container.css("width",sidebar.width())}else{container.removeClass("sticky");container.css("top",0);container.css("left",0);container.css("width","100%")}};var resizeImages=function(initial){$(container).find("img").each(function(i,img){$img=$(img);var zoom=false;var src=$img.data("origsrc");var width=window.innerWidth;var resize="https://img.washingtonpost.com/wp-apps/imrs.php?src\x3d"+encodeURIComponent(src);var oldScreenSize=
screenSize;if(width<=450){screenSize=450;resize=resize+"\x26w\x3d450"}else if(width<=560){screenSize=560;resize=resize+"\x26w\x3d560"}else if(width<=768){screenSize=768;resize=resize+"\x26w\x3d768"}else{zoom=true;screenSize=1024;resize=resize+"\x26w\x3d285"}if(oldScreenSize==screenSize&&!initial)return;debug("Resize image URLs");$img.attr("src",resize);$img.off("click.modal");$img.removeClass("zoom-in");$(".modal-image-in-focus").remove();$(".overlay-image-in-focus").remove();if($img.parent().is("a"))zoom=
false;if(zoom){var modalClass="modal-kmap-"+i;$img.addClass("zoom-in");$img.addClass(modalClass);$("\x3cimg/\x3e").attr("src",src).load(function(){var placeholder,defaultTopMargin=$w.height()<480?0:40,defaultLeftMargin=$w.width()<760?0:40,rawWidth=this.width,rawHeight=this.height,displayWidth=$img.width(),displayHeight=$img.height(),bodyWidth=$b.width(),windowWidth=$w.width(),screenWidth=(bodyWidth<windowWidth?bodyWidth:windowWidth)-2*defaultLeftMargin,screenHeight=$w.height()-2*defaultTopMargin,
isRawImageMoreHorizontalThanScreen=rawWidth/screenWidth>=rawHeight/screenHeight,isRawImageMoreVerticalThanScreen=!isRawImageMoreHorizontalThanScreen,isRawImageBig=rawWidth*rawHeight>displayWidth*displayHeight,isRawImageTooWide=rawWidth>screenWidth,isRawImageTooTall=rawHeight>screenHeight,dimensions={w:screenWidth,h:screenHeight,t:defaultTopMargin,l:defaultLeftMargin};if(isRawImageTooWide&&isRawImageTooTall)if(isRawImageMoreHorizontalThanScreen)dimensions.t+=Math.floor((screenHeight-rawHeight*(screenWidth/
rawWidth))/2);else dimensions.l+=Math.floor((screenWidth-rawWidth*(screenHeight/rawHeight))/2);else if(isRawImageTooWide)dimensions.t+=Math.floor((screenHeight-rawHeight*(screenWidth/rawWidth))/2);else if(isRawImageTooTall)dimensions.l+=Math.floor((screenWidth-rawWidth*(screenHeight/rawHeight))/2);else{dimensions.w=rawWidth;dimensions.h=rawHeight;dimensions.t+=Math.floor((screenHeight-rawHeight)/2);dimensions.l+=Math.floor((screenWidth-rawWidth)/2)}var $modal=$('\x3cdiv class\x3d"modal-content modal-image-in-focus"\x3e\x3ci class\x3d"inline-content-img-full-close close"\x3e\x26#215;\x3c/i\x3e\x3cimg src\x3d"'+
src+'" class\x3d"modal-closer zoom-out" style\x3d"max-width:'+dimensions.w+"px;max-height:"+dimensions.h+'px;"/\x3e\x3c/div\x3e');$("body").append($modal);$modal.jqm({overlayClass:"overlay-image-in-focus",overlay:100,closeClass:"modal-closer",trigger:false,onShow:function(obj){obj.o.prependTo("body");obj.w.css({"margin-top":dimensions.t+"px","margin-left":dimensions.l+"px"}).fadeIn("1000");$w.on("scroll."+modalClass,function(ev){$modal.jqmHide()});$d.on("keyup."+modalClass,function(ev){if(ev.which==
27)$modal.jqmHide()});$(obj.w).find(".inline-content-img-full-close").on("click."+modalClass,function(ev){$modal.jqmHide()});$(".modal-image-in-focus").addClass("zoom-out")},onHide:function(obj){obj.w.fadeOut("500");obj.o.fadeOut("1500",function(){obj.o.remove()});$w.off("scroll."+modalClass);$d.off("keyup."+modalClass);$(obj.w).find(".inline-content-img-full-close").off("click."+modalClass);$(".modal-image-in-focus").removeClass("zoom-out")}});$img.on("click.modal",function(){$modal.jqmShow()})})}})};
var activateSidebar=function(){if(!sidebarActivated){sidebarActivated=true;handleScrollAndResize();var scroller=function(){handleScrollAndResize();resizeImages()};$window.scroll(scroller);$window.resize(scroller);for(var i=0;i<toRemove.length;i++)toRemove[i].remove();toRemove=[];debug("Activate sidebar (done)")}};var addSnippetToSidebar=function(selector){debug("Save initial scroll position");initialScroll=$body.scrollTop();debug("Finding new snippet");var div=article.find(selector);if(div.length==
0)return;debug("Removing signup form");signup.detach();debug("Emptying container");if(!devmode)container.empty();debug("Cloning content");var newdiv=div[0].cloneNode(true);newdiv.id=div[0].id+"-clone";debug("Adding content to container");container.prepend(newdiv);container.prepend(closer);debug("Instrumenting external links");$(newdiv).find("a").each(function(idx,a){$a=$(a);$a.attr("target","_blank");var href=$a.attr("href");href=updateUrlParam(href,"tid",selector.replace(/^#/,"").replace(/[^\w]/g,
"-"));$a.attr("href",href);$a.click(function(){trackEvent(href,"external")})});debug("Update image URLs");$(newdiv).find("img").each(function(idx,img){$img=$(img);$img.data("origsrc",$img.attr("src"))});resizeImages(true);if(div[0].className.match(/\kmap-series/)){debug("Re-adding signup");container.append(signup)}};var trackEvent=function(target,name){$.post("https://recommendation-hybrid.wpdigital.net/hybrid/hybrid-filter/kmapevent",{start:start,elapsed:Date.now()-start,event:name,target:target,
svi:sviFull,pr:pr,darwin:!!darwin,omniture:!!(window.s&&window.s.sendDataToOmniture),abdarwin:abdarwin,abvariant:abvariant||"default",location:document.location.toString(),logs:logs.join("\n")});if(name=="click"&&window.s&&window.s.sendDataToOmniture)try{s.sendDataToOmniture("Knowledge Map Click","event80",{eVar26:target})}catch(e){}};var trackVisibility=function(elem){VisSense(elem).monitor({visible:function(){var target=$(elem).attr("data-id");if(!visibility[target]){visibility[target]=true;trackEvent(target,
"visible")}}}).start()};var linkClicked=function(ev){debugGroupStart("Link clicked");debug("Activate sidebar");activateSidebar();debug("Setting selected class");article.find(selector+".selected").removeClass("selected");$(this).addClass("selected");debug("Emptying the sidebar");if(!devmode)ad.remove();footer.remove();closer.detach();debug("Finding data target");var target=$(this).attr("data-id");debug("Adding snippet to sidebar");addSnippetToSidebar("#"+target);debug("Showing container");container.addClass("visible");
debug("Handling body scroll");handleBodyscroll();debug("Tracking click");trackEvent(target,"click");debug("Adding new content (done)");debugGroupEnd()};var closerClicked=function(){$html.removeClass("noscroll");$body.scrollTop(initialScroll);closer.addClass("closing");container.addClass("closing");setTimeout(function(){closer.removeClass("closing");container.removeClass("closing");container.removeClass("visible")},250);article.find(selector+".selected").removeClass("selected")};var updateURL=function(){var newurl=
null;var loc=document.location.toString();var replace=window.history&&window.history.replaceState;if(replace){if(!/[?&#]kmap=1/.test(loc)){if(!/\?/.test(loc))newurl=loc.replace(/#.*/,"")+"?kmap\x3d1";else newurl=loc.replace(/#.*/,"")+"\x26kmap\x3d1";var idx=newurl.indexOf(document.location.pathname);history.replaceState({},"",newurl.substr(idx))}}else if(!/[?&#]kmap=1/.test(loc))document.location=loc.replace(/#.*/,"")+"#kmap\x3d1"};var setupSignup=function(){if(window.localStorage&&localStorage.getItem("kmap-signup")){localStorage.removeItem("kmap-signup");
var modal=$("#knowledge-map-signup-modal").detach();$body.append(modal);modal=modal.jqm({closeClass:"kmap-follow-modal-close"});modal.jqmShow()}signup=$("#knowledge-map-signup").detach();signup.find("input[name\x3dredirect]").attr("value",document.location.toString());signup.find("form").submit(function(){this.action=this.action.replace(/https/,"http");document.cookie="kmap-signup\x3d1"+";max-age\x3d"+3600*24*365+";expires\x3d"+(new Date(Date.now()+3600*24*365*1E3)).toUTCString();if(window.localStorage)localStorage.setItem("kmap-signup",
true)})};var setupSharelinks=function(){var sharer=function(element,elementObject,socialUrl,shareUrlLong,socialUrl2,style){var shareUrl="";var currentURL="";if(abvariant=="experiment"&&pr)currentURL="http://wapo.st/1RBmkx6";else if(abvariant=="experiment")currentURL="http://wapo.st/1HQVI0e";else currentURL="http://wapo.st/1K9YhkM";if(socialUrl.match(/mailto/)){shareUrl="mailto:?subject\x3d"+encodeURIComponent(document.title);shareUrl=shareUrl+"\x26body\x3d"+encodeURIComponent(currentURL);window.location.href=
shareUrl}else if(socialUrl.match(/whatsapp/)){shareUrl="whatsapp://send?text\x3d"+encodeURIComponent(document.title);shareUrl=shareUrl+" - "+encodeURIComponent(currentURL);window.location.href=shareUrl}else if(socialUrl.match(/twitter/)){shareUrl=socialUrl+encodeURIComponent(currentURL)+"\x26text\x3d"+encodeURIComponent(document.title);window.open(shareUrl,"share",style)}else{shareUrl=socialUrl+encodeURIComponent(currentURL);window.open(shareUrl,"share",style)}return false};$(".top-sharebar-wrapper a, .social-tools-wrapper-bottom a").each(function(idx,
item){if(item.postShare&&item.postShare.callPostShare)item.postShare.callPostShare=sharer})};init=function(){updateURL();$(".pb-f-article-article-body").addClass("kmap");article.find(".kmap-themes").addClass("active");var triggers=article.find(selector).addClass("active");triggers.click(linkClicked);triggers.each(function(idx,elem){trackVisibility(elem)});closer=$("#kmap-modal-closer").detach();closer.click(closerClicked);setupSignup();var marker=$("#knowledge-map-sidebar");sidebar=marker.parent().parent();
container=marker.parent();marker.remove();ad=sidebar.find(".pb-f-ad-flex");footer=sidebar.find(".pb-f-page-footer-v2");if(!devmode)addSnippetToSidebar(".kmap-snippet.kmap-series");if(window.innerWidth>768)container.addClass("visible");children=sidebar.children();for(var i=0;i<children.length;i++){var box=$(children[i]);if(!box.hasClass("pb-f-ad-flex")&&!box.hasClass("pb-f-page-footer-v2")&&!box.hasClass("pb-f-knowledge-map-knowledge-map"))if(!devmode)box.remove();else if(!/pf-f-ad/.test(children[i].className))toRemove.push(box)}setTimeout(setupSharelinks,
500)};initNoKmap=function(){setupSignup();$("#signup-box-rr").empty().append(signup).show();article.find(selector).each(function(idx,elem){trackVisibility(elem)})}})(jQuery,wp_pb,wp_get_import);
(function($){$(window.document).on("abtest-ready",function(e,ABT){var variation=ABT.get("recommendation-mostread");if(variation.is("chartbeat")){$("ul.def-feed").hide();$("ul.alt-feed").show()}})})(jQuery);
(function($){try{function cleanUp(){jQuery.fn.shuffle=function(){var j;for(var i=0;i<this.length;i++){j=Math.floor(Math.random()*this.length);$(this[i]).before($(this[j]))}return this};$("#the-most-rr li").shuffle();for(var i=0;i<$("#the-most-rr li").length;i++)if($($("#the-most-rr li")[i]).text().indexOf("The Globe and Mail")>-1)$($("#the-most-rr li")[0]).before($($("#the-most-rr li")[i]));var count=0;var adjustLines=function(){var count=0;$("#the-most-rr .line").each(function(){if(count>2)return false;
$(this).parent().parent().parent().parent().show();count++})};adjustLines()}cleanUp()}catch(e){}})(jQuery);
(function($){var defaultNewsLetter={frequency:"Daily",headline:"Get the Today's Headlines Newsletter",id:"post_newsletter1",name:"Today's Headlines",tagline:"Free daily updates delivered just for you.",template:"signup-confirm-heads",variable:"vars[intent_heads]"},defaultNewsLetters=[{frequency:"Daily",headline:"Get the Today's Headlines Newsletter",id:"post_newsletter1",name:"Today's Headlines",tagline:"Free daily updates delivered just for you.",template:"signup-confirm-heads",variable:"vars[intent_heads]"},
{frequency:"Daily",headline:"Get the Read In Newsletter",id:"post_newsletter112",name:"Read In",tagline:"Free daily updates delivered just for you.",template:"signup-confirm-readin",variable:"vars[intent_readin]"},{frequency:"Weekly",headline:"Get the Lean \x26 Fit Newsletter",id:"post_newsletter8",name:"Lean \x26 Fit",tagline:"Free weekly updates delivered just for you.",template:"signup-confirm-lean",variable:"vars[intent_lean]"},{frequency:"Twice-weekly",headline:"Get the Checkpoint Newsletter",
id:"post_newsletter130",name:"Checkpoint",tagline:"Free twice-weekly updates delivered just for you.",template:"signup-confirm-check",variable:"vars[intent_check]"}],subscribeEmail,washPostId,showNewsletter=function(){$("#signup-box-rr").show()},hideNewsletter=function(){$("#signup-box-rr").hide()},showSignUpForm=function(){$("#newsletter-signUp-form").show();$("#newsletter-signUp-button").hide()},showSignUpButton=function(){$("#newsletter-signUp-form").hide();$("#newsletter-signUp-button").show()},
showErrorMessage=function(message){if(message)$(".newsLetter-error-msg").text(message).show()},hideErrorMessage=function(){$(".newsLetter-error-msg").hide()},setNewsLetterValue=function(data){$("#newsletter-headline").append(data.headline);$("#newsletter-tagline").text(data.tagline)},setRecommendationsValues=function(data){$(".suggestion-list .recommended").each(function(index){$(this).find("p").text("Get "+data[index].name+" ("+data[index].frequency+")");$(this).find("input[type\x3d'checkbox']").attr("value",
data[index].id);$(this).find("input[type\x3d'checkbox']").attr("name",data[index].name)})},toggleRecommendations=function(show){if(show){$("#newsletter-signUp-form, #newsletter-signUp-button, #newsletter-tagline").hide();$("#newsletter-suggestions-rr, #headline-checked, #subscribed-confirmation, #all-newsletters-lbl").show()}else $("#newsletter-suggestions-rr").hide()},showSignUpConfirmation=function(){$("#newsletter-signUp-form, #newsletter-signUp-button, #newsletter-tagline").hide();$("#headline-checked, #subscribed-confirmation, #all-newsletters-lbl").show()},
getUserId=function(){return document.cookie.match(/wapo_login_id=([^;]+)/)?RegExp.$1:""},getWapoId=function(){return document.cookie.match(/wapo_secure_login_id=([^;]+)/)?RegExp.$1:""},getPageData=function(){var section=$("#newsletter-section").text(),subSection=$("#newsletter-subsection").text(),blog=$("#newsletter-blogname").text(),data={};washPostId=getUserId();if(washPostId!=="")data.washPostId=washPostId;if(blog)data.blog=blog;if(subSection)data.subSection=subSection;if(section)data.section=
section;return data},getMainNewsletter=function(){var data=getPageData();return $.ajax({type:"POST",dataType:"json",contentType:"application/json",url:"https://recommendation-newsletter.wpdigital.net/Newsletter/api/newsletter",data:JSON.stringify(data)})},getRecommendations=function(newsletters){var data=getPageData();data.newsletters=newsletters;return $.ajax({type:"POST",dataType:"json",contentType:"application/json",url:"https://recommendation-newsletter.wpdigital.net/Newsletter/api/newsletters",
data:JSON.stringify(data)})},subscribe=function(email){var data,url;if(washPostId!==""){url="https://subscribe.washingtonpost.com/person/newsletter/subscribe";data={"wapoLoginID":washPostId,"wapoSecureID":getWapoId(),"userAgent":navigator.userAgent,"newsletterName":window.Newsletter.id,"metadata":[{"name":"nl_start_method","value":"EI"},{"name":"nl_start_location","value":"RR"}]}}else if(email){url="https://subscribe.washingtonpost.com/person/newsletter/subscribe-email";data={"email":email,"newsletterName":window.Newsletter.id,
"metadata":[{"name":"nl_start_method","value":"EI"},{"name":"nl_start_location","value":"RR"}]}}$.ajax({type:"POST",dataType:"json",contentType:"application/json",url:url,data:JSON.stringify(data),success:function(data){if(data.status=="SUCCESS"){sendCustomTrackProps("event46,event91",trackProps(window.Newsletter.name,1,"simple"),"Newsletter Right Rail Sign-up");setUpRecommendations(window.Newsletter.id)}},error:function(request,status,error){console.log(error,"Error while subscribing")}})},subscribeBundle=
function(){var data,url,newsletters=[],newsletterNames=[];$("#newsletter-suggestions-rr input:checked").each(function(index){newsletters.push($(this).val());newsletterNames.push({name:$(this).attr("name"),position:$(this).attr("data-pos")})});if(newsletters.length>0&&newsletterNames.length>0){if(washPostId!==""){url="https://subscribe.washingtonpost.com/person/newsletter/subscribe-list";data={"wapoLoginID":washPostId,"wapoSecureID":getWapoId(),"userAgent":navigator.userAgent,"newsletters":newsletters,
"metadata":[{"name":"nl_start_method","value":"EA"},{"name":"nl_start_location","value":"RR"}]}}else if(subscribeEmail){url="https://subscribe.washingtonpost.com/person/newsletter/subscribe-list-email";data={"email":subscribeEmail,"newsletters":newsletters,"metadata":[{"name":"nl_start_method","value":"EA"},{"name":"nl_start_location","value":"RR"}]}}$.ajax({type:"POST",dataType:"json",contentType:"application/json",url:url,data:JSON.stringify(data),success:function(data){if(data.status=="SUCCESS"){for(var i=
0;i<newsletterNames.length;i++)sendCustomTrackProps("event46,event91",trackProps(newsletterNames[i].name,newsletterNames[i].position,"enhanced"),"Newsletter Right Rail Sign-up Bundle");setUpRecommendations(newsletters,true);toggleRecommendations(false)}},error:function(request,status,error){console.log(error,"Error while subscribing bundle")}})}},setUpRecommendations=function(newsletterId,confirmBundleSubscribe){var recommendations=getRecommendations([window.Newsletter.id]);recommendations.done(function(data){if(!$.isEmptyObject(data.newsletters)&&
data.newsletters.length>=3&&!confirmBundleSubscribe){window.Newsletters=data.newsletters;setRecommendationsValues(data.newsletters);toggleRecommendations(true);for(var i=0;i<data.newsletters.length-1;i++)sendCustomTrackProps("event59",trackProps(data.newsletters[i+1].name,i+1,"enhanced"),"Newsletter Right Rail Show Recommendations")}else toggleRecommendations(false);showSignUpConfirmation()});recommendations.fail(function(){if(!confirmBundleSubscribe){window.Newsletters=defaultNewsLetters;setRecommendationsValues(defaultNewsLetters);
toggleRecommendations(true)}})},setUpMainNewsletter=function(newsletter){window.Newsletter=newsletter;setNewsLetterValue(newsletter);showNewsletter();if(getUserId()!=="")showSignUpButton();else showSignUpForm()},applyRrNewsletters=function(variant,version){var mainNewsletter=getMainNewsletter();mainNewsletter.done(function(data){if(!$.isEmptyObject(data.newsletter)){setUpMainNewsletter(data.newsletter);sendCustomTrackProps("event59",trackProps(data.newsletter.name,1,"simple"),"Newsletter Right Rail successfull API Call")}else hideNewsletter()});
mainNewsletter.fail(function(){setUpMainNewsletter(defaultNewsLetter);sendCustomTrackProps("event50",trackProps(defaultNewsLetter.name,1),"Newsletter Right Rail API failure case")});$(".subscribe-newsLetter").click(function(){var re=/[A-Z0-9._%+-]+@[A-Z0-9.-]+.[A-Z]{2,4}/igm;subscribeEmail=$("#newsLetter-input").val();if(this.id!=="newsletter-signUp-button"&&(subscribeEmail==""||!re.test(subscribeEmail)))showErrorMessage("Please enter a valid email address");else{hideErrorMessage();subscribe(subscribeEmail)}return false});
$("#subscribe-bundle").click(function(){subscribeBundle()});$("#cancel-bundle").click(function(){sendCustomTrackProps("event58",trackProps(),"No Thanks, Newsletter Right Rail Sign-up Bundle");toggleRecommendations(false)})};$(window.document).on("abtest-ready",function(e,ABT){if(window.wp_content_type=="front")applyRrNewsletters();else if(window.wp_content_type=="blog"||window.wp_content_type=="article"){var testArticle=ABT.get("newsletters-articleUnits");if(!testArticle.is("banner")&&!testArticle.is("bottom"))applyRrNewsletters(testArticle)}else applyRrNewsletters()});
function trackProps(newsletterName,index,enhancedKey){var subsection=window.wp_subsection||"";var contentType=window.wp_content_type||"";var props={"eVar2":subsection,"prop2":subsection,"prop3":contentType,"eVar17":contentType};if(newsletterName&&index)props.eVar26="nl_rightrail_"+enhancedKey+"_"+newsletterName.toLowerCase().split(" ").join("-")+"_"+index;return props}function sendCustomTrackProps(eventKey,props,name){if(!!window.s)window.s.sendDataToOmniture(name||"PB Feature - Page-Newsletter",
eventKey,props,{wait:true})}})(jQuery);
(function($){try{function cleanUp(){$("li","#editors-picks-rr").each(function(i){var $this=$(this);var $headline=$(".headline",$this);var $number=$(".number",$this);var lineHeight=parseInt($headline.css("lineHeight"));if($headline.height()<=2*lineHeight)$headline.css({"padding-top":"7px","padding-bottom":"8px"});else if($headline.height()>3*lineHeight)while($headline.height()>3*lineHeight){$headline.text($headline.text().replace(/\.\.\.$/,""));$headline.text($headline.text().slice(0,-1));$headline.text($headline.text()+
"...")}})}cleanUp()}catch(e){}})(jQuery);
(function($){var yourThree=$(".posttv-your-three-container");var initYourThree=function(yourThreeDom){var $root=$(yourThreeDom),currentIndex=0,previousIndex=0,currentPlayingItem=0,adCounter=0,adPlayed=false,$prevBar=$root.find(".posttv-your-three-control-left"),$nextBar=$root.find(".posttv-your-three-control-right"),$stacks=$root.find(".posttv-your-three-stacks"),uniquePlayerToken=$stacks.attr("data-player-token"),prevBarHoverState=undefined,nextBarHoverState=undefined,isMovingToNextStack=false;var getPlayer=
function(index){index=typeof index==="undefined"?currentIndex:index;return $root.find("#posttv-your-three-stack-"+index).find(".posttv-your-three-stack-video")};var getImageOverlay=function(index){index=typeof index==="undefined"?currentIndex:index;return $root.find("#posttv-your-three-stack-"+index).find(".posttv-your-three-full-image-overlay")};var goToStack=function(movePlayer){var centerAlignmentPercent=8.5;$prevBar.css("width","10%");$nextBar.css("width","10%");if(currentIndex==0){centerAlignmentPercent=
0;$nextBar.css("width","18%")}else if(currentIndex==stacks-1){$prevBar.css("width","18%");centerAlignmentPercent=17}if(movePlayer){var $currentStack=$("#posttv-your-three-stack-"+currentIndex);$(".posttv-your-three-stack-video",$("#posttv-your-three-stack-"+previousIndex)).prependTo($currentStack);currentPlayingItem=0;selectVideo($("#posttv-your-three-video-"+currentPlayingItem,$currentStack),false,currentIndex);updateText($currentStack,currentPlayingItem)}$stacks.css("margin-left",centerAlignmentPercent+
currentIndex*-83+"%");if(currentIndex===0){prevBarMouseLeave();$prevBar.hide()}else if(currentIndex===stacks-1){nextBarMouseLeave();$nextBar.hide()}else{$prevBar.show();$nextBar.show()}};var selectVideo=function($el,startPlaying,stackNo){if(currentIndex===stackNo){if(adPlayed===true)adCounter=(adCounter+1)%3;else adPlayed=true;wp_pb.report(uniquePlayerToken,"new_video_selected",{image:$el.attr("data-video-image"),uuid:$el.attr("data-video-uuid"),startPlaying:startPlaying,shouldPlayAd:adCounter===
0})}};var nextStack=function(event){isMovingToNextStack=true;if(nextBarHoverState!==undefined)nextBarMouseLeave();if(currentIndex<stacks-1){previousIndex=currentIndex;wp_pb.report(uniquePlayerToken,"stop_video");getImageOverlay().show();getPlayer().hide();currentIndex++;nextBarMouseEnter();goToStack(true)}};var prevStack=function(event){if(prevBarHoverState!==undefined)prevBarMouseLeave();if(currentIndex>0){previousIndex=currentIndex;wp_pb.report(uniquePlayerToken,"stop_video");getImageOverlay().show();
getPlayer().hide();currentIndex--;prevBarMouseEnter();goToStack(true)}};var prevBarMouseEnter=function(){$("#posttv-your-three-stack-"+(currentIndex-1),$stacks).css("opacity","0.2");$prevBar.css("opacity","0.8");prevBarHoverState=currentIndex};var prevBarMouseLeave=function(){if(typeof prevBarHoverState!=="undefined"){$("#posttv-your-three-stack-"+(currentIndex-1),$stacks).css("opacity","1");$prevBar.css("opacity","0");prevBarHoverState=undefined}};var nextBarMouseEnter=function(){$("#posttv-your-three-stack-"+
(currentIndex+1),$stacks).css("opacity","0.2");$nextBar.css("opacity","0.8");nextBarHoverState=currentIndex};var nextBarMouseLeave=function(){if(typeof nextBarHoverState!=="undefined"){$("#posttv-your-three-stack-"+(currentIndex+1),$stacks).css("opacity","1");$nextBar.css("opacity","0");nextBarHoverState=undefined}};var updateText=function($currentStack,current){for(var count=0;count<3;count++)if(count==current){$(".posttv-your-three-stack-headline",$("#posttv-your-three-video-"+count,$currentStack)).css("color",
"#2A2A2A");$(".posttv-your-three-stack-time",$("#posttv-your-three-video-"+count,$currentStack)).css("color","#2A2A2A")}else{$(".posttv-your-three-stack-headline",$("#posttv-your-three-video-"+count,$currentStack)).css("color","#7F7F7F");$(".posttv-your-three-stack-time",$("#posttv-your-three-video-"+count,$currentStack)).css("color","#7F7F7F")}};var initStacks=function(){var initYourThreeStack=function(stackDom,stackIndex){var $stack=$(stackDom),stackNo=stackIndex;var playNextVideo=function(){if(currentIndex===
stackNo&&!isMovingToNextStack){var numberOfVideos=$stack.find(".posttv-your-three-stack-list-entry").length;var endOfPlaylist=(currentPlayingItem+1)/numberOfVideos==1;currentPlayingItem=(currentPlayingItem+1)%numberOfVideos;updateText($stack,currentPlayingItem);if(endOfPlaylist)nextStack();else selectVideo($("#posttv-your-three-video-"+currentPlayingItem,$stack),!endOfPlaylist,stackNo)}else if(isMovingToNextStack)isMovingToNextStack=false};var newVideoSelected=function(event){var $videoEl=$($(event.target).closest(".posttv-your-three-stack-list-entry"));
var selectedVideoIndex=parseInt($videoEl.attr("id").split("posttv-your-three-video-")[1]);if(currentPlayingItem!=selectedVideoIndex){updateText($stack,selectedVideoIndex);currentPlayingItem=selectedVideoIndex;getImageOverlay().hide();getPlayer().show();selectVideo($videoEl,true,stackNo)}};getImageOverlay(stackNo).click(function(){adPlayed=true;wp_pb.report(uniquePlayerToken,"play_video");getImageOverlay().hide();getPlayer().show()});$(".posttv-your-three-stack-headline",$stack).click(newVideoSelected);
$(".posttv-your-three-stack-time",$stack).click(newVideoSelected);updateText($stack,0);$(function(){wp_pb.register(uniquePlayerToken,"video_completed",playNextVideo,this)})};var yourThreeStacks=$root.find(".posttv-your-three-stack",".posttv-your-three-stacks");for(var i=0;i<yourThreeStacks.length;i++)initYourThreeStack(yourThreeStacks[i],i);goToStack(false)};var init=function(){$prevBar.click(prevStack);$prevBar.hover(prevBarMouseEnter,prevBarMouseLeave);$nextBar.click(nextStack);$nextBar.hover(nextBarMouseEnter,
nextBarMouseLeave);initStacks()};init()};for(var i=0;i<yourThree.length;i++)initYourThree(yourThree[i],i)})(jQuery);
(function($){var $content=$("#next-story-bg");var imageUrl=nextStoryImage();if(imageUrl&&!!$content.size()&&$content.width()>480)$content.css("background-image","url("+imageUrl+")");function nextStoryImage(){return TWP.Features&&TWP.Features.Article&&TWP.Features.Article.NextStory&&TWP.Features.Article.NextStory.tnUrl}})(jQuery);
(function($){})(jQuery);
(function($,window){var scrollPos=$(this).scrollTop(),SUBSCRIPTION_KEY="cancelSubscriptionDate",SIGNED_UP_IN="SIGNED_UP_IN_",bannerType="",section=$("#newsletter-banner-section").text(),shouldShowBanner=false,defaultNewsLetter={frequency:"Daily",headline:"Get the Today's Headlines Newsletter",id:"post_newsletter1",name:"Today's Headlines",tagline:"Free daily updates delivered just for you.",template:"signup-confirm-heads",variable:"vars[intent_heads]"},washPostId,subscribeEmail,getUserId=function(){return document.cookie.match(/wapo_login_id=([^;]+)/)?
RegExp.$1:""},getWapoId=function(){return document.cookie.match(/wapo_secure_login_id=([^;]+)/)?RegExp.$1:""},isSubscriber=function(){var isSubscriber=false;if(document.cookie.match(/rplsb=([^;]+)/))isSubscriber=RegExp.$1==1;return isSubscriber},daysBetween=function(date1,date2){var one_day=1E3*60*60*24,difference_ms;difference_ms=date2.getTime()-date1.getTime();return Math.round(difference_ms/one_day)},toggleBanner=function(banner,show,callBack){if(show){$("#pb-root#pb-root").addClass("subscriptionOverlay-margin");
$(banner).parent().addClass("fixed-overlay-subscription");$(banner).parent().css("display","block")}else $(banner).slideUp("slow",function(){$(banner).parent().css("display","none");$(banner).parent().removeClass("fixed-overlay-subscription");$("#pb-root#pb-root").removeClass("subscriptionOverlay-margin")});if(callBack)callBack()},showBanner=function(){var currentPos=$(this).scrollTop();if(currentPos-20>scrollPos)toggleBanner(".banner",true,function(){if(bannerType=="SignUp")sendCustomTrackProps("event66",
trackProps(window.Newsletter.name,1,"simple"),"Newsletter Banner View");else if(bannerType=="Subscription")sendCustomTrackProps("event43",trackProps(),"Subscription Banner View");$(this).off("scroll.addsubscriptionbanner")});scrollPos=currentPos},isMobile=function(){if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Kindle/i)||
navigator.userAgent.match(/Windows Phone/i))return true;else return false},isSafari=function(){var isSafari=false,userAgent=navigator.userAgent.toLowerCase();$.browser.chrome=/chrome/.test(navigator.userAgent.toLowerCase());if($.browser.safari){userAgent=userAgent.substring(userAgent.indexOf("version/"),userAgent.indexOf("version/")+14);userAgent=userAgent.substring(userAgent.indexOf("/"),userAgent.indexOf("/")+2);userAgent=userAgent.substring(1,2);if(parseInt(userAgent)<=6)isSafari=true}return isSafari};
setNewsLetterBanner=function(data){$("#newsletter-headline-banner").append(data.headline);$("#newsletter-tagline-banner").text(data.tagline)},showConfirmation=function(data){$(".confirmation").show();$("#newsletter-tagline-banner, #signup-form, #signed-up-loggedIn-btn").hide()},getPageData=function(){var section=$("#newsletter-banner-section").text(),subSection=$("#newsletter-banner-subsection").text(),blog=$("#newsletter-banner-blogname").text(),data={};washPostId=getUserId();if(washPostId!=="")data.washPostId=
washPostId;if(blog)data.blog=blog;if(subSection)data.subSection=subSection;if(section)data.section=section;return data},getBannerNewsletter=function(){var data=getPageData();return $.ajax({type:"POST",dataType:"json",contentType:"application/json",url:" https://recommendation-newsletter.wpdigital.net/Newsletter/api/newsletter",data:JSON.stringify(data)})},subscribe=function(email){var data,url;if(washPostId!==""&&washPostId!==undefined){url="https://subscribe.washingtonpost.com/person/newsletter/subscribe";
data={"wapoLoginID":washPostId,"wapoSecureID":getWapoId(),"userAgent":navigator.userAgent,"newsletterName":window.Newsletter.id,"metadata":[{"name":"nl_start_method","value":"S"},{"name":"nl_start_location","value":"AU"}]}}else if(email){url="https://subscribe.washingtonpost.com/person/newsletter/subscribe-email";data={"email":email,"newsletterName":window.Newsletter.id,"metadata":[{"name":"nl_start_method","value":"S"},{"name":"nl_start_location","value":"AU"}]}}$.ajax({type:"POST",dataType:"json",
contentType:"application/json",url:url,data:JSON.stringify(data),success:function(data){if(data.status=="SUCCESS"){sendCustomTrackProps("event42,event91",trackProps(window.Newsletter.name,1,"simple"),"Newsletter Sign-up Banner");window.localStorage.setItem(SIGNED_UP_IN+section.toUpperCase(),true);showConfirmation();setTimeout(function(){toggleBanner(".banner",false)},2E3)}},error:function(request,status,error){console.log(error,"Error while subscribing")}})},applyExperience=function(isShortDuration){if(bannerType==
"SignUp"&&!window.localStorage.getItem(SIGNED_UP_IN+section.toUpperCase())||bannerType=="Subscription"&&!isSubscriber()){if(bannerType=="SignUp"){var mainNewsletter=getBannerNewsletter();mainNewsletter.done(function(data){if(!$.isEmptyObject(data.newsletter)){shouldShowBanner=true;$("#signup-banner").show();$("#subscription-banner").hide();if(getUserId()!==""){$("#signup-form").hide();$("#signed-up-loggedIn-btn").show()}else{$("#signup-form").show();$("#signed-up-loggedIn-btn").hide()}window.Newsletter=
data.newsletter;setNewsLetterBanner(data.newsletter)}});mainNewsletter.fail(function(){window.Newsletter=defaultNewsLetter;setNewsLetterBanner(defaultNewsLetter);sendCustomTrackProps("event50",trackProps(window.Newsletter.name,1,"simple"),"Newsletter Banner API failure Case")})}else if(bannerType=="Subscription"){shouldShowBanner=true;$("#subscription-banner").show();$("#signup-banner").hide()}$(window).on("scroll.addsubscriptionbanner",function(){if(shouldShowBanner){var cancalationDate=window.localStorage.getItem(SUBSCRIPTION_KEY),
daysPassed;if(bannerType=="Subscription"&&(getParameterByName("anchor")==="true"||sessionStorage.getItem("anchorSession"))){showBanner();return}if(cancalationDate){cancalationDate=new Date(cancalationDate);daysPassed=daysBetween(cancalationDate,new Date);if(isShortDuration&&daysPassed>3)showBanner();else if(daysPassed>7)showBanner()}else showBanner()}});$("#subscribe-btn").on("click",function(){sendCustomTrackProps("event45",trackProps(),"Subscription Banner Click");setTimeout(function(){window.location=
$("#subscribe-btn").attr("href")},330);return false});$("#subscription-banner .not-now-btn").on("click",function(event){toggleBanner("#subscription-banner",false,function(){window.localStorage.setItem(SUBSCRIPTION_KEY,new Date);sendCustomTrackProps("event44",trackProps(),"Subscription Banner Close")});return false});$("#signup-banner .not-now-btn").on("click",function(event){toggleBanner("#signup-banner",false,function(){window.localStorage.setItem(SUBSCRIPTION_KEY,new Date);sendCustomTrackProps("event69",
trackProps(),"Newsletter Banner Close")});return false});$("#signup-newsLetter").click(function(){var re=/[A-Z0-9._%+-]+@[A-Z0-9.-]+.[A-Z]{2,4}/igm;subscribeEmail=$("#newsLetter-input-banner").val();if(subscribeEmail==""||!re.test(subscribeEmail))$(".newsLetter-error-msg-banner").show();else{$(".newsLetter-error-msg").hide();subscribe(subscribeEmail)}return false});$("#signed-up-loggedIn-btn").click(function(){subscribe()})}};$(".pb-f-page-subscription").insertBefore("#pb-root");$(window.document).on("abtest-ready",
function(e,ABT){var testDesktop,testMobile;if(isMobile())return;else if(isSafari())return;else if(getParameterByName("anchor")==="true"||sessionStorage.getItem("anchorSession")){bannerType="Subscription";sessionStorage.setItem("anchorSession",true);applyExperience()}else{var test=ABT.get("newsletters-articleUnits");if(test.is("banner")){bannerType="SignUp";applyExperience(true)}}});function getParameterByName(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?\x26]"+
name+"\x3d([^\x26#]*)"),results=regex.exec(location.search);return results===null?"":decodeURIComponent(results[1].replace(/\+/g," "))}function trackProps(newsletterName,index,enhancedKey){var subsection=window.wp_subsection||"";var contentType=window.wp_content_type||"";var props={"eVar2":subsection,"prop2":subsection,"prop3":contentType,"eVar17":contentType};if(newsletterName&&index)props.eVar26="nl_banner_"+enhancedKey+"_"+newsletterName.toLowerCase().split(" ").join("-")+"_"+index;return props}
function sendCustomTrackProps(eventKey,props,name){if(!!window.s)window.s.sendDataToOmniture(name||"PB Feature - Page-Subscription",eventKey,props)}})(jQuery,window);
(function(){function rutabaga(){var version="v1";var $=jQuery;var T=TWP.Perso.Tools;var $body=$("body");var $window=$(window);var $document=$(document);var log=new TWP.Tools.logger("RUTABAGA");log.debug("Initializing");var events={"DARWIN_BEFORE":"DARWIN_BEFORE","DARWIN_INIT":"DARWIN_INIT","DARWIN_READY":"DARWIN_READY","DOM_READY":"DOM_READY","CLICK":"CLICK","ACTIVITY_TICKER":"AT","CLICKS_TICKER":"CT","MOUSE_TICKER":"MT","SCROLL_TICKER":"ST"};var endpoint="https://rutabaga.perso.nile.works/events";
var sendEvent=T.Analytics.sender({url:endpoint,logger:log,maxTime:10});function recordEvent(name,data){data=data||{};data.event=name;data.version=version;sendEvent(data)}T.Analytics.ticker(recordEvent,events,log);$(function(){recordEvent(events.DOM_READY)});$document.on("abtest-before",function(){recordEvent(events.DARWIN_BEFORE)});$document.on("abtest-init",function(){recordEvent(events.DARWIN_INIT)});$document.on("abtest-ready",function(ev,ABT){recordEvent(events.DARWIN_READY)})}})();
(function($,window){var svi="";var sviFull=document.cookie.match(/s_vi=([^;]+)/)?RegExp.$1:"";try{if(sviFull&&sviFull!==""){svi=sviFull.replace(/.*\|/,"").replace(/\[.*/,"").split("-");svi=svi[0]+"-"+svi[1]}}catch(e){svi=""}var ttlForusersegments=1;function getHoursSinceLastTime(lastTime){var datetime=(new Date(lastTime)).getTime();var now=(new Date).getTime();if(isNaN(datetime))return ttlForusersegments+1;if(datetime<now)var milisec_diff=now-datetime;else var milisec_diff=datetime-now;var date_diff=
Math.floor(milisec_diff/1E3/60/60);return date_diff}function isParamValid(variable){return variable!=null&&variable!="null"}function isUserSegmentsInvalidOrStale(){usersegments=localStorage.getItem("usersegments");if(!isParamValid(usersegments))return true;else{var json=JSON.parse(usersegments);var usersegmentsstoragetime=json["updated"];if(getHoursSinceLastTime(usersegmentsstoragetime)>=ttlForusersegments)return true}return false}function saveKeyValue(key,value){if(window.localStorage)localStorage.setItem(key,
value);document.cookie=key+"\x3d"+value+";expires\x3d"+(new Date(Date.now()+365*24*3600*1E3)).toUTCString()+";path\x3d/"}function setCookies(data){if(!data||!data.segmentsFlag)return;for(key in data.segmentsFlag)if(data.segmentsFlag.hasOwnProperty(key))document.cookie="us."+key+"\x3d"+data.segmentsFlag[key]+";expires\x3d"+(new Date(Date.now()+365*24*3600*1E3)).toUTCString()+";path\x3d/"}function setAdopsData(data){if(data&&data["segmentsFlag"]){var value=data["segmentsFlag"]["7978704408"];if(value==
"8936"){saveKeyValue("8936",1);saveKeyValue("9868",0);saveKeyValue("6136",0)}else if(value=="9868"){saveKeyValue("8936",0);saveKeyValue("9868",1);saveKeyValue("6136",0)}else if(value=="6136"){saveKeyValue("8936",0);saveKeyValue("9868",0);saveKeyValue("6136",1)}else{saveKeyValue("8936",0);saveKeyValue("9868",0);saveKeyValue("6136",0)}var value=data["segmentsFlag"]["5497328667"];if(value=="7204"){saveKeyValue("7204",1);saveKeyValue("0862",0);saveKeyValue("2467",0);saveKeyValue("0668",0)}else if(value==
"0862"){saveKeyValue("7204",0);saveKeyValue("0862",1);saveKeyValue("2467",0);saveKeyValue("0668",0)}else if(value=="2467"){saveKeyValue("7204",0);saveKeyValue("0862",0);saveKeyValue("2467",1);saveKeyValue("0668",0)}else{saveKeyValue("7204",0);saveKeyValue("0862",0);saveKeyValue("2467",0);saveKeyValue("0668",1)}}}if(window.localStorage&&window.JSON)if(isUserSegmentsInvalidOrStale())$.ajax("https://usersegment.wpdigital.net/usersegments",{type:"POST",dataType:"json",processData:false,contentType:"application/json",
data:'{"userid": "'+svi+'"}'}).done(function(data){if(isParamValid(data)){setCookies(data);setAdopsData(data);data["updated"]=new Date;localStorage.setItem("usersegments",JSON.stringify(data))}});var hasStorage=function(){var storageTest=new Date;try{localStorage.setItem(storageTest,storageTest);localStorage.removeItem(storageTest);return true}catch(e){return false}}();function removeCookie(name){if(document.cookie)document.cookie=name+"\x3d;expires\x3dThu, 01 Jan 1970 00:00:01 GMT;"}function normalizeURL(url,
params){var str=(url||"").trim();str=str.replace(/^(https?:)?\/\//,"");str=str.replace(/\?.*/,"");if(params)str=str.replace(/\/$/,"");return str}function extractParam(param){var rgx=new RegExp(".*[?\x26]"+param+"\x3d([^\x26]+).*");if(rgx.test(document.location.toString()))return document.location.toString().replace(rgx,"$1");else return""}var clavisAuxiliaries=window.wp_meta_data&&wp_meta_data.clavis&&wp_meta_data.clavis.auxiliaries,canonicalUrl=$('link[rel\x3d"canonical"]').attr("href"),userId=!!document.cookie.match(/s_vi=([^;]+)/)?
RegExp.$1:"unavailable";if(!canonicalUrl)canonicalUrl=[window.location.host,window.location.pathname].join("");var contentType="";try{contentType=TWP.Data.Tracking.props.content_type}catch(e){}var dataPayload={"articleid":normalizeURL(canonicalUrl,true),"referrer":normalizeURL(document.referrer),"contentType":contentType,"tid":extractParam("tid"),"userid":userId,"uuid":!!document.cookie.match(/wapo_login_id=([^;]+)/)?RegExp.$1:"","auxiliaries":!!clavisAuxiliaries?clavisAuxiliaries:[],"wp_meta_data":window.wp_meta_data||
null,"isMobile":window.isMobile&&window.isMobile.any()};var targetingServerUrl=TWP&&TWP.Features&&TWP.Features.Page&&TWP.Features.Page.Targeting&&TWP.Features.Page.Targeting.endpointServer;$.ajax({url:!!targetingServerUrl?targetingServerUrl:"//targeting.wpdigital.net/TargetingWebAPP/targeting",type:"POST",contentType:"application/json",dataType:"JSON",data:JSON.stringify(dataPayload)}).done(function(response){if(!!response){var auxMap=response.aux_map&&response.aux_map.join(",");if(!auxMap)$.ajax({url:"https://recommendation-hybrid.wpdigital.net/hybrid/hybrid-filter/custom",
type:"POST",data:{type:"noaux",error:JSON.stringify(response)}});else if(hasStorage)window.localStorage.setItem("targeting_aux_map",auxMap);else if(!!$&&!!$.cookie)$.cookie("targeting_aux_map",auxMap);else document.cookie="targeting_aux_map\x3d"+auxMap}else hasStorage?localStorage.setItem("targeting_aux_map",""):removeCookie("targeting_aux_map")}).fail(function(errorResponse){$.ajax({url:"https://recommendation-hybrid.wpdigital.net/hybrid/hybrid-filter/custom",type:"POST",data:{type:"fail",error:JSON.stringify(errorResponse)}})})})(jQuery,
window);
(function($){var wp_pb=window.wp_pb||{},env=wp_pb.environment||"production",apiBaseURL=env=="production"?"https://subscribe.washingtonpost.com/drawbridgeservice/queue-drawbridge":"https://subscribe.digitalink.com/drawbridgeservice/queue-drawbridge",washPostId,subscribeEmail,db_cookie_name="drawbridge_o",db_cookie_expiration=42,db_cookie_domain=env=="production"?".washingtonpost.com":".digitalink.com",showDrawbridgeOverlay=function(elm){},closeDrawbridgeOverlay=function(elm){},showErrorMsgInStream=
function(elm,message){if(message)elm.text(message).show()},hideErrorMsgInStream=function(elm){elm.hide()},getUserId=function(){return document.cookie.match(/wapo_login_id=([^;]+)/)?RegExp.$1:""},getWapoId=function(){return document.cookie.match(/wapo_secure_login_id=([^;]+)/)?RegExp.$1:""},resetFixed=function(data){if(data=="opened"&&$(".bar-hidden").length==0){$(".jqmOverlay, #drawbridge-signup-overlay").addClass("nav-open").removeClass("nav-closed");var headerHeight=$("#nav-bar").height();$(".jqmOverlay, #drawbridge-signup-overlay").css("margin-top",
headerHeight)}else{$(".jqmOverlay, #drawbridge-signup-overlay").removeClass("nav-open").addClass("nav-closed");$(".jqmOverlay, #drawbridge-signup-overlay").css("margin-top","")}},subscribeInStream=function(email,testName,variantName,successCookieValue){var data={};data.email=email;data.testName=testName;data.variantName=variantName;$.ajax({type:"POST",dataType:"json",contentType:"application/json",url:apiBaseURL,data:JSON.stringify(data),success:function(data){if(data.status=="SUCCESS"){sendCustomTrackProps("event87",
trackProps(),"Drawbridge Signup email sent");document.cookie="drawbridge_o\x3d"+successCookieValue+";expires\x3d"+(new Date(Date.now()+60*60*24*db_cookie_expiration*1E3)).toUTCString()+";path\x3d/"+";domain\x3d"+db_cookie_domain;$("#db-signup-email").hide();$("#subscribe-group").removeClass("processing");$("#db-signup-thanks").show()}else if(data.status=="FAILURE"&&data.messages.indexOf("Invalid Email")>-1){$("#subscribe-group").removeClass("processing");showErrorMsgInStream($(".error-msg-email"),
"Please enter a valid email address")}else{$("#subscribe-group").removeClass("processing");showErrorMsgInStream($(".error-msg-email"),"Error while subscribing, please try later")}},error:function(request,status,error){$("#subscribe-group").removeClass("processing");showErrorMsgInStream($(".error-msg-email"),"Error while subscribing, please try later")}}).fail(function(){$("#subscribe-group").removeClass("processing");showErrorMsgInStream($(".error-msg-email"),"Error while subscribing, please try later")})},
applyTest=function(testName,variantName,openCookieValue,successCookieValue,includeClose,includeEmail){if($("#drawbridge-signup-overlay").length===0)return true;openCookieValue=typeof openCookieValue=="undefined"?"":openCookieValue;successCookieValue=typeof successCookieValue=="undefined"?"":successCookieValue;includeClose=typeof includeClose=="undefined"?false:includeClose;includeEmail=typeof includeEmail=="undefined"?true:includeEmail;setTimeout(function(){sendCustomTrackProps("event86",trackProps(),
"Drawbridge Overlay Opened")},5E3);typeof wp_pb.register=="function"&&wp_pb.register("nav","finish_open",function(){resetFixed("opened")});typeof wp_pb.register=="function"&&wp_pb.register("nav","finish_close",function(){resetFixed("closed")});if(/wapo_secure_login_id/.test(document.cookie))$("#subscribe-link").hide();$("#db-signup-email .subscribe-btn").click(function(){hideErrorMsgInStream($(".error-msg-email"));hideErrorMsgInStream($(".error-msg-checkbox"));subscribeEmail=$("#email-field").val(),
re=/[A-Z0-9._%+-]+@[A-Z0-9.-]+.[A-Z]{2,4}/im;if(subscribeEmail==""||!re.test(subscribeEmail)){showErrorMsgInStream($(".error-msg-email"),"Please enter a valid email address");return false}if($("#agree-checkbox input.checkbox").attr("checked")!="checked"){showErrorMsgInStream($(".error-msg-checkbox"),"Please read and accept terms");return false}$("#subscribe-group").addClass("processing");subscribeInStream(subscribeEmail,testName,variantName,successCookieValue)});$modal=$("#drawbridge-signup-overlay");
if(wp_pb.DrawbridgeTest&&wp_pb.DrawbridgeTest[variantName]){$(".titleMessage",$modal).html(wp_pb.DrawbridgeTest[variantName]["titleMessage"]);$(".placeholderImage",$modal).html(wp_pb.DrawbridgeTest[variantName]["placeholderImage"]);$(".subscriptionMessage",$modal).html(wp_pb.DrawbridgeTest[variantName]["subscriptionMessage"]);$(".thankyouMessage",$modal).html(wp_pb.DrawbridgeTest[variantName]["thankyouMessage"])}$modal.jqm({overlay:85,modal:true,toTop:true,trigger:false,closeClass:"overlay-closer",
onShow:function(h){var marginl=$(window).width()>768?($(window).width()-768)/2:0;h.o.prependTo("body");h.w.css("margin-left",marginl).show();if(!/drawbridge_o/.test(document.cookie))document.cookie=db_cookie_name+"\x3d"+openCookieValue+";expires\x3d"+(new Date(Date.now()+60*60*24*db_cookie_expiration*1E3)).toUTCString()+";path\x3d/"+";domain\x3d"+db_cookie_domain;resetFixed("opened");if(includeClose)$(".btn-close").show();if(!includeEmail)$("#subscribe-group, #agree-checkbox, #subscribe-link").hide();
setTimeout(function(){if(!elementIsVisible($(".jqmOverlay"))||!elementIsVisible($("#drawbridge-signup-overlay")))sendCustomTrackProps("event84",{eVar26:"drawbridge-element-blocked"},"drawbridge-element-blocked")},2E3)},onHide:function(h){sendCustomTrackProps("event80",{eVar26:"drawbridge_close"},"drawbridge-modal-close");h.w.fadeOut("2000",function(){h.o.remove()})}});$modal.jqmShow()},trackProps=function(newsletterName,index,enhancedKey){var subsection=window.wp_subsection||"";var contentType=window.wp_content_type||
"";var props={"eVar1":wp_page_name,"eVar2":wp_channel,"eVar8":wp_author,"eVar25":wp_blogname};return props},sendCustomTrackProps=function(eventKey,props,name){if(!!window.s)window.s.sendDataToOmniture(name||"Drawbridge Test 1",eventKey,props,{wait:true})};function elementIsVisible(elem){elem=elem instanceof jQuery?elem:$(elem);return elem.is(":visible")}db_cookie_name_ab_test="drawbridge_test";if(!/rplsb=1/.test(document.cookie))$(window.document).on("abtest-ready",function(e,ABT){var test=ABT.get("subscription-modal");
if(test.is("active"))if(!/drawbridge_o/.test(document.cookie)||/drawbridge_o=1/.test(document.cookie))applyTest(test)});if(!/wapo_secure_login_id=/.test(document.cookie))window._moatState&&window._moatState.then(function(){document.cookie=db_cookie_name+"\x3d"+""+";expires\x3d"+";path\x3d/"+";domain\x3d"+db_cookie_domain},function(){if(window.TWP&&TWP.ABTest&&TWP.ABTest.state()==="initialized")drawbridgeABTHandler(null,TWP.ABTest);else $(window.document).on("abtest-ready",drawbridgeABTHandler);function drawbridgeABTHandler(e,
ABT){var test=ABT.get("drawbridge-adb",true);document.cookie=db_cookie_name_ab_test+"\x3d"+"drawbridge-adb"+"|"+test.name+";expires\x3d"+(new Date(Date.now()+60*60*24*db_cookie_expiration*1E3)).toUTCString()+";path\x3d/"+";domain\x3d"+db_cookie_domain;if(!/drawbridge_o/.test(document.cookie)||!/drawbridge_o=2/.test(document.cookie)){if(test.is("subscription"))applyTest("drawbridge-adb","subscription","3","2");else if(test.is("nosubscription"))applyTest("drawbridge-adb","nosubscription","4","2");else if(test.is("paywall")){document.cookie=
db_cookie_name+"\x3d"+"5"+";expires\x3d"+(new Date(Date.now()+10*1E3)).toUTCString()+";path\x3d/"+";domain\x3d"+db_cookie_domain;TWP.Identity.auth()}else if(test.is("overlay"))applyTest("drawbridge-adb","overlay","6","2",includeClose=true,includeEmail=false);test.sendTrackVars(false,"event100",{wait:true})}}})})(jQuery);
(function(wp_get_import,VisitorSegment){if(!VisitorSegment)wp_get_import().done(function(wp_import){init()});else init();function init(){var TWP=window.TWP||{};TWP.ABTestUser=TWP.ABTestUser||{};(function ABTestAnonymous($,TWP,wp_import,VisitorSegment,undefined){var OPT_OUT_KEY="ABT__OO";var IGNORE_BL_KEY="ABT__ib";var LOCAL_TRUE="yes";var LOCAL_FALSE="no";var featureData={};var bucketData={};var disabled;var ignoreBlacklist;var state="uninitialized";var $d=$(window.document);var ABT={init:function(data){disabled=
!data;$d.trigger("abtest-before",[ABT]);ABT.applyData(data);if(state!="initialized")$d.trigger("abtest-ready",[ABT]);state="initialized";$d.trigger("abtest-init",[ABT])},state:function(){return state},trackBefore:function(eventHandler){bindTop($d,ABT.trackPageviewEventBefore(),eventHandler)},trackAfter:function(eventHandler){bindTop($d,ABT.trackPageviewEventAfter(),eventHandler)},trackValueDelimeter:function(){return TWP.ABTestUser.trackValueDelimeter},trackPageviewEventBefore:function(){return TWP.ABTestUser.trackPageviewEventBefore},
trackPageviewEventAfter:function(){return TWP.ABTestUser.trackPageviewEventAfter},trackSendHandler:function(){var method=str2obj(TWP.ABTestUser.trackSendHandler);return"function"==typeof method?method:function(){}},trackSetHandler:function(){var method=str2obj(TWP.ABTestUser.trackSetHandler);return"function"==typeof method?method:function(){}},trackUnsetHandler:function(){var method=str2obj(TWP.ABTestUser.trackUnsetHandler);return"function"==typeof method?method:function(){}},applyData:function(dataValue){var data;
if(!disabled&&detectLocalStorage()&&!optOut()){data={features:[]};ignoreBlacklist=getLocalItem(IGNORE_BL_KEY);$.each(dataValue||[],function(index,bucket){if("boolean"==typeof bucket.disabled&&!bucket.disabled)$.merge(data.features,bucket.features)});ABT.bucket(data)}},bucket:function(data){bucketData=data;var features;if(!data.disabled){features=data.features||[];$.each(features,function(index,feature){setFeature(feature)})}},ignoreBlacklist:function(value){if(!value){ignoreBlacklist=undefined;removeLocalItem(IGNORE_BL_KEY)}else{ignoreBlacklist=
LOCAL_TRUE;setLocalItem(IGNORE_BL_KEY,LOCAL_TRUE)}},optOut:function(){setLocalItem(OPT_OUT_KEY,LOCAL_TRUE);$d.trigger("abtest-optout",[ABT])},get:function(name,skipTrack){var feature=!disabled&&featureData[name]||{};var variation=feature.variation||new Variation(feature);if(!skipTrack&&feature.variation&&!variation._trackset){variation._trackset=true;ABT.trackBefore(function(){variation.setTrackVars()});ABT.trackAfter(function(){variation.unsetTrackVars()})}return variation},clear:function(){$.each(bucketData.features,
function(i,f){unregisterVariation(f.name)})},forceTest:function(featureName,variantName){var key=makeKeyNames(featureName);setLocalItem(key.name,variantName);setLocalItem(key.visit,LOCAL_TRUE);setLocalItem(key.computed,LOCAL_TRUE);setLocalItem(key.force,LOCAL_TRUE)}};ABT.$handlers={applyClass:function(isVariant,feature,variant){this.removeClass("abt-not-loaded").addClass("abt-"+feature+"-"+variant+"-"+isVariant)}};$.fn.extend({biAbtest:function(handlerName,name,cb){var config=getConfig(name);var ftr=
ABT.get(config.feature);var is=ftr.is(config.variant);function getConfig(name){var n=name.split(".");return{feature:n[0],variant:n[1]}}if(!config.feature||!config.variant)return;return this.each(function(){var $el=$(this);ABT.$handlers[handlerName].call($el,is,config.feature,config.variant);if(cb)cb.call($el,is,config.feature,config.variant)})}});TWP.ABTest=ABT;if(!!VisitorSegment)ABT.init(TWP.ABTestBucket);else if(!!wp_import&&!VisitorSegment)wp_import(["VisitorSegment"],function(vs){VisitorSegment=
vs;ABT.init(TWP.ABTestBucket)});else initError("failed during dependency acquisition");function initError(msg){$d.trigger("abtest-fail",[["init",msg].join(": ")])}function Feature(data){var name=data.name||"";var key=makeKeyNames(name);var increment=data.increment||0;var variations=data.variations||[];var blacklist=data.blacklist&&data.blacklist.referrers||[];var included=true;var blacklisted=getLocalItem(key.blacklisted)==LOCAL_TRUE;var bopt;if(!blacklisted&&!getLocalItem(key.blacklisted)){bopt=
{domains:blacklist,segment:{}};var segmentName;for(segmentName in data.segment)bopt.segment[segmentName]=!!data.segment[segmentName];included=!notInSegment(bopt.segment);blacklisted=isBlacklisted(bopt.domains)||!included;setLocalItem(key.blacklisted,blacklisted?LOCAL_TRUE:LOCAL_FALSE)}var enabled=!!variations.length;var variation=variations.length&&new Variation(registerVariation(name,variations,blacklisted,increment));if(enabled&&data.active&&!variation.nocollect){this.name=name;this.variation=variation}var defaultTrack=
enabled&&data.active?data.defaultTrack:[];if(blacklisted)$.merge(defaultTrack,data.blacklist&&data.blacklist.track||[]);if(defaultTrack.length&&variation.nocollect)this.variation=new Variation({variation:{track:!included?[]:defaultTrack}});if(!enabled||!variation)unregisterVariation(name)}function Variation(objValue){var obj=objValue||{};this.nocollect=!obj.collect;var data=obj.variation||{};this.name=data.name||"";this.trackvars=data.track||[];this.customOptions=data.customOptions||{};var _self=
this;this.is=function(name){return name?name===_self.name:false};this.getTrackVar=function(name,prepend,delimiterValue){var result=[];$.each(_self.trackvars,function(index,trackvar){if(makeTrackvarName(name)===makeTrackvarName(trackvar.name))result.push(trackvar.value)});var delimiter=delimiterValue||ABT.trackValueDelimeter();result=result.join(delimiter);return result&&(prepend?prepend+delimiter:"")+result};this.sendTrackVars=function(setOp,eventKey,extraOptions){var payload=trackingPayload();var trackargs=
["Darwin - TrackVar",eventKey||"",payload,extraOptions];if(setOp)ABT.trackSetHandler().apply(ABT,[payload]);else ABT.trackSendHandler().apply(ABT,trackargs);$d.trigger("abtest-tracksend",trackargs)};this.unsetTrackVars=function(){var payload=trackingPayload();ABT.trackUnsetHandler().apply(ABT,[payload])};this.setTrackVars=function(){var payload=trackingPayload();ABT.trackSetHandler().apply(ABT,[payload])};this.sendCustomTrackVar=function(){return undefined};this.unsetCustomTrackVar=function(){return undefined};
this.setCustomTrackVar=function(){return undefined};function trackingPayload(){var payload={};$.each(_self.trackvars,function(index,trackvar){var svar;if(!trackvar.dynamic){svar=makeTrackvarName(trackvar.name);payload[svar]=payload[svar]||[];payload[svar].push(trackvar.value)}});return payload}}function registerVariation(name,variations,blacklisted,increment){var key=makeKeyNames(name);var his={cur:testHash(name,variations,blacklisted,increment),old:getLocalItem(key.hash)};var i=getLocalItem(key.name);
var r=LOCAL_TRUE==getLocalItem(key.visit);var t=LOCAL_TRUE==getLocalItem(key.computed);var f=LOCAL_TRUE==getLocalItem(key.force);var compare=function(a,b){var a=parseFloat(a.customOptions.target);var b=parseFloat(b.customOptions.target);if(a<b)return-1;if(a>b)return 1;return 0};var v=findByProp(variations,"name",i);if(!t&&!blacklisted&&("string"!==typeof i&&!v)||!f&&!!t&&his.cur!=his.old){variations.sort(compare);var ranges=[];var g=0;var h=0;$.each(variations,function(index,variant){var v=variant.customOptions&&
variant.customOptions.target;if(v){v=parseFloat(v)/100;g+=v;var result={value:[h,g]};h+=v;ranges.push(result)}});var rc=randChance();$.each(ranges,function(index,range){if(between(rc,range.value[0],range.value[1]))i=index});v=variations[i];if(v)setLocalItem(key.name,v.name);else setLocalItem(key.name,"_default")}setLocalItem(key.visit,LOCAL_TRUE);setLocalItem(key.computed,LOCAL_TRUE);setLocalItem(key.hash,his.cur);var result=v&&(!blacklisted||r)&&{variation:v,collect:true};return result}function testHash(name,
variations,blacklisted,increment){var vnames=[];$.each(variations,function(index,variation){var o=variation.customOptions;var ostr="";if(o)for(n in o)if(o.hasOwnProperty(n))ostr+=[n,o[n]].join("\x3d");vnames.push(variation.name+ostr)});var result=[name,vnames.sort().join(""),!!blacklisted,increment].join("");return result}function unregisterVariation(name){var key=makeKeyNames(name);removeLocalItem(key.name);removeLocalItem(key.visit);removeLocalItem(key.blacklisted);removeLocalItem(key.computed);
removeLocalItem(key.hash);removeLocalItem(key.force)}function findByProp(arr,prop,value){var result;$.each(arr,function(i,item){if(item[prop]==value){result=item;return false}});return result}function makeTrackvarName(value){if(!value)throw new Error("trackvar: invalid name");return value.toLowerCase()}function makeKeyNames(name){return{name:"ABT__"+name,visit:"ABT__"+name+"__visit",blacklisted:"ABT__"+name+"__blstd",computed:"ABT__"+name+"__cmpted",hash:"ABT__"+name+"__hash",force:"ABT__"+name+"__force"}}
function randChance(){return Math.random(0,1)}function between(x,min,max){return x>=min&&x<=max}function getFeature(name){return featureData[name]}function setFeature(data){if(!data.name)throw new Error("Feature: missing name");var feature=new Feature(data);if(!$.isEmptyObject(feature))featureData[data.name]=feature}function isBlacklisted(domainsValue){var domains=domainsValue||[];function regescape(str){return str.replace(/\./g,"\\.").replace(/\-/g,"\\-")}function check(domain){var reg=new RegExp("^(http://)?(www\\.)?"+
regescape(domain),"gi");return!domain&&!document.referrer||(domain&&document.referrer.match(reg)||[]).length>0}var result;if(!ignoreBlacklist)$.each(domains,function(index,domain){result=check(domain);return!result});return result}function notInSegment(segmentValue){var segment=segmentValue||{};var result;var count=0;var segmentName;for(segmentName in segment)if(segment.hasOwnProperty(segmentName)){result=result||(!!segment[segmentName]?!!VisitorSegment(segmentName):false);if(!!segment[segmentName])count++}return 0!==
count?!result:1==Object.keys(segment).length?!VisitorSegment(segment[0]):false}function detectLocalStorage(){var str="_a-b-test";try{setLocalItem(str,str);removeLocalItem(str);return true}catch(e){return false}}function getLocalItem(name){return localStorage.getItem(name)}function setLocalItem(name,value){if(getLocalItem(name))removeLocalItem(name);localStorage.setItem(name,value)}function removeLocalItem(name){localStorage.removeItem(name)}function optOut(){return getLocalItem(OPT_OUT_KEY)===LOCAL_TRUE}
function str2obj(handlerStr){var parts;var method=window;try{parts=handlerStr.split(".");$.each(parts,function(i,obj){method=method[obj]})}catch(e){}return method}function bindTop($ctx,name,fn){if(!name)return;$ctx.on(name,fn);$ctx.each(function(){var handlers=$._data($ctx[0],"events")[name.split(".")[0]];var handler=handlers.pop();handlers.splice(0,0,handler)})}})(jQuery,TWP,window.wp_import,window.VisitorSegment)}})(wp_get_import);
(function magnetAnonymous(window,$,wp_pb,undefined){var SCROLL_INTERVAL=200;var DEFAULT_DEBOUNCE=100;var UP_OFFSET=-175;var DOWN_OFFSET=0;var WINDOW_TOP_OFFSET=0;var SCREEN_BOTTOM_OFFSET=600;logMagnetTag();$(function(){var $w=$(window);var $d=$(document);var $r=$("html");var $h=$(".pb-f-page-header-v2");var $instance=$(".pb-f-page-magnet");$instance.each(function(){var $el=$(this);$el.insertAfter($h);init($el)});function init($container){var $modulearea=$container.find(".pb-module-area");var $isMobile=
$("html").hasClass("mobile");if($isMobile)makeTitle().insertBefore(".pb-f-page-magnet").addClass("mb-title");else{makeTitle().insertAfter(".pb-magnet-controls").addClass("desk-title");$(".desk-title").addClass("showInlineBlock")}var $ctrl={};$ctrl.$container=$container.find(".pb-magnet-controls");$ctrl.$mvleft=$ctrl.$container.find(".pb-magnet-mvleft");$ctrl.$mvright=$ctrl.$container.find(".pb-magnet-mvright");$container.data("magnetControl",$ctrl);var $title=$modulearea.find(".pb-magnet-title");
applyTitleCase($title.find(".pb-magnet-h2.magnet-title-case"));$modulearea.find('[data-pb-magnet-first\x3d"true"]').insertAfter($title);var $items=$container.find(".pb-magnet-item");var $imgs=$items.find(".pb-magnet-article-image");if($items.length==0)return;var tagname=$modulearea.data("tag");var omniParams=params($modulearea.data("omni"));tagLinks(omniParams);attachNavEvents();$modulearea.css("display","");function attachNavEvents(){applyLazyload();var edown="mousedown.magnet";if(!touchDevice()){containerScroll(function(){applyNavVisibility()});
$ctrl.$mvleft.off(edown).on(edown,function(){var value=Math.max(0,$container.scrollLeft()-computeWidth());moveScroll(value)});$ctrl.$mvright.off(edown).on(edown,function(){var value=$container.scrollLeft()+computeWidth();moveScroll(value)});registerOnce("nav","start_open",debounce(function(){down()},DEFAULT_DEBOUNCE,true))}else windowTop(function(){if(WINDOW_TOP_OFFSET>=$w.scrollTop())down()});registerOnce("nav","start_close",debounce(function(){up()},DEFAULT_DEBOUNCE,true));registerOnce("magnet",
"start_open",debounce(function(){if(tagname&&!!window.s)s.sendDataToOmniture("magnet_open","",{prop72:tagname})},DEFAULT_DEBOUNCE,true));function computeWidth(){var winwidth=$w.width();var itemwidth=$items.first().width();return Math.floor(winwidth/itemwidth)*itemwidth}}function params(value){var params=value?value.split("\x26"):[value];var result=[];if(params.length>0)$.each(params,function(index,value){var param=value.split("\x3d");result.push(param)});return result}function tagLinks(params){$modulearea.find("a").each(function(){var $a=
$(this);var url=$a.attr("href");$.each(params,function(index,param){url=updateUrlParam(url,param[0],param[1])});$a.attr("href",url)})}function registerOnce(arg1,arg2,fn){var regdata=[arg1,arg2];var regname=regdata.join(":");if(!$container.data(regname))wp_pb.register(regdata[0],regdata[1],fn);$container.data(regname,true)}function applyNavVisibility(){$ctrl.scrollleft=$container.scrollLeft();$ctrl.leftoffset=$container.scrollLeft()+$container.width();var rightbound=$modulearea[0].offsetWidth-$ctrl.leftoffset<=
0;$ctrl.$mvleft.toggle(!!$ctrl.scrollleft);$ctrl.$mvright.toggle(!rightbound)}function applyLazyload(){var sename="scroll.magnet-lazy";var reveal=0;$container.off(sename).on(sename,debounce(function(){lazy()},1,true));lazy();function lazy(){var count=Math.max(reveal,computeNumberOfImages());if(!!count&&"NaN"!==count.toString()&&reveal!==count){reveal=count;$imgs.filter(":lt("+reveal+")").each(function(){var $el=$(this);$el.attr("src",$el.data("original"))})}}function computeNumberOfImages(){return Math.ceil(($container.scrollLeft()+
$container.width())/$items.first().width())}}function nearBottom(){return $w.scrollTop()>=$d.height()-$w.height()-SCREEN_BOTTOM_OFFSET}function down(){$r.addClass("magnet");$(".mb-title").addClass("showBlock");if(!nearBottom())$r.addClass("magnet-nudge");if(touchDevice())$container.add(".mb-title").addClass("magnet-open");else $container.addClass("magnet-open").css({top:DOWN_OFFSET});wp_pb.report("magnet","start_open")}function up(){$r.removeClass("magnet magnet-nudge");$(".mb-title").removeClass("showBlock");
if(touchDevice())$container.add(".mb-title").removeClass("magnet-open");else $container.removeClass("magnet-open").css({top:UP_OFFSET});wp_pb.report("magnet","start_close")}function containerScroll(fn){var scroll;var rename="resize.magnet";$w.off(rename).on(rename,function(){scroll=true});var sename="scroll.magnet";$container.off(sename).on(sename,function(){scroll=true});var tid;setInterval(function(){if(scroll){if(tid)clearTimeout(tid);tid=setTimeout(function(){fn()},SCROLL_INTERVAL)}scroll=false},
SCROLL_INTERVAL)}function getTitleHtml(){return $("#PageMagnetTitle").html()}function makeTitle(){return $(getTitleHtml())}function windowTop(fn){var atop=false;var tid;var sename="scroll.magnet";$w.off(sename).on(sename,function(){var top=$(window).scrollTop();if(!atop&&top==0){atop=true;if(tid)clearTimeout(tid);tid=setTimeout(function(){fn()},SCROLL_INTERVAL)}else if(top>=0)atop=false})}function moveScroll(value){$container.stop().animate({scrollLeft:value},"slow")}}function touchDevice(){return $r.hasClass("touch")}
});function titleCase(strValue){var str=strValue.replace(/([^\W_]+[^\s-]*) */g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()});var lowers=["A","An","The","And","But","Or","For","Nor","As","At","By","For","From","In","Into","Near","Of","On","Onto","To","With"];var i,j;for(i=0,j=lowers.length;i<j;i++)str=str.replace(new RegExp("\\s"+lowers[i]+"\\s","g"),function(txt){return txt.toLowerCase()});var uppers=["Id","Tv"];for(i=0,j=uppers.length;i<j;i++)str=str.replace(new RegExp("\\b"+
uppers[i]+"\\b","g"),uppers[i].toUpperCase());return str}function applyTitleCase($el){var title=titleCase(($el.text()||"").replace(/_/gi," "));$el.text(title)}function updateUrlParam(url,key,value){var n=new RegExp("([?\x26])"+key+"\x3d.*?(\x26|$)","i");var i=-1!==url.indexOf("?")?"\x26":"?";return url.match(n)?url.replace(n,"$1"+key+"\x3d"+value+"$2"):url+i+key+"\x3d"+value}function logMagnetTag(){var tagname;$(document).on("onTwpMeterComplete.omniture",function(){var modulearea=document.getElementsByClassName("pb-f-page-magnet")[0].getElementsByClassName("pb-module-area")[0];
tagname=modulearea&&modulearea.getAttribute("data-tag");if(tagname&&!!window.s)s.prop55=tagname})}function debounce(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args)}}})(window,jQuery,wp_pb);
(function($){var TWP=window.TWP||{};TWP.JWConfig={};TWP.videoDataId="video-data-id";TWP.youtube=TWP.youtube||{};TWP.youtube.youtubeVideos=TWP.youtube.youtubeVideos||{};TWP.PostTV=TWP.PostTV||{};var players=$(".posttv-player-container");var initPlayer=function(playerDom,i){var isYoutube=false,youtubeReadyFlag=false,jwReadyFlag=false;var $root=$(playerDom);var localPlayerId=$root.attr("data-moduleId");var shareUrl=$root.attr("data-shareUrl");var finalShareTitle=$root.attr("data-share-headline");var uniquePlayerToken=
$root.attr("data-uniqueToken");var allowShare=$root.attr("data-allowShare")==="true";var autoPlay=$root.attr("data-autoPlay")==="true";var showVideoText=$root.attr("data-showVideoText");var isMuted=$root.attr("data-startMuted")==="true";var youtubePlayerObj,ytExpectedState=false;var youtubeWrapper=$root.find(".posttv-player-youtube-wrapper");if(youtubeWrapper.length>0){isYoutube=true;var trackingData={section:youtubeWrapper.attr("data-section")||"",subsection:youtubeWrapper.attr("data-subsection")||
"",videoUuid:youtubeWrapper.attr("data-video-uuid")||"",displayDate:Number(youtubeWrapper.attr("data-display-date")),videoTitle:youtubeWrapper.attr("data-video-title")||""};var omnitureCall=function(trackingData,events,additionalTrackingVars){var getSectionAsPrefix=function(){var sectionAsPrefix=trackingData.section.toLowerCase();if(/^\/([^\/]+)/.test(sectionAsPrefix))sectionAsPrefix=RegExp.$1.toLowerCase();sectionAsPrefix+=!!sectionAsPrefix?":":"";return sectionAsPrefix},getEstDateString=function(epoch){var localDate=
new Date(epoch),estDate=new Date(epoch+localDate.getTimezoneOffset()*6E4-300*6E4),month=estDate.getMonth()+1;return month+"/"+estDate.getDate()+"/"+estDate.getFullYear()};var getTrackingData=function(){var sectionAsPrefix=getSectionAsPrefix(),uuidToken=trackingData.videoUuid.split("-")[trackingData.videoUuid.split("-").length-1],dateString=getEstDateString(trackingData.displayDate);if(typeof params=="undefined")params={};var currentVideoTitle=sectionAsPrefix+"video - "+uuidToken+" - "+dateString+
" - "+trackingData.videoTitle.toLowerCase();return{"page":currentVideoTitle,"channel":"wp - posttv","video":currentVideoTitle,"title":currentVideoTitle,"type":"video","section":!!trackingData.section?trackingData.section.toLowerCase():"","subsection":!!trackingData.subsection?trackingData.subsection.toLowerCase():"","source":"","videoName":"","adsDuration":"","playerType":"live-player-methode-module","videoType":"LiveStream"}};var sendTrackingData=function(events,videoData){var data=$.extend({"eVar1":window.s.eVar1||
videoData.page,"eVar2":videoData.channel,"eVar13":videoData.title,"eVar41":videoData.section,"eVar42":videoData.source,"eVar43":videoData.video,"eVar44":videoData.serInfo,"eVar45":s._referrer,"eVar46":"","eVar49":"hp-live-module"},additionalTrackingVars);events=events||[];s.sendDataToOmniture("interaction",events,data)};var sendDataToNielsen=function(videoData){var sectionAsPrefix=getSectionAsPrefix();var currentVideoTitle=!!videoData.title?sectionAsPrefix+videoData.title.toLowerCase():"";var currentVideoCategory=
"";var paramCi="ci\x3dus-904793";var paramC6="\x26c6\x3dvc,b01";var paramCc="\x26cc\x3d1";var paramRnd="\x26rnd\x3d"+Math.ceil(Math.random()*1E9);var paramTl="\x26tl\x3ddav0-"+encodeURIComponent(currentVideoTitle);var paramCg="\x26cg\x3d"+encodeURIComponent(currentVideoCategory);var url="//secure-us.imrworldwide.com/cgi-bin/m?"+paramCi+paramC6+paramCc+paramRnd+paramTl+paramCg;self.imageForNielsenBeacon="";self.imageForNielsenBeacon=new Image;self.imageForNielsenBeacon.src=url};if(window.s&&typeof s.sendDataToOmniture==
"function"){sendTrackingData(events,getTrackingData());if(events.indexOf("event75")!=-1)sendDataToNielsen(trackingData)}};var doTrackingCall=function(events,additionalTrackingData){omnitureCall(trackingData,events,additionalTrackingData)};var loadYoutubePlayer=function(args){if(!!window.YT){TWP.youtube.youtubeVideos[args.vidID]=new YT.Player(args.containerID,{playerVars:{autohide:1,autoplay:0,controls:1,fs:1,html5:1,iv_load_policy:3,modestbranding:1,rel:0,showinfo:0,wmode:"transparent"},height:"100%",
width:"100%",videoId:args.vidID,events:{"onReady":function(event){youtubeReadyFlag=true;doTrackingCall("event30");if(mobile_browser===1)isMuted=false;if((jwToPlay||autoPlay)&&mobile_browser===0){playVideo();doTrackingCall("event75");jwToPlay=true;if(!isMuted)doTrackingCall("event9")}},"onError":function(event){console.log("Youtube embed error.")},"onStateChange":function(event){if(!isMuted&&event.data===YT.PlayerState.PLAYING){pausePageRefresh();ytExpectedState=undefined}else if(event.data===YT.PlayerState.ENDED||
event.data===YT.PlayerState.PAUSED){resumePageRefresh();if(event.data===YT.PlayerState.ENDED){ytExpectedState=undefined;videoStopped();doTrackingCall("event13")}else if(ytExpectedState===1&&event.data===YT.PlayerState.PAUSED){ytExpectedState=undefined;playVideo()}else if(event.data===YT.PlayerState.PAUSED)doTrackingCall("event73")}}}});return TWP.youtube.youtubeVideos[args.vidID]}};var initYoutubePlayer=function(){var init=function(){var container=$root.find(".posttv-player-youtube-container");youtubePlayerObj=
loadYoutubePlayer({containerID:container.attr("id"),vidID:container.attr("data-videoId")})};if(typeof window.YT=="object")window.YT.ready(init);else if(typeof window.onYouTubeIframeAPIReady=="function"){var oldFunc=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=function(){oldFunc();init()}}else window.onYouTubeIframeAPIReady=function(){init()};var tag=document.createElement("script");tag.src=location.protocol+"//www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];
firstScriptTag.parentNode.insertBefore(tag,firstScriptTag)}}var onDemandPlayerWrapperId="posttv-player-ondemand-wrapper-"+localPlayerId;var onDemandPlayerWrapper=$root.find("#"+onDemandPlayerWrapperId);var jwToPlay=autoPlay,jwPlaying=false,videoQueued=undefined,jwPlayerObj;if($root.find(".posttv-player-ondemand").length>0){var onPlayerCreated=function(){jwReadyFlag=true;if(autoPlay)jwToPlay=true;setMute()};var onEmbedCodeChanged=function(){if(typeof videoQueued!=="undefined")updateVideo(onDemandPlayerWrapper.attr("data-video-uuid"),
videoQueued);if(mobile_browser===1){isMuted=false;videoStopped();jwToPlay=true}else if(jwToPlay)playVideo();else if(!jwToPlay&&!jwPlaying)pauseVideo()};var onPlayCompleted=function(){jwToPlay=false;jwPlaying=false;videoStopped();resumePageRefresh();if(uniquePlayerToken)wp_pb.report(uniquePlayerToken,"video_completed")};var onPause=function(){jwToPlay=false;jwPlaying=false;resumePageRefresh()};var onPlayheadTimeChanged=function(){if(jwToPlay&&!jwPlaying){jwPlaying=true;if(!isMuted)pausePageRefresh()}};
var onAdStarted=function(){$root.addClass("ad-playing")};var onAdCompleted=function(){$root.removeClass("ad-playing")};var callbacks={onPlayerCreated:onPlayerCreated,onPlayCompleted:onPlayCompleted,onEmbedCodeChanged:onEmbedCodeChanged,onPause:onPause,onPlayheadTimeChanged:onPlayheadTimeChanged,onAdStarted:onAdStarted,onAdCompleted:onAdCompleted};var shouldPlayAdOverride=function(shouldPlayAdSelection){try{var adOverride=posttvPlayerData[localPlayerId]["adOverride"];if(wp_meta_data.isHomepage===true&&
adOverride!==undefined&&adOverride.disablePreroll===true){var currentTime=(new Date).getTime();for(var cnt=0;cnt<adOverride.dates.length;cnt++)if(adOverride.dates[cnt].start<currentTime&&currentTime<adOverride.dates[cnt].end)return false}}catch(ex){}return shouldPlayAdSelection};var initOptions=function(){var args={callbacks:callbacks,showSharingOverlay:false,hideOverlayButtons:true,type:"html5"};if(shouldPlayAdOverride()===false)args=$.extend({shouldPlayAd:false},args);else if(posttvPlayerData[localPlayerId]["isYourThree"])args=
$.extend({shouldPlayAd:true},args);return args}}var updateVideo=function(uuid,shouldPlayAd){shouldPlayAd=shouldPlayAdOverride(shouldPlayAd);if(isJwReady()){if(shouldPlayAd!==undefined)jwPlayerObj.playUuid(uuid,{shouldPlayAd:shouldPlayAd});else jwPlayerObj.playUuid(uuid);if(jwPlaying&&!jwToPlay)jwToPlay=true;videoQueued=undefined}else videoQueued=shouldPlayAd===true};var socialEl=$root.find(".posttv-player-social");var imageOverlayEl=$root.find(".posttv-player-full-image-overlay");var muteEl=$root.find(".posttv-player-mute-overlay");
var videoTextEl=$("#posttv-player-text-"+localPlayerId);var sentinel=false;var tweetClicked=function(){window.open("https://twitter.com/share?url\x3d"+encodeURIComponent(shareUrl)+"\x26text\x3d"+encodeURIComponent(finalShareTitle),"_blank","width\x3d550,height\x3d450")};var facebookClicked=function(){var winHeight=600,winWidth=600;window.open("http://www.facebook.com/sharer.php?s\x3d100\x26p[url]\x3d"+encodeURIComponent(shareUrl)+"\x26t\x3d"+encodeURIComponent(finalShareTitle),"_blank","top\x3d"+
(screen.height/2-winHeight/2)+",left\x3d"+(screen.width/2-winWidth/2)+",toolbar\x3d0,status\x3d0,width\x3d"+winWidth+",height\x3d"+winHeight)};$root.find(".posttv-player-social-twitter").click(tweetClicked);$root.find(".posttv-player-social-facebook").click(facebookClicked);var isYoutubeReady=function(){return youtubeReadyFlag};var isJwReady=function(){return TWP.PostTV.players&&TWP.PostTV.players["posttv-player-ondemand-wrapper-"+localPlayerId]&&jwReadyFlag};var setMute=function(){if(isMuted)if(!isYoutube&&
isJwReady())TWP.PostTV.players["posttv-player-ondemand-wrapper-"+localPlayerId].player.setVolume(0);else{if(isYoutubeReady()){youtubePlayerObj.setVolume(0);youtubePlayerObj.mute()}}else if(!isYoutube&&isJwReady())TWP.PostTV.players["posttv-player-ondemand-wrapper-"+localPlayerId].player.setVolume(100);else if(isYoutubeReady()){youtubePlayerObj.unMute();youtubePlayerObj.setVolume(100)}};var loadPlayer=function(loadOnly){loadOnly=typeof loadOnly!=="undefined"?loadOnly:false;if(!isYoutube&&jwPlayerObj===
undefined){jwPlayerObj=TWP.PostTV.initPostTvPlayer(document.getElementById(onDemandPlayerWrapperId),initOptions());playerLoaded=true;if(!loadOnly)jwToPlay=true}else if(isYoutube&&youtubePlayerObj===undefined){playerLoaded=true;initYoutubePlayer();if(!loadOnly)jwToPlay=true}else if(!loadOnly)playVideo()};var playVideo=function(){jwToPlay=true;if(!isYoutube&&isJwReady()){TWP.PostTV.players["posttv-player-ondemand-wrapper-"+localPlayerId].play();videoPlaying()}else if(isYoutubeReady()){ytExpectedState=
1;youtubePlayerObj.playVideo();videoPlaying()}};var pauseVideo=function(){if(!isYoutube&&isJwReady()){if(jwPlaying)TWP.PostTV.players["posttv-player-ondemand-wrapper-"+localPlayerId].pause();jwToPlay=false;jwPlaying=false}else if(isYoutubeReady())youtubePlayerObj.pauseVideo()};var loadAndPlayVideo=function(){loadPlayer(true);playVideo()};var videoStopped=function(){imageOverlayEl.show();muteEl.hide();$root.addClass("social-buttons-hidden");pauseVideo()};var videoPlaying=function(){imageOverlayEl.hide();
if(isMuted){$root.addClass("social-buttons-hidden");muteEl.show()}else{if(allowShare)$root.removeClass("social-buttons-hidden");muteEl.hide()}setMute()};imageOverlayEl.click(function(){loadPlayer(false);pausePageRefresh()});muteEl.click(function(){isMuted=false;pausePageRefresh();videoPlaying();if(isYoutube)doTrackingCall("event9")});$root.click(function(){var overlayTimeout=4E3;if(mobile_browser===1&&!sentinel){sentinel=true;socialEl.show();window.setTimeout(function(){socialEl.hide();sentinel=false},
overlayTimeout)}});var playButtonTimeEl=$root.find(".posttv-player-play-time");var initPlayButton=function(){if(!posttvPlayerData[localPlayerId]["isLive"]){function padNum(n){return n>9?""+n:"0"+n}function readableDate(s){return parseInt(s/60)+":"+padNum(parseInt(s%60))}playButtonTimeEl.html(readableDate(posttvPlayerData[localPlayerId]["videoTime"]));playButtonTimeEl.show()}else playButtonTimeEl.hide()};var initCredits=function(){if(videoTextEl.find(".posttv-player-credits").length>0)if(videoTextEl.find(".posttv-player-caption-editor").html().trim()==
"")videoTextEl.find(".posttv-player-caption-separator").hide();else videoTextEl.find(".posttv-player-caption-separator").show()};var setSize=function(){var SMALL_BREAKPOINT=235;var setSizeHelp=function(){var width=$root.width();if(width<=SMALL_BREAKPOINT)$root.addClass("player-small");else $root.removeClass("player-small")};setSizeHelp();$(window).on("resize",setSizeHelp)};var showRender=function(){$(".wait-until-render").show()};var playerLoaded=false;$(window).scroll(function(){if(!playerLoaded&&
mobile_browser){var videoElRect=$root.get()[0].getBoundingClientRect();if(window.innerHeight+150>videoElRect.top)loadPlayer(true)}});var pausePageRefresh=function(){if(!!window.TWP&&!!TWP.hpRefreshTests)TWP.hpRefreshTests[localPlayerId]=function(){return false}};var resumePageRefresh=function(){if(!!window.TWP&&!!TWP.hpRefreshTests)delete TWP.hpRefreshTests[localPlayerId]};var updateOnDemandPlayer=function(args){videoTextEl.find(".posttv-player-headline").html(args.title);videoTextEl.find(".posttv-player-headline").prop("href",
args.url);videoTextEl.find(".posttv-player-blurb").html(args.blurb);videoTextEl.find(".posttv-player-caption-editor").html(args.editor);videoTextEl.find(".posttv-player-caption-source").html(args.source);try{wp_pb.StaticMethods.remarryHeadline(videoTextEl.find(".headline"))}catch(e){videoTextEl.find(".headline").css("width","auto")}shareUrl=args.url;finalShareTitle=args.title;posttvPlayerData[localPlayerId]["videoTime"]=args.duration;posttvPlayerData[localPlayerId]["isLive"]=String(args.isLive)==
"true";initPlayButton();initCredits();imageOverlayEl.find("img").attr("src","https://img.washingtonpost.com/wp-apps/imrs.php?h\x3d700\x26src\x3d"+encodeURIComponent(args.image));onDemandPlayerWrapper.attr("data-video-uuid",args.uuid);if(isJwReady()){if(args.startPlaying||imageOverlayEl.css("display")=="none")jwToPlay=true;updateVideo(args.uuid,args.shouldPlayAd)}else if(!isJwReady()&&args.startPlaying)loadPlayer(false)};$(function(){if(uniquePlayerToken){wp_pb.register(uniquePlayerToken,"new_video_selected",
updateOnDemandPlayer,this);wp_pb.register(uniquePlayerToken,"play_video",loadAndPlayVideo,this);wp_pb.register(uniquePlayerToken,"stop_video",videoStopped,this)}});var init=function(){setSize();initPlayButton();initCredits();if(autoPlay)videoPlaying();else videoStopped();imageOverlayEl.find("img").css("height","100%");imageOverlayEl.find("img").css("width","100%");if(showVideoText==="true")videoTextEl.css("display","block");if(autoPlay===true||i==0&&mobile_browser===1)loadPlayer(true);showRender()};
init()};for(var i=0;i<players.length;i++)initPlayer(players[i],i);$(window).trigger("scroll")})(jQuery);