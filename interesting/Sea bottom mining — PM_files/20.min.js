(function(k,e,E){if(k.hpmd&&hpmd.INITIALIZED)hpmd.sync&&(hpmd.push=function(a){a()});else{var qa="https:"==location.protocol?"https:":"http:",ra=!1,N,m,w=null,F=[],sa,U,G,V=[],W=[],h,X=null,s,p={view:[],expand:[],collapse:[],interstitial:[],native:[]},t=0,Y=null,Z=null,u,x=null,$,ta,ua=!0,n,aa,q,va,wa=!!k.hpmd,O={},xa={},ba=[],y=wa?hpmd:[],A=function(a){a.method||(a.method="POST");a.url||(a.url=qa+"//banner.hpmdnetwork.ru/");a.data?"string"==typeof a.data?a.type||(a.type="application/x-www-form-urlencoded"):
(a.data=JSON.stringify(a.data),a.type||(a.type="application/json")):a.data="";var b=new XMLHttpRequest;b.open(a.method,a.url,!0);b.withCredentials=!0;a.type&&b.setRequestHeader("Content-Type",a.type);a.success&&(b.onreadystatechange=function(){if(4==this.readyState){try{this.json=JSON.parse(this.responseText)}catch(b){this.json=null}a.success.bind(this).call()}});b.send(a.data)},P=function(a,b,c){var d="";c&&(d="; expires="+(new Date((new Date).valueOf()+1E3*c)).toUTCString());e.cookie=a+"="+b+"; path=/; domain="+
s+d},B=function(a){V.push(a)},Oa=function(){B=function(a){a()};V.map(function(a){try{a()}catch(b){}});V=null},ya=function(a){h=a;P("hpmd_uid2",h,31536E3);B(function(){G.contentWindow.postMessage("hpmd.setuid"+h,"*")})},za=function(){B(function(){var a=[];W.map(function(b){b[1]>h&&(a.push({view_id:b[0],from:b[1],to:h}),b[1]=h)});a.length&&A({data:{method:"ad.remap",data:{map:a}}})})},ca=function(a){try{a()}catch(b){k.console&&console.log("hpmd: callback error:",b)}},Aa=function(a,b){if("undefined"==
typeof p[a])throw Error("Unknown event "+a);p[a].push(b)},Ba=function(a,b){if("undefined"==typeof p[a])throw Error("Unknown event "+a);for(var c=0;c<p[a].length;c++)p[a][c]===b&&(p[a][c]=null)},I=function(a,b){if("close"==a){if(da(),0!=F.length){var c=F[0];F=F.slice(1);H(c);ea(c)}}else for(c=0;c<p[a].length;c++)if(p[a][c])try{p[a][c](b)}catch(d){}},Q=[],fa,J=function(a){Q.push(a);var b=function(){if(e.body){for(var a=0;a<Q.length;a++)Q[a]();Q=[]}else fa||(fa=setTimeout(function(){fa=null;b()},300))};
b()},K=[],C=function(){switch(e.readyState){case "interactive":case "complete":e.removeEventListener("DOMContentLoaded",C);e.removeEventListener("readystatechange",C);k.removeEventListener("load",C);for(var a=0;a<K.length;a++)J(K[a]);K=[]}},Pa=function(a){switch(e.readyState){case "interactive":case "complete":J(a);break;default:K.push(a),1==K.length&&(e.addEventListener("DOMContentLoaded",C),e.addEventListener("readystatechange",C),k.addEventListener("load",C))}},ga=[],Qa=function(){for(var a=0;a<
ga.length;a++)ga[a]();R=function(a){a()}},R=function(a){ga.push(a)},Ca=function(a,b){b||(b=n);b.hpmd.trackEvent("hpmd.js-exception",a.stack?{exception:{name:a.name,message:a.message,source:{file:a.fileName,line:a.lineNumber,char:a.columnNumber},stack:a.stack}}:{exception:{name:a.message?a.message:a.error}});k.console&&console.log("hpmd.banner: error: ",a)},ha=e.write,Ra=e.writeln,Sa=e.open,Ta=e.close,Da="getElementsByTagName getElementsByTagNameNS getElementsByClassName querySelector querySelectorAll getElementById getElementsByName".split(" "),
ia={},ja={},Ua=function(){if("loading"!=e.readyState)return!0;try{ha.call(e,'<ins id="hpmds-as"></ins>');var a=e.getElementById("hpmds-as");return a?(a.parentNode.removeChild(a),!1):!0}catch(b){return!0}},L,v,D,Ea,Fa=function(a){try{Object.defineProperty(e,"readyState",{configurable:!0,get:function(){return a}})}catch(b){e.readyState=a}},Va=function(a){L=a;D="";v=[];Ga(!0);e.write=function(a){Ua()?D+=a:ha.call(e,a)};e.writeln=function(a){e.write(a+"\n")};e.open=function(){return this};e.close=function(){};
(Ea="complete"==e.readyState)&&Fa("interactive");Da.map(function(a){ia[a]=e[a];e[a]=function(){ka();return ia[a].apply(this,[].slice.call(arguments))};ja[a]=Element.prototype[a];Element.prototype[a]=function(){ka();return ja[a].apply(this,[].slice.call(arguments))}})},Ga=function(a){[].map.call(e.querySelectorAll("script"),function(b){b[(a?"add":"remove")+"EventListener"]("load",Ha);b[(a?"add":"remove")+"EventListener"]("error",Ha)})},ka=function(){var a=L.nextSibling;L.insertAdjacentHTML("afterend",
D);for(var b=L.nextSibling;b&&a!==b;)v.push(b),b=b.nextSibling;v.length&&(L=v[v.length-1]);D=""},Wa=function(){e.write=ha;e.writeln=Ra;e.open=Sa;e.close=Ta;if(Ea){Fa("complete");var a=e.createEvent("Event");a.initEvent("readystatechange",!0,!0);e.dispatchEvent(a)}Da.map(function(a){e[a]=ia[a];Element.prototype[a]=ja[a]});Ga(!1)},Ha=function(){D="";v.map(function(a){a.parentNode.removeChild(a)});v=[]},la=!1,ma=[],Xa=function(a,b){ma[b?"unshift":"push"](a);la||Ia()},Ia=function(){ma.length?(la=!0,ma.shift()()):
la=!1},Ja=function(a,b,c){if(0<a.length){var d=a.shift(),g=d.hasAttribute("src"),f=e.createElement("script"),l=function(){Ja(a,b,c)},z=function(a){if(-1!==c){var b;ka();Wa();b=v}-1!==c?na(f,b,l,null,!0):l();Ia()};f.addEventListener("load",z);f.addEventListener("error",z);for(var z=d.attributes,S=0;S<z.length;S++)f.setAttribute(z[S].name,z[S].value);g||f.setAttribute("src","data:text/javascript;base64,"+btoa(unescape(encodeURIComponent(d.innerHTML))));f.innerHTML=d.innerHTML;Xa(function(){-1!==c&&
Va(f);d.parentNode.replaceChild(f,d)},!0===c)}else b&&b()},Ka=function(a){var b=e.createElement("style");b.setAttribute("type","text/css");b.innerHTML=a;e.querySelector("head").appendChild(b);return b},na=function(a,b,c,d,g){var f,l;l=e.createElement("div");if("string"==typeof b)l.innerHTML=b;else for(;f=b.shift();)l.appendChild(f);for(b=[].concat([].slice.call(l.querySelectorAll("script")));0<l.childNodes.length;)f=l.childNodes[0],!0===g?(a.parentNode.insertBefore(f,a.nextSibling),a=f):a.appendChild(f),
d&&d(f);Ja(b,c,g)},ea=function(a){J(function(){var b="interstitial"==a.format;if(b)aa=a;else{try{da()}catch(c){}n=a}"number"==typeof a.view||"teaser"!=a.format&&"fullscreen"!=a.format||H(a);a.nodes=[Ka(a.data.css)];na(e.body,a.data.html,function(){try{var c=a.data.initializer||$;c&&E(c)(a.hpmd);E(a.data.js)(a.hpmd);b&&La(a)}catch(g){if(a.imitation)a.onException(g);else Ca(g,a)}},function(b){a.nodes.push(b)},a.data.sync?!1:-1)})},Ya=function(a,b){var c=function(d){var g=d.target||d.srcElement;if(g){var f=
!1;do f=!!g.tagName&&"a"==g.tagName.toLowerCase(),f||(g=g.parentNode);while(g&&!f);if(f&&(!g.getAttribute("target")||"_self"==g.getAttribute("target"))){for(f=g;f&&f.getAttribute;){if(f.getAttribute("id")&&0==f.getAttribute("id").indexOf("hpmd")||-1<f.className.indexOf("hpmd"))return;f=f.parentNode}if((g=g.getAttribute("href"))&&!(-1<g.indexOf("#"))){e.documentElement.removeEventListener("click",c);f=function(){if(b){try{d.preventDefault()}catch(a){}try{d.stopPropagation()}catch(c){}return!1}};try{a(g)}catch(l){throw N&&
f(),l;}return f()}}}};e.documentElement.addEventListener("click",c)},La=function(a){Ya(function(b){!u&&m&&da();sa=b;!u&&m&&H(a,function(){I("interstitial")});a.hpmd.data.openBanner()},!0)},da=function(){if(n){if(n.hpmd.data.destroy&&"function"==typeof n.hpmd.data.destroy)try{n.hpmd.data.destroy()}catch(a){}for(var b=0;b<n.nodes.length;b++)try{n.nodes[b].parentNode.removeChild(n.nodes[b])}catch(c){}}},H=function(a,b){A({data:{method:"ad.view",data:{view_id:a.view.id,hash:a.view.hash,uid:a.view.uid}},
success:function(){var c=this.json;!0===c.success&&(c=c.data.view_id,W.push([c,a.view.uid]),a.viewAllocated(c),za(),b&&b())}})},Za=function(){if(null!==X)return X;var a;if(e.referrer){var b;a=(b=/\/\/([^\/]+)\//.exec(e.referrer))?b[1]==s||b[1].indexOf("."+s)==b[1].length-s.length-1?!1:!0:!1}else a=!0;b=!/hpmd_session=/.exec(e.cookie);P("hpmd_session","1",1800);return X=a&&b},oa=function(a){for(var b,c,d=0;d<a.length;d++){b=a[d];switch(b.type){case "native":c=r(1);break;case "native_wrapper":Z=b;c=
r(2);break;default:c=null}try{b.id&&(xa[b.id]=c),function(a,b){var c=function(){E(a.js)(b)};J(c);"native_wrapper"==a.type&&(Pa(c),k.addEventListener("load",function(){c();k.removeEventListener("load",c)}))}(b,c)}catch(g){k.console&&console.log("hpmd.plugins."+b.type,": error:",g)}}},$a=function(a){xa.native.slotReady(a)},M=[],ab=function(a,b){for(var c=!1,d,g=0;g<a.length;g++)d=a[g],"number"==typeof d.view&&W.push([d.view,b]),r(0,d),"native"==d.format?M.push(d):c&&"interstitial"!=d.format?F.push(d):
(c=!0,ea(d));a.length&&(q=a[0],Ma())},pa=function(a,b){var c=!1;try{if(!0===a.success){if(a.data.uid){var d=parseInt(a.data.uid);(!h||h>d)&&ya(d)}a.data.segment&&(O=a.data.segment,O.site=m);a.data.config&&a.data.config.site&&(U=a.data.config.site);if(c=!!a.data.banners&&!!a.data.banners.length){if(1==t)for(var g=a.data.banners.length,d=0;d<9*g;d++)a.data.banners[a.data.banners.length]=a.data.banners[d%g];ab(a.data.banners,a.data.uid)}a.data.plugins&&a.data.plugins.length&&(oa(a.data.plugins),0<ba.length&&
oa(ba));if(!a.data.supported&&x)x.onUnsupported(void 0);$=a.data.initializer;za();if(a.data.use_data){k.adcm_config={id:1071,profileId:""+a.data.uid,platformId:71,init:function(){k.adcm.call()}};var f=e.createElement("script");f.setAttribute("src","//tag.digitaltarget.ru/adcm.js");f.async=!0;e.querySelector("head").appendChild(f);A({data:{method:"ad.tmp.data",data:{uid:a.data.uid}}})}}else{if(1002==a.error&&x)x.onUnsupported(!0);va=a}if(1<t){var l=e.createElement("script");l.setAttribute("src","//misc"+
(2==t?"-dev.hpmdnetwork.ru":".hpmd.local")+"/native/debug/merge.js?"+Math.random());e.getElementsByTagName("head")[0].appendChild(l)}}catch(z){}u||I("view",{hasBanner:c,isCommercial:!0,uid:h,context:b});Qa()},Na=function(a){a&&a.selectors&&(Y=a);var b={uid:h,site_id:m,url:location.href.toString(),new_session:Za()};w&&(b.section_id=w);if(u)if(ua)b.demo=u,ua=!1;else{Z&&oa([Z]);return}t&&(b.native=t);a&&(b.context={},["format","subformat","except_format","formats"].map(function(c){a[c]&&(b.context[c]=
a[c])}));x&&(b.imitate_format=x);b={method:"ad.get",data:b};k.hpmd&&hpmd.sync&&(ra=!0);ra?(e.write('<script src="//banner.hpmdnetwork.ru/get?n='+hpmd.syncb.length+"&p="+encodeURIComponent(JSON.stringify(b))+'">\x3c/script>'),hpmd.syncb.push(function(b){pa(b,a)})):B(function(){b.data.uid=h;A({data:b,success:function(){pa(this.json,a)}})})},bb=function(){ta=!0},cb=function(a){Na(a)},db=function(a){var b=[],c=[],d=[];a.viewAllocated=function(g){a.view=g;var f=a.hpmd;f.trackEvent=function(b,c){A({data:{method:"ad.event",
data:{uid:h,banner_id:a.data.id,site_id:m,section_id:w,url:location.href.toString(),view:a.view,event:b,data:"undefined"==typeof c?null:c}}});if(a.data.pixels&&a.data.pixels[b])for(var d=a.data.pixels[b],g=function(a){var b=e.createElement("img");b.setAttribute("src",a.replace(/\{RND\}/g,function(){return Math.random()}));b.style.cssText="position:absolute;left:-10000px;width:1px;height:1px";e.body.appendChild(b)},f=0;f<d.length;f++)g(d[f])};f.trackLink=function(a,b,c,d){c||(c={});a=f.prepareLink(a,
b,d);c.newWindow?k.open(a,c.name?c.name:null,c.specs?c.specs:null,!!c.replace):location.href=a};f.prepareLink=function(b,c,d){b=qa+"//banner.hpmdnetwork.ru/track/event?uid="+h+"&banner_id="+a.data.id+"&site_id="+m+"&view="+a.view+"&event="+encodeURIComponent(b)+"&redirect_uri="+encodeURIComponent(c)+"&url="+encodeURIComponent(location.href.toString());w&&(b+="&section_id="+w);d="undefined"==typeof d?null:d;null!==d&&(b+="&data="+encodeURIComponent(JSON.stringify(d)));return b};f.link=function(b){var c=
arguments;b=b||0;var d;a.data.links&&(d=a.data.links[b]);d||(d="http://www.hpmdnetwork.ru/");d=d.replace(/\{RND\}/g,function(){return Math.random()});d=d.replace(/\{(\d+)\}/g,function(a,b){return b<c.length?c[b]:a});f.trackLink("hpmd.link"+b,d,{newWindow:!0})};f.ready=function(a){a()};f.asyncPrepareLink=function(a,b,c){arguments[arguments.length-1](f.prepareLink.apply(this,[].slice.call(arguments,0,arguments.length-1)))};for(g=0;g<b.length;g++)f.trackEvent.apply(this,b[g]);for(g=0;g<c.length;g++)f.trackLink.apply(this,
c[g]);for(g=0;g<d.length;g++)d[g]();d=c=b=null};"number"==typeof a.view?a.viewAllocated(a.view):(a.hpmd.trackEvent=function(){b.push([].slice.call(arguments))},a.hpmd.trackLink=function(){c.push([].slice.call(arguments))},a.hpmd.prepareLink=function(){throw Error("hpmd.banner: this banner has not been initialized yet");},a.hpmd.ready=function(a){d.push(a)},a.hpmd.asyncPrepareLink=function(){var b=[].slice.call(arguments);a.hpmd.ready(function(){a.hpmd.asyncPrepareLink.apply(this,b)})})},T=function(a){return O[a]},
eb=function(a){A({data:{method:"ad.sysview",data:{banner_id:a.data.id,view_buffer_id:a.view.id,site_id:m,section_id:w,uid:h,url:location.href.toString()}}})},r=function(a,b){switch(a){case 3:var c={push:ca,events:{add:Aa,remove:Ba,fire:function(a,b){I(a,b)}},receive:function(a){pa({success:!0,data:a})},requestBanners:cb,mute:bb,INITIALIZED:!0,sync:k.hpmd&&hpmd.sync,syncb:[]};N&&(c.registerException=Ca,c.getBannerInfo=function(a){R(function(){a(n?n:aa?aa:M.length?M[0]:null,va)})},c.getUid=function(a){R(function(){B(function(){a(h)})})});
return c;case 0:return b.hpmd={data:{},getSegment:T,getStylesheet:function(){return b.nodes[0].sheet},push:ca,events:{add:Aa,remove:Ba,fire:function(a,c){"interstitial"==b.format&&"close"==a?location.href=sa:I(a,c)}}},db(b),"native"==b.format&&(b.allocateView=function(){b.view.uid?(H(b),delete b.allocateView):B(function(){b.view.uid=h;H(b);delete b.allocateView})}),function(a){var b;b=U?E(U)():{zIndex:{active:1E6,inactive:1E6}};a.getConfig=function(){return b}}(b.hpmd),m||(b.hpmd.setSegments=function(a){O=
a}),b.hpmd;case 1:return{getSegment:T,banners:M,eval:E,sysview:eb,events:{fire:I},context:Y,getPendingInitializer:function(){return $},injectHTML:na,injectCSS:Ka};case 2:return{getSegment:T,slotReady:$a,context:Y}}},Ma=function(){if(wa&&(!k.hpmd||!k.hpmd.INITIALIZED)&&(N?(hpmd=q?q.hpmd:m?r(3):r(0,{}),hpmd.initializeInterstitial=function(){La({hpmd:hpmd})},u&&(hpmd.getViewId=function(){return q.view}),hpmd.imitate=function(a,c){var d=function(){var d={data:{id:1,html:a.html,css:a.css,js:a.js,subformat:a.subformat},
placement:a.placement,format:a.format,imitation:!0,onException:a.onException,onUnsupported:a.onUnsupported};"native"==d.format?(d.view={id:1,hash:"00000000000000000000000000000000"},r(0,d),M.push(d)):(d.view=1,r(0,d),ea(d));c&&c()};"native"==a.format?d():R(d)},hpmd.imitatePlugins=function(a){ba.push(a)},hpmd.imitateFormat=function(a,c,d){x={format:a,subformat:c,onUnsupported:d}}):hpmd=r(3),t)){if(q)hpmd.trackEvent=q.hpmd.trackEvent,hpmd.trackLink=q.hpmd.trackLink,hpmd.prepareLink=q.hpmd.prepareLink,
hpmd.asyncPrepareLink=q.hpmd.asyncPrepareLink;else{var a={data:{id:0}};r(0,a);hpmd.trackEvent=a.hpmd.trackEvent;hpmd.trackLink=a.hpmd.trackLink;hpmd.prepareLink=a.hpmd.prepareLink;hpmd.asyncPrepareLink=a.hpmd.asyncPrepareLink}hpmd.getSegment=T}};(function(){var a=1,b=location.host.split(".").length,c;do{s=location.host.split(".").splice(b-a,b).join(".");c=s+":"+Math.random();e.cookie="hpmd_cd="+c+"; path=/; domain="+s;if(-1<e.cookie.indexOf("hpmd_cd="+c))return;a++}while(a<=b);s=location.host})();
(function(){for(var a=e.getElementsByTagName("script"),b,c=0;c<a.length;c++)if(a[c].hasAttribute("src")&&-1<(b=a[c].getAttribute("src")).indexOf(".hpmdnetwork.ru")){var d=/client\/(\d+)\.(min\.)?js/.exec(b);if(d&&d[1]){m=parseInt(d[1]);N=-1<[50,51,52].indexOf(m);break}}})();(function(){var a;if(a=/hpmd_demo=(\d+)\.([a-f0-9]{40})((\.\w+)+)?/.exec(location.href))u={banner_id:parseInt(a[1]),hash:a[2]},a[3]&&(u.extra=a[3].substring(1,1E3).split("."));if(a=/hpmd_bind_native=([0-3])/.exec(location.href))"0"==
a[1]?P("hpmd_bind","",-86400):(t=parseInt(a[1]),P("hpmd_bind",a[1]));else if(a=/hpmd_bind=([0-3])/.exec(e.cookie))t=parseInt(a[1])})();(function(a){if(a=/hpmd_uid2=(\d+)(;|$)/.exec(e.cookie))h=parseInt(a[1]);k.addEventListener("message",function(a){"https://banner.hpmdnetwork.ru"==a.origin&&"hpmd.uid"==a.data.substring(0,8)&&(a=parseInt(a.data.substring(8)),!isNaN(a)&&a<h&&(h=a),h&&ya(h),Oa())});G=e.createElement("iframe");G.style.cssText="position:absolute;left:-100px;top:-100px;width:1px;height:1px;";
G.setAttribute("src","https://banner.hpmdnetwork.ru/track/handler1.html");J(function(){e.body.appendChild(G)})})();Ma();(function(){if(y.length)for(var a=0;a<y.length;a++)if(y[a])switch(typeof y[a]){case "string":0==y[a].indexOf("s/")&&(w=parseInt(y[a].substring(2,1E3)));break;case "function":ca(y[a])}})();ta||Na()}})(window,document,function(){return function(k){return eval("(function(hpmd){"+k+"})")}}());