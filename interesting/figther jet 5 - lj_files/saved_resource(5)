/* >>> file start: js/jquery/jquery.comments.js */
!function(e){e.comments=e.comments||{options:{selectors:{leaf:LJ.Util.isMediusJournal()?".mdspost-comment":".b-leaf",levelTwig:LJ.Util.isMediusJournal()?".mdspost-thread--level-{level}":".b-tree-twig-{level}",twig:LJ.Util.isMediusJournal()?".mdspost-thread":".b-tree-twig"},classNames:{levelTwig:LJ.Util.isMediusJournal()?"mdspost-thread--level-{level}":"b-tree-twig-{level}"}},skipAnimation:jQuery.browser.msie&&+jQuery.browser.version<=8||LJ.Support.isMobile()||!1,isMac:!!navigator.appVersion.match(/mac/i),_selector:function(e){return this.options.selectors[e]},_className:function(e){return this.options.classNames[e]}};var t=e.comments._selector.bind(e.comments),s=e.comments._className.bind(e.comments);e.extend(e.comments,{level:function(e){var l=e.is(t("twig"))?e:e.closest(t("twig")),i=RegExp(s("levelTwig").supplant({level:"(\\d+)"})).exec(l.prop("className"));return i&&parseInt(i[1],10)||1},parent:function(s,l){for(var i=s.closest(t("twig")),n=e.comments.level(i),r=i;n>1;){if(n--,r=r.prevAll(t("levelTwig").supplant({level:n})+":first"),0===r.length)return!1;if(!l||r.data("tid")===l)return r.find(t("leaf"))}return!1},hasChildren:function(s){var l=s.is(t("twig"))?s:s.closest(t("twig")),i=e.comments.level(l);return e.comments.level(l.next())>i},isChild:function(s,l){var i=s.is(t("twig"))?s:s.closest(t("twig")),n=l.is(t("twig"))?l:l.closest(t("twig")),r=e.comments.level(l),o=e.comments.level(s);if(1===o||r>=o)return!1;var a=i.prevAll(t("levelTwig").supplant({level:r})+":first");return a.get(0)===n.get(0)},getThread:function(s,l){var i,n=s.closest(t("twig")),r=e.comments.level(n),o=l?[]:jQuery(),a=n;for(l?o.push(n.find(t("leaf"))):o=o.add(n.find(t("leaf")));;){if(a=a.next(),0===a.length)break;if(i=e.comments.level(a),r>=i)break;l?o.push(a.find(t("leaf"))):o=o.add(a.find(t("leaf")))}return o}})}(jQuery);
/* <<< file end: js/jquery/jquery.comments.js */

//# map link was there [jquery.comments.js.map]
/* >>> file start: js/jquery/jquery.hotkeys.js */
!function(e){function t(t){if("string"==typeof t.data){var s=t.handler,a=t.data.toLowerCase().split(" ");t.handler=function(t){if(this===t.target||!/textarea|select/i.test(t.target.nodeName)&&!/text|password|search|tel|url|email|number/.test(t.target.type)){var r="keypress"!==t.type&&e.hotkeys.specialKeys[t.which],f=String.fromCharCode(t.which).toLowerCase(),i="",h={};t.altKey&&"alt"!==r&&(i+="alt+"),t.ctrlKey&&"ctrl"!==r&&(i+="ctrl+"),t.metaKey&&!t.ctrlKey&&"meta"!==r&&(i+="meta+"),t.shiftKey&&"shift"!==r&&(i+="shift+"),r?h[i+r]=!0:(h[i+f]=!0,h[i+e.hotkeys.shiftNums[f]]=!0,"shift+"===i&&(h[e.hotkeys.shiftNums[f]]=!0));for(var l=0,n=a.length;n>l;l++)if(h[a[l]])return s.apply(this,arguments)}}}}e.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",187:"+",189:"-",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},e.each(["keydown","keyup","keypress"],function(){e.event.special[this]={add:t}})}(jQuery);
/* <<< file end: js/jquery/jquery.hotkeys.js */

//# map link was there [jquery.hotkeys.js.map]
/* >>> file start: js/jquery/jquery.lj.commentsPager.js */
//= require js/jquery/jquery.hotkeys.js
!function(t){"use strict";function e(t){this._switch("prev",t)}function a(t){this._switch("next",t)}function s(){return this._currentPage}function i(t){var e=Number(jQuery(t.currentTarget).text());e&&this._switch(e,t)}function r(t){var e;this._el("page").removeClass(this._cl("active")).eq(t-1).addClass(this._cl("active")),this.element.toggleClass(this._cl("first"),1===t).toggleClass(this._cl("last"),t===this._totalPages),this._ajaxLoader&&this._master&&(e=location.href.split("#")[0].replace(/\&?(page|view)=\d+/g,""),e=LiveJournal.constructUrl(e,t>1?{page:t}:null).replace("?&","?"),t!==this._currentPage&&(this._pushStateCount++,window.history.pushState(null,"",e))),this._ajaxLoader&&(e=location.href.split("#")[0].replace(/\&?(page|view)=\d+/g,""),this._el("prev").attr("href",LiveJournal.constructUrl(e,3>t?null:{page:t-1})),this._el("next").attr("href",LiveJournal.constructUrl(e,{page:t+1}))),this._currentPage=t,this._formatPages()}function n(t,e){var a,s;this._ajaxLoader?(s="next"!==t&&"prev"!==t?t:this._currentPage+("next"===t?1:-1),s=this._correctPageNumber(s),s!==this._currentPage&&this._fire("commentsPage",[s],!0)):(a=this._links[t].prop("href"),document.location=a),LJ.Event.trigger("commentsPager/change"),e&&e.preventDefault&&e.preventDefault()}function o(){var e,a=this;this._master&&(e=this._scrollTop,this._scrollTop=t(window).scrollTop(),this._scrollTop<=e||(this._bottomPager=this._bottomPager||t(".b-pager").last(),this._bottomPager.is(":screenable")&&!this._cachePages[this._currentPage]&&(this._cachePages[this._currentPage]=!0,setTimeout(function(){a._cachePages[a._currentPage]=!1},1e3*a._cachePagesTime),this._fire("cachePage",[this._correctPageNumber(this._currentPage+1)]),this._fire("cachePage",[this._correctPageNumber(this._currentPage-1)]))))}function c(t){return 1>t?1:t>this._totalPages?this._totalPages:t}function h(){t.lj.basicWidget.prototype._bindControls.apply(this);var e=this,a=t.comments.isMac?"alt":"ctrl",s=LJ.Function.threshold(this._switch,500);_||(jQuery(document).bind("keydown",a+"+left",s.bind(this,"prev")).bind("keydown",a+"+right",s.bind(this,"next")),this._ajaxLoader&&(window.onpopstate=function(){var t=1;location.href.match(/page=(\d+)/)&&(t=Number(RegExp.$1)),e._currentPage!==t&&e._pushStateCount>0&&(e._currentPage=t,e._fire("commentsPage",[t],!0))},t(window).on("scroll",LJ.Function.throttle(this._scroll.bind(this),100))),_=!0,this._master=!0),this._ajaxLoader&&(this.element.on("click",this._s("page"),this.loadPage.bind(this)).on("click",this._s("next"),this.next.bind(this)).on("click",this._s("prev"),this.prev.bind(this)),this._on("commentsPage",function(t){this._updatePager(t)}.bind(this)))}function l(){function t(t){jQuery(s[t]).after(a)}function e(t,e){LJ.Function.range(t,e).forEach(function(t){jQuery(s[t]).hide()})}jQuery(".b-pager-more__wrap",this.element).remove();var a='<li class="b-pager-page b-pager-more__wrap"><span class="b-pager-more">...</span></li>',s=this._el("page");if(s.show(),!(this._totalPages<=9)){if(10===this._totalPages)return this._currentPage<=5?(e(7,8),t(7)):(e(1,2),t(1));if(this._currentPage<=5)return e(7,this._totalPages-2),t(7);if(this._currentPage>=this._totalPages-4)return e(1,this._totalPages-8),t(1);e(1,this._currentPage-4),e(this._currentPage+2,this._totalPages-2),t(1),t(this._currentPage+2)}}function g(){t.lj.basicWidget.prototype._create.apply(this);var e=this.options.selectors,a=this.element;this._scrollTop=null,this._bottomPager=null,this._cachePages={},this._cachePagesTime=100,this._links={prev:a.find(e.prev),next:a.find(e.next)},t.comments.isMac&&this.element.addClass(this._cl("mac")),this._ajaxLoader=!(!LJ.get("ajaxPagination")||!LJ.Support.history),this._currentPage=parseInt(a.find(e.active).text(),10)||1,this._totalPages=this._el("page").length,this._master=!1,this._formatPages(),this._pushStateCount=/webkit/i.test(navigator.userAgent)?0:1,this._bindControls()}var _=!1,u={classNames:{first:"b-pager-first",last:"b-pager-last",mac:"b-pager-mac",active:"b-pager-page-active"},selectors:{page:".b-pager-page",prev:".b-pager-prev a",next:".b-pager-next a",active:".b-pager-page-active"}};t.widget("lj.commentsPager",jQuery.lj.basicWidget,{options:u,_create:g,_bindControls:h,_formatPages:l,_correctPageNumber:c,_scroll:o,_switch:n,_updatePager:r,loadPage:i,page:s,next:a,prev:e})}(jQuery);
/* <<< file end: js/jquery/jquery.lj.commentsPager.js */

//# map link was there [jquery.lj.commentsPager.js.map]
/* >>> file start: js/jquery/jquery.lj.comments.js */
LJ.UI.registerTemplate('templates-Comments-Twig', "<div class=\" b-tree-twig {{if $data.level}} b-tree-twig-{{html $data.level}} b-tree-twig-deep-{{html $data.deepLevel}} {{/if}} \" style=\"margin-left: {{html $data.margin}}px\" data-tid=\"t{{html $data.dtalkid}}\" > {{if $data.html}} {{html $data.html}} {{else}} {{if $data.more}} <div class=\" b-leaf b-leaf-seemore {{if $data.moreclass}} b-leaf-seemore-{{html $data.moreclass}} {{/if}} \" data-parent=\"{{html $data.parent}}\" data-dtalkids=\"{{html $data.data}}\" data-updated-ts=\"{{html $data.touched}}\" data-count=\"{{html $data.more}}\" > <div class=\" b-leaf-inner svgpreloader svgpreloader-pseudo svgpreloader-16 \"> {{each ($value.actions || $data.actions)}} <span class=\"b-leaf-seemore-more\"> <a href=\"{{if ($value.href || $data.href)}}{{html ($value.href || $data.href)}}{{else}}#{{/if}}\" rel=\"nofollow\" class=\"b-pseudo\" >{{html ($value.title || $data.title)}}</a> </span> {{if ($value.is_remote_sup || $data.is_remote_sup)}} {{if ($value.ljusers || $data.ljusers)}} <span class=\"b-leaf-seemore-from\">{{html LJ.mltext(\'talk.from\')}}</span> <span class=\"b-leaf-seemore-users\">{{each ($value.ljusers || $data.ljusers)}}{{if !(($value.anonymous || $data.anonymous))}}{{if ($value.legacy || $data.legacy)}}{{html ($value.ljuser || $data.ljuser)}}{{else}}{{if ($value.amp || $data.amp)}} <span class=\"ljuser {{if !(($value.inline_css || $data.inline_css))}} i-ljuser {{if ($value.striked || $data.striked)}} i-ljuser-deleted {{/if}} i-ljuser-type-{{html ($value.journaltype || $data.journaltype)}} {{/if}} {{if ($value.noctxpopup || $data.noctxpopup)}} noctxpopup i-ljuser-nopopup {{/if}} {{if ($value.alias || $data.alias)}} with-alias i-ljuser-withalias {{/if}} {{if ($value.side_alias || $data.side_alias)}} with-alias-value i-ljuser-showalias {{/if}} \">{{if ($value.show_userhead || $data.show_userhead)}}<a href=\"{{html ($value.profile_url || $data.profile_url)}}\" class=\"i-ljuser-profile\" ><amp-img class=\"i-ljuser-userhead\" src=\"{{html ($value.userhead_url || $data.userhead_url)}}\" width=\"16\" height=\"16\" ></amp-img></a>{{/if}}<a href=\"{{html ($value.journal_url || $data.journal_url)}}\" class=\"i-ljuser-username\" ><b>{{html ($value.journal || $data.journal)}}</b></a></span> {{else}} <span {{if ($value.inline_css || $data.inline_css)}} style=\" white-space:nowrap; {{if ($value.striked || $data.striked)}} text-decoration:line-through; {{/if}} \" {{/if}} class=\"ljuser {{if !(($value.inline_css || $data.inline_css))}} i-ljuser {{if ($value.striked || $data.striked)}} i-ljuser-deleted {{/if}} i-ljuser-type-{{html ($value.journaltype || $data.journaltype)}} {{/if}} {{if ($value.noctxpopup || $data.noctxpopup)}} noctxpopup i-ljuser-nopopup {{/if}} {{if ($value.alias || $data.alias)}} with-alias i-ljuser-withalias {{/if}} {{if ($value.side_alias || $data.side_alias)}} with-alias-value i-ljuser-showalias {{/if}} \" {{html ($value.attrs || $data.attrs)}} data-ljuser=\"{{html ($value.username || $data.username)}}\" lj:user=\"{{html ($value.username || $data.username)}}\" >{{if ($value.show_userhead || $data.show_userhead)}}<a href=\"{{html ($value.profile_url || $data.profile_url)}}\" {{if ($value.target || $data.target)}} target=\"{{html ($value.target || $data.target)}}\" {{/if}} class=\"i-ljuser-profile\" ><img {{if ($value.inline_css || $data.inline_css)}} width=\"16\" height=\"16\" style=\"vertical-align:text-bottom;border:0;padding-right:1px;\" {{else}} class=\"i-ljuser-userhead\" {{/if}} src=\"{{html ($value.userhead_url || $data.userhead_url)}}\" /></a>{{/if}}<a href=\"{{html ($value.journal_url || $data.journal_url)}}\" class=\"i-ljuser-username\" {{if ($value.color || $data.color)}} style=\"color:{{html ($value.color || $data.color)}};\" {{/if}} {{if ($value.target || $data.target)}} target=\"{{html ($value.target || $data.target)}}\" {{/if}} {{if ($value.alias || $data.alias)}} title=\"{{html ($value.user_alias || $data.user_alias)}}\" {{/if}} >{{if ($value.inline_css || $data.inline_css)}}{{if ($value.bold || $data.bold)}}<b>{{/if}}{{html ($value.journal || $data.journal)}}{{if ($value.alias || $data.alias)}}<span class=\"useralias-value\">*</span>{{/if}}{{if ($value.bold || $data.bold)}}</b>{{/if}}{{else}}{{if ($value.bold || $data.bold)}}<b>{{/if}}{{html ($value.journal || $data.journal)}}{{if ($value.bold || $data.bold)}}</b>{{/if}}{{/if}}</a>{{if ($value.alias || $data.alias) && ($value.side_alias || $data.side_alias)}}<span class=\"alias-value i-ljuser-alias\">{{html ($value.user_alias || $data.user_alias)}}</span>{{/if}}</span>{{/if}} {{/if}}{{else}}{{html LJ.mltext(\'talk.anonuser\')}}{{/if}}{{if !(($index ===  ljusers.length - 1))}},&nbsp;{{/if}}{{/each}}{{if ($value.moreusers || $data.moreusers)}}&hellip;{{/if}}</span> {{/if}} {{/if}} <span class=\"b-leaf-seemore-expand\"> <a href=\"{{if ($value.href || $data.href)}}{{html ($value.href || $data.href)}}{{else}}#{{/if}}\" rel=\"nofollow\" class=\"b-pseudo\" >{{html LJ.mltext(\'talk.expandlink\')}}</a> </span> {{/each}} </div> </div> {{else}} {{if $data.deleted || !$data.shown}} <div class=\" b-leaf b-leaf-clipped b-leaf-{{html $data.leafclass}} \" {{if !($data.noid)}} id=\"t{{html $data.dtalkid}}\" {{/if}} > <div class=\" b-leaf-inner svgpreloader svgpreloader-pseudo svgpreloader-16 \"> <div class=\"b-leaf-cheader\"> <p class=\"b-leaf-status\"> {{if $data.leafclass == \'deleted\'}} {{html LJ.mltext(\'talk.deletedpost\')}} {{else $data.leafclass == \'screened\'}} {{html LJ.mltext(\'talk.screenedpost\')}} {{else $data.leafclass == \'spammed\'}} {{html LJ.mltext(\'talk.spammedpost\')}} {{else $data.leafclass == \'suspended\'}} {{html LJ.mltext(\'talk.suspendedpost\')}} {{/if}} </p> {{if $data.controls}} <ul class=\"b-leaf-controls\"> {{each ($value.controls || $data.controls)}} {{if ($value.allowed || $data.allowed)}} {{if !($value.nocontrols || $data.nocontrols) || ($value.name || $data.name) == \'cancel_best\'}} <li class=\"b-leaf-controls-item b-leaf-controls-item-{{html ($value.name || $data.name)}}\"><a class=\" b-controls b-controls-{{html ($value.name || $data.name)}} \" title=\"{{html ($value.title || $data.title)}}\" href=\"{{if ($value.href || $data.href)}}{{html ($value.href || $data.href)}}{{else}}#{{/if}}\" rel=\"nofollow\" ><i class=\"b-controls-bg\"></i>{{html ($value.title || $data.title)}}</a></li> {{/if}} {{/if}} {{/each}} </ul> {{/if}} {{if $data.actions}} <ul class=\"b-leaf-actions\"> {{each ($value.actions || $data.actions)}} {{if !(($value.footer || $data.footer))}} {{if ($value.name || $data.name) != \'permalink\'}} {{if !($value.noid || $data.noid) || ($value.name || $data.name) != \'collapse\'}} {{if ($value.allowed || $data.allowed)}} {{if !($value.checkbox || $data.checkbox) || ($value.massactions || $data.massactions)}} <li class=\" b-leaf-actions-item b-leaf-actions-{{if ($value.checkbox || $data.checkbox)}}check{{else}}{{html ($value.name || $data.name)}}{{/if}} {{if ($value.noid || $data.noid) && ($value.name || $data.name) == \'reply\'}} b-leaf-actions-noid {{/if}} {{if ($value.active || $data.active)}} active {{/if}} \" data-tid=\"t{{html ($value.dtalkid || $data.dtalkid)}}\" > {{if ($value.disabled || $data.disabled)}} {{html ($value.title || $data.title)}} {{else}} {{if ($value.checkbox || $data.checkbox)}} <input type=\"checkbox\" id=\"c{{html ($value.dtalkid || $data.dtalkid)}}\" name=\"selected_{{html ($value.talkid || $data.talkid)}}\" class=\"b-leaf-actions-checkbox\" autocomplete=\"off\" > <label for=\"c{{html ($value.dtalkid || $data.dtalkid)}}\" class=\"b-leaf-actions-label\" > {{html ($value.title || $data.title)}} </label> {{else}} <a href=\"{{if ($value.href || $data.href)}}{{html ($value.href || $data.href)}}{{else}}#{{/if}}\" rel=\"nofollow\" {{if ($value.name || $data.name) != \'permalink\'}} class=\"b-pseudo\" {{/if}} >{{html ($value.title || $data.title)}}</a>{{if ($value.ljusers || $data.ljusers)}}&nbsp;{{html ($value.ljusers || $data.ljusers)}}{{if ($value.moreusers || $data.moreusers)}}, &ellipsis;{{/if}}{{/if}} {{/if}} {{/if}} </li> {{/if}} {{/if}} {{/if}} {{/if}} {{/if}} {{/each}} </ul> {{/if}} </div> <div class=\"b-leaf-footer\"> {{if $data.actions}} <ul class=\"b-leaf-actions\"> {{each ($value.actions || $data.actions)}} {{if ($value.footer || $data.footer)}} {{if ($value.name || $data.name) != \'permalink\'}} {{if !($value.noid || $data.noid) || ($value.name || $data.name) != \'collapse\'}} {{if ($value.allowed || $data.allowed)}} {{if !($value.checkbox || $data.checkbox) || ($value.massactions || $data.massactions)}} <li class=\" b-leaf-actions-item b-leaf-actions-{{if ($value.checkbox || $data.checkbox)}}check{{else}}{{html ($value.name || $data.name)}}{{/if}} {{if ($value.noid || $data.noid) && ($value.name || $data.name) == \'reply\'}} b-leaf-actions-noid {{/if}} {{if ($value.active || $data.active)}} active {{/if}} \" data-tid=\"t{{html ($value.dtalkid || $data.dtalkid)}}\" > {{if ($value.disabled || $data.disabled)}} {{html ($value.title || $data.title)}} {{else}} {{if ($value.checkbox || $data.checkbox)}} <input type=\"checkbox\" id=\"c{{html ($value.dtalkid || $data.dtalkid)}}\" name=\"selected_{{html ($value.talkid || $data.talkid)}}\" class=\"b-leaf-actions-checkbox\" autocomplete=\"off\" > <label for=\"c{{html ($value.dtalkid || $data.dtalkid)}}\" class=\"b-leaf-actions-label\" > {{html ($value.title || $data.title)}} </label> {{else}} <a href=\"{{if ($value.href || $data.href)}}{{html ($value.href || $data.href)}}{{else}}#{{/if}}\" rel=\"nofollow\" {{if ($value.name || $data.name) != \'permalink\'}} class=\"b-pseudo\" {{/if}} >{{html ($value.title || $data.title)}}</a>{{if ($value.ljusers || $data.ljusers)}}&nbsp;{{html ($value.ljusers || $data.ljusers)}}{{if ($value.moreusers || $data.moreusers)}}, &ellipsis;{{/if}}{{/if}} {{/if}} {{/if}} </li> {{/if}} {{/if}} {{/if}} {{/if}} {{/if}} {{/each}} </ul> {{/if}} </div> </div> </div> {{else}} <div {{if !($data.noid)}} id=\"t{{html $data.dtalkid}}\" {{/if}} class=\" b-leaf {{if $data.leafclass}} b-leaf-{{html $data.leafclass}} {{/if}} {{if $data.suspended}} b-leaf-suspended {{/if}} {{if $data.tracked}} b-leaf-tracked {{/if}} {{if $data.subclass}} b-leaf-{{html $data.subclass}} {{/if}} {{if $data.p_tracked}} b-leaf-tracked-parent {{/if}} {{if $data.modereply}} b-leaf-modereply {{/if}} {{if $data.uname == $data.poster}} b-leaf-poster {{/if}} {{if $data.subject}} b-leaf-withsubject {{/if}} {{if $data.is_best}} b-leaf-best {{/if}} {{if $data.is_promo}} b-leaf-promo {{/if}} comment p-comment \" data-username=\"{{html $data.uname}}\" data-displayname=\"{{html $data.dname}}\" data-updated-ts=\"{{html $data.ctime_ts}}\" {{if $data.loaded}} data-full=\"1\" {{/if}} {{if $data.subject}} data-subject=\"{{html $data.subject}}\" {{/if}} > <div class=\" b-leaf-inner svgpreloader svgpreloader-pseudo svgpreloader-16 \"> <div class=\"b-leaf-header\"> <div class=\"b-leaf-userpic\"> <a href=\"{{html $data.commenter_journal_base}}\" target=\"_blank\" class=\"b-leaf-userpic-inner\"> {{if $data.userpic}} <img src=\"{{html $data.userpic}}\" alt=\"\" {{if $data.upictitle}} title=\"{{html $data.upictitle}}\" {{/if}} > {{else}} <img src=\"{{html $data.statprefix}}{{if $data.username}}/img/userpics/userpic-user.png?v=15821{{else}}/img/userpics/userpic-anonymous.png?v=15821{{/if}}\" alt=\"\" > {{/if}} </a> </div> <div class=\"b-leaf-details\"> {{if $data.shown}} {{if $data.subject}} <h4 class=\"b-leaf-subject\"><a href=\"{{html $data.thread_url}}\" class=\"b-leaf-subject-link\" >{{html $data.subject}}</a></h4> {{/if}} <p class=\"b-leaf-username\">{{if $data.is_best}}<span class=\" b-leaf-badge b-leaf-badge-best \" >{{html LJ.mltext(\'talk.comment.best\')}}</span>{{/if}}{{if $data.is_promo}}<span class=\" b-leaf-badge b-leaf-badge-promo \" >{{html LJ.mltext(\'talk.comment.promo\')}}</span>{{/if}}<span class=\"b-leaf-username-name\">{{if $data.username}}{{if $data.deleted_poster}}{{html $data.deleted_poster}}{{else}}{{each ($value.username || $data.username)}}{{if ($value.legacy || $data.legacy)}}{{html ($value.ljuser || $data.ljuser)}}{{else}}{{if ($value.amp || $data.amp)}} <span class=\"ljuser {{if !(($value.inline_css || $data.inline_css))}} i-ljuser {{if ($value.striked || $data.striked)}} i-ljuser-deleted {{/if}} i-ljuser-type-{{html ($value.journaltype || $data.journaltype)}} {{/if}} {{if ($value.noctxpopup || $data.noctxpopup)}} noctxpopup i-ljuser-nopopup {{/if}} {{if ($value.alias || $data.alias)}} with-alias i-ljuser-withalias {{/if}} {{if ($value.side_alias || $data.side_alias)}} with-alias-value i-ljuser-showalias {{/if}} \">{{if ($value.show_userhead || $data.show_userhead)}}<a href=\"{{html ($value.profile_url || $data.profile_url)}}\" class=\"i-ljuser-profile\" ><amp-img class=\"i-ljuser-userhead\" src=\"{{html ($value.userhead_url || $data.userhead_url)}}\" width=\"16\" height=\"16\" ></amp-img></a>{{/if}}<a href=\"{{html ($value.journal_url || $data.journal_url)}}\" class=\"i-ljuser-username\" ><b>{{html ($value.journal || $data.journal)}}</b></a></span> {{else}} <span {{if ($value.inline_css || $data.inline_css)}} style=\" white-space:nowrap; {{if ($value.striked || $data.striked)}} text-decoration:line-through; {{/if}} \" {{/if}} class=\"ljuser {{if !(($value.inline_css || $data.inline_css))}} i-ljuser {{if ($value.striked || $data.striked)}} i-ljuser-deleted {{/if}} i-ljuser-type-{{html ($value.journaltype || $data.journaltype)}} {{/if}} {{if ($value.noctxpopup || $data.noctxpopup)}} noctxpopup i-ljuser-nopopup {{/if}} {{if ($value.alias || $data.alias)}} with-alias i-ljuser-withalias {{/if}} {{if ($value.side_alias || $data.side_alias)}} with-alias-value i-ljuser-showalias {{/if}} \" {{html ($value.attrs || $data.attrs)}} data-ljuser=\"{{html ($value.username || $data.username)}}\" lj:user=\"{{html ($value.username || $data.username)}}\" >{{if ($value.show_userhead || $data.show_userhead)}}<a href=\"{{html ($value.profile_url || $data.profile_url)}}\" {{if ($value.target || $data.target)}} target=\"{{html ($value.target || $data.target)}}\" {{/if}} class=\"i-ljuser-profile\" ><img {{if ($value.inline_css || $data.inline_css)}} width=\"16\" height=\"16\" style=\"vertical-align:text-bottom;border:0;padding-right:1px;\" {{else}} class=\"i-ljuser-userhead\" {{/if}} src=\"{{html ($value.userhead_url || $data.userhead_url)}}\" /></a>{{/if}}<a href=\"{{html ($value.journal_url || $data.journal_url)}}\" class=\"i-ljuser-username\" {{if ($value.color || $data.color)}} style=\"color:{{html ($value.color || $data.color)}};\" {{/if}} {{if ($value.target || $data.target)}} target=\"{{html ($value.target || $data.target)}}\" {{/if}} {{if ($value.alias || $data.alias)}} title=\"{{html ($value.user_alias || $data.user_alias)}}\" {{/if}} >{{if ($value.inline_css || $data.inline_css)}}{{if ($value.bold || $data.bold)}}<b>{{/if}}{{html ($value.journal || $data.journal)}}{{if ($value.alias || $data.alias)}}<span class=\"useralias-value\">*</span>{{/if}}{{if ($value.bold || $data.bold)}}</b>{{/if}}{{else}}{{if ($value.bold || $data.bold)}}<b>{{/if}}{{html ($value.journal || $data.journal)}}{{if ($value.bold || $data.bold)}}</b>{{/if}}{{/if}}</a>{{if ($value.alias || $data.alias) && ($value.side_alias || $data.side_alias)}}<span class=\"alias-value i-ljuser-alias\">{{html ($value.user_alias || $data.user_alias)}}</span>{{/if}}</span>{{/if}} {{/if}}{{/each}}{{/if}}{{else}}{{html LJ.mltext(\'talk.anonuser\')}}{{/if}}</span> {{if $data.ipaddr}} <span class=\"b-leaf-ipaddr\">{{html $data.ipaddr}}</span> {{/if}} </p> <p class=\"b-leaf-meta\"> {{if $data.ctime}} <a href=\"{{html $data.thread_url}}\" class=\"b-leaf-permalink\" > <span class=\"b-leaf-createdtime\">{{html $data.ctime}}</span> </a> {{/if}} {{if $data.stime}} <span class=\"b-leaf-shorttime\">{{html $data.stime}}</span> {{/if}} {{if $data.etime}} <span class=\"b-leaf-editedtime\">{{html LJ.mltext(\'talk.edited\')}}&nbsp;{{html $data.etime}}</span> {{/if}} </p> {{if $data.actions}} <ul class=\"b-leaf-actions\"> {{each ($value.actions || $data.actions)}} {{if !(($value.footer || $data.footer))}} {{if ($value.name || $data.name) != \'permalink\'}} {{if !($value.noid || $data.noid) || ($value.name || $data.name) != \'collapse\'}} {{if ($value.allowed || $data.allowed)}} {{if !($value.checkbox || $data.checkbox) || ($value.massactions || $data.massactions)}} <li class=\" b-leaf-actions-item b-leaf-actions-{{if ($value.checkbox || $data.checkbox)}}check{{else}}{{html ($value.name || $data.name)}}{{/if}} {{if ($value.noid || $data.noid) && ($value.name || $data.name) == \'reply\'}} b-leaf-actions-noid {{/if}} {{if ($value.active || $data.active)}} active {{/if}} \" data-tid=\"t{{html ($value.dtalkid || $data.dtalkid)}}\" > {{if ($value.disabled || $data.disabled)}} {{html ($value.title || $data.title)}} {{else}} {{if ($value.checkbox || $data.checkbox)}} <input type=\"checkbox\" id=\"c{{html ($value.dtalkid || $data.dtalkid)}}\" name=\"selected_{{html ($value.talkid || $data.talkid)}}\" class=\"b-leaf-actions-checkbox\" autocomplete=\"off\" > <label for=\"c{{html ($value.dtalkid || $data.dtalkid)}}\" class=\"b-leaf-actions-label\" > {{html ($value.title || $data.title)}} </label> {{else}} <a href=\"{{if ($value.href || $data.href)}}{{html ($value.href || $data.href)}}{{else}}#{{/if}}\" rel=\"nofollow\" {{if ($value.name || $data.name) != \'permalink\'}} class=\"b-pseudo\" {{/if}} >{{html ($value.title || $data.title)}}</a>{{if ($value.ljusers || $data.ljusers)}}&nbsp;{{html ($value.ljusers || $data.ljusers)}}{{if ($value.moreusers || $data.moreusers)}}, &ellipsis;{{/if}}{{/if}} {{/if}} {{/if}} </li> {{/if}} {{/if}} {{/if}} {{/if}} {{/if}} {{/each}} <li class=\"b-leaf-actions-item b-leaf-actions-new\"><span class=\"b-thisisnew\">{{html LJ.mltext(\'talk.new\')}}</span></li> </ul> {{/if}} {{/if}} {{if $data.loaded}} {{if $data.controls}} <ul class=\"b-leaf-controls\"> {{each ($value.controls || $data.controls)}} {{if ($value.allowed || $data.allowed)}} {{if !($value.nocontrols || $data.nocontrols) || ($value.name || $data.name) == \'cancel_best\'}} <li class=\"b-leaf-controls-item b-leaf-controls-item-{{html ($value.name || $data.name)}}\"><a class=\" b-controls b-controls-{{html ($value.name || $data.name)}} \" title=\"{{html ($value.title || $data.title)}}\" href=\"{{if ($value.href || $data.href)}}{{html ($value.href || $data.href)}}{{else}}#{{/if}}\" rel=\"nofollow\" ><i class=\"b-controls-bg\"></i>{{html ($value.title || $data.title)}}</a></li> {{/if}} {{/if}} {{/each}} </ul> {{/if}} {{/if}} </div> </div> {{if $data.article}} <div class=\"b-leaf-article\"> {{html $data.article}} </div> {{/if}} <div class=\"b-leaf-footer\"> {{if $data.actions}} <ul class=\"b-leaf-actions\"> {{each ($value.actions || $data.actions)}} {{if ($value.footer || $data.footer)}} {{if ($value.name || $data.name) != \'permalink\'}} {{if !($value.noid || $data.noid) || ($value.name || $data.name) != \'collapse\'}} {{if ($value.allowed || $data.allowed)}} {{if !($value.checkbox || $data.checkbox) || ($value.massactions || $data.massactions)}} <li class=\" b-leaf-actions-item b-leaf-actions-{{if ($value.checkbox || $data.checkbox)}}check{{else}}{{html ($value.name || $data.name)}}{{/if}} {{if ($value.noid || $data.noid) && ($value.name || $data.name) == \'reply\'}} b-leaf-actions-noid {{/if}} {{if ($value.active || $data.active)}} active {{/if}} \" data-tid=\"t{{html ($value.dtalkid || $data.dtalkid)}}\" > {{if ($value.disabled || $data.disabled)}} {{html ($value.title || $data.title)}} {{else}} {{if ($value.checkbox || $data.checkbox)}} <input type=\"checkbox\" id=\"c{{html ($value.dtalkid || $data.dtalkid)}}\" name=\"selected_{{html ($value.talkid || $data.talkid)}}\" class=\"b-leaf-actions-checkbox\" autocomplete=\"off\" > <label for=\"c{{html ($value.dtalkid || $data.dtalkid)}}\" class=\"b-leaf-actions-label\" > {{html ($value.title || $data.title)}} </label> {{else}} <a href=\"{{if ($value.href || $data.href)}}{{html ($value.href || $data.href)}}{{else}}#{{/if}}\" rel=\"nofollow\" {{if ($value.name || $data.name) != \'permalink\'}} class=\"b-pseudo\" {{/if}} >{{html ($value.title || $data.title)}}</a>{{if ($value.ljusers || $data.ljusers)}}&nbsp;{{html ($value.ljusers || $data.ljusers)}}{{if ($value.moreusers || $data.moreusers)}}, &ellipsis;{{/if}}{{/if}} {{/if}} {{/if}} </li> {{/if}} {{/if}} {{/if}} {{/if}} {{/if}} {{/each}} <li class=\"b-leaf-actions-item b-leaf-actions-new\"> <span class=\"b-thisisnew\">{{html LJ.mltext(\'talk.new\')}}</span> </li> </ul> {{/if}} </div> </div> </div> {{/if}} {{/if}} {{/if}} </div> ", 'JQuery.stat');
LJ.UI.registerTemplate('templates-Widgets-promocomment', "<div class=\"promocomment\"> {{if $data.promoAllowed}} <p class=\"promocomment-desc\">{{html LJ.mltext(\'talk.promo.place.desc\')}}<a href=\"{{html $data.siteroot}}/support/faq/424.html\" target=\"_blank\"><svg style=\"pointer-events: none; visibility: hidden;\" class=\"svgicon flaticon flaticon--helpicon\"><use xlink:href=\"#flaticon--helpicon\"/></svg></a></p> <p class=\"promocomment-buttons\"> <button type=\"button\" class=\" b-flatbutton b-flatbutton-simple promocomment-submit \" >{{html LJ.mltext(\'talk.promo.place.button\', \'tokens\', $data.tokens)}}</button> </p> {{else}} <p class=\"promocomment-desc\">{{html LJ.mltext(\'talk.promo.notokens.desc\', \'tokens\', $data.tokens)}}<a href=\"{{html $data.siteroot}}/support/faq/424.html\" target=\"_blank\"><svg style=\"pointer-events: none; visibility: hidden;\" class=\"svgicon flaticon flaticon--helpicon\"><use xlink:href=\"#flaticon--helpicon\"/></svg></a></p> <p class=\"promocomment-buttons\"> <a href=\"{{html $data.siteroot}}/shop/tokens.bml\" target=\"_blank\" class=\" b-flatbutton b-flatbutton-simple \" >{{html LJ.mltext(\'talk.promo.notokens.button\')}}</a> <small class=\"promocomment-small\">{{html LJ.mltext(\'talk.promo.notokens.window\')}}</small> </p> {{/if}} <button type=\"button\" class=\"promocomment-update\" title=\"{{html LJ.mltext(\'talk.promo.refresh\')}}\" >{{html LJ.mltext(\'talk.promo.refresh\')}}</button> </div> ", 'JQuery.stat');
LJ.UI.registerTemplate('templates-Comments-v6-Comment', "<div class=\" mdspost-thread {{if $data.level}} mdspost-thread--level-{{html $data.level}} mdspost-thread--leveldeep-{{html $data.deepLevel}} {{/if}} \" style=\"margin-left: {{html $data.margin}}px\" data-tid=\"t{{html $data.dtalkid}}\" > {{if $data.html}} {{html $data.html}} {{else}} {{if $data.more}} <article class=\" mdspost-comment mdspost-comment--seemore {{if $data.moreclass}} mdspost-comment--{{html $data.moreclass}} {{/if}} \" data-parent=\"{{html $data.parent}}\" data-dtalkids=\"{{html $data.data}}\" data-updated-ts=\"{{html $data.touched}}\" data-count=\"{{html $data.more}}\" > <div class=\" mdspost-comment__inner svgpreloader svgpreloader-pseudo svgpreloader-16 \" >{{each ($value.actions || $data.actions)}}<a href=\"{{if ($value.href || $data.href)}}{{html ($value.href || $data.href)}}{{else}}javascript:void(0){{/if}}\" rel=\"nofollow\" class=\"mdspost-comment-seemore__more\" >{{html ($value.title || $data.title)}}</a>{{if ($value.ljusers || $data.ljusers)}}<span class=\"mdspost-comment-seemore__from\">{{html LJ.mltext(\'talk.from\')}}</span><span class=\"mdspost-comment-seemore__users\">{{each ($value.ljusers || $data.ljusers)}}<span class=\"mdspost-comment-seemore__user\">{{if ($value.anonymous || $data.anonymous)}}{{html LJ.mltext(\'talk.anonuser\')}}{{else}}{{if ($value.legacy || $data.legacy)}}{{html ($value.ljuser || $data.ljuser)}}{{else}}{{if ($value.amp || $data.amp)}} <span class=\"ljuser {{if !(($value.inline_css || $data.inline_css))}} i-ljuser {{if ($value.striked || $data.striked)}} i-ljuser-deleted {{/if}} i-ljuser-type-{{html ($value.journaltype || $data.journaltype)}} {{/if}} {{if ($value.noctxpopup || $data.noctxpopup)}} noctxpopup i-ljuser-nopopup {{/if}} {{if ($value.alias || $data.alias)}} with-alias i-ljuser-withalias {{/if}} {{if ($value.side_alias || $data.side_alias)}} with-alias-value i-ljuser-showalias {{/if}} \">{{if ($value.show_userhead || $data.show_userhead)}}<a href=\"{{html ($value.profile_url || $data.profile_url)}}\" class=\"i-ljuser-profile\" ><amp-img class=\"i-ljuser-userhead\" src=\"{{html ($value.userhead_url || $data.userhead_url)}}\" width=\"16\" height=\"16\" ></amp-img></a>{{/if}}<a href=\"{{html ($value.journal_url || $data.journal_url)}}\" class=\"i-ljuser-username\" ><b>{{html ($value.journal || $data.journal)}}</b></a></span> {{else}} <span {{if ($value.inline_css || $data.inline_css)}} style=\" white-space:nowrap; {{if ($value.striked || $data.striked)}} text-decoration:line-through; {{/if}} \" {{/if}} class=\"ljuser {{if !(($value.inline_css || $data.inline_css))}} i-ljuser {{if ($value.striked || $data.striked)}} i-ljuser-deleted {{/if}} i-ljuser-type-{{html ($value.journaltype || $data.journaltype)}} {{/if}} {{if ($value.noctxpopup || $data.noctxpopup)}} noctxpopup i-ljuser-nopopup {{/if}} {{if ($value.alias || $data.alias)}} with-alias i-ljuser-withalias {{/if}} {{if ($value.side_alias || $data.side_alias)}} with-alias-value i-ljuser-showalias {{/if}} \" {{html ($value.attrs || $data.attrs)}} data-ljuser=\"{{html ($value.username || $data.username)}}\" lj:user=\"{{html ($value.username || $data.username)}}\" >{{if ($value.show_userhead || $data.show_userhead)}}<a href=\"{{html ($value.profile_url || $data.profile_url)}}\" {{if ($value.target || $data.target)}} target=\"{{html ($value.target || $data.target)}}\" {{/if}} class=\"i-ljuser-profile\" ><img {{if ($value.inline_css || $data.inline_css)}} width=\"16\" height=\"16\" style=\"vertical-align:text-bottom;border:0;padding-right:1px;\" {{else}} class=\"i-ljuser-userhead\" {{/if}} src=\"{{html ($value.userhead_url || $data.userhead_url)}}\" /></a>{{/if}}<a href=\"{{html ($value.journal_url || $data.journal_url)}}\" class=\"i-ljuser-username\" {{if ($value.color || $data.color)}} style=\"color:{{html ($value.color || $data.color)}};\" {{/if}} {{if ($value.target || $data.target)}} target=\"{{html ($value.target || $data.target)}}\" {{/if}} {{if ($value.alias || $data.alias)}} title=\"{{html ($value.user_alias || $data.user_alias)}}\" {{/if}} >{{if ($value.inline_css || $data.inline_css)}}{{if ($value.bold || $data.bold)}}<b>{{/if}}{{html ($value.journal || $data.journal)}}{{if ($value.alias || $data.alias)}}<span class=\"useralias-value\">*</span>{{/if}}{{if ($value.bold || $data.bold)}}</b>{{/if}}{{else}}{{if ($value.bold || $data.bold)}}<b>{{/if}}{{html ($value.journal || $data.journal)}}{{if ($value.bold || $data.bold)}}</b>{{/if}}{{/if}}</a>{{if ($value.alias || $data.alias) && ($value.side_alias || $data.side_alias)}}<span class=\"alias-value i-ljuser-alias\">{{html ($value.user_alias || $data.user_alias)}}</span>{{/if}}</span>{{/if}} {{/if}}{{/if}}</span>{{/each}}{{if ($value.moreusers || $data.moreusers)}}&hellip;{{/if}}</span>{{/if}}{{/each}}</div> </article> {{else}} {{if $data.deleted || !$data.shown}} <article {{if !($data.noid)}} id=\"t{{html $data.dtalkid}}\" {{/if}} class=\" mdspost-comment mdspost-comment--clipped {{if $data.leafclass}} mdspost-comment--{{html $data.leafclass}} {{/if}} \" > <div class=\"mdspost-comment__inner\"> <header class=\"mdspost-comment__header\"><div class=\"mdspost-comment-status\">{{if $data.leafclass == \'deleted\'}}{{html LJ.mltext(\'talk.deletedpost\')}}{{else $data.leafclass == \'screened\'}}{{html LJ.mltext(\'talk.screenedpost\')}}{{else $data.leafclass == \'spammed\'}}{{html LJ.mltext(\'talk.spammedpost\')}}{{else $data.leafclass == \'suspended\'}}{{html LJ.mltext(\'talk.suspendedpost\')}}{{/if}}</header> {{if $data.actions}} <footer class=\"mdspost-comment__footer\"> <ul class=\"mdspost-comment-actions\">{{each ($value.actions || $data.actions)}}{{if ($value.name || $data.name) != \'permalink\'}}{{if !($value.noid || $data.noid) || ($value.name || $data.name) != \'collapse\'}}{{if ($value.allowed || $data.allowed)}}{{if !($value.checkbox || $data.checkbox) || ($value.massactions || $data.massactions)}}<li class=\" mdspost-comment-actions__item mdspost-comment-actions__item--{{if ($value.checkbox || $data.checkbox)}}check{{else}}{{html ($value.name || $data.name)}}{{/if}} {{if ($value.noid || $data.noid) && ($value.name || $data.name) == \'reply\'}} mdspost-comment-actions__item--noid {{/if}} {{if ($value.active || $data.active)}} mdspost-comment-actions__item--active {{/if}} \" data-tid=\"t{{html ($value.dtalkid || $data.dtalkid)}}\" >{{if ($value.disabled || $data.disabled)}}{{html ($value.title || $data.title)}}{{else}}{{if ($value.checkbox || $data.checkbox)}}<input type=\"checkbox\" id=\"c{{html ($value.dtalkid || $data.dtalkid)}}\" name=\"selected_{{html ($value.talkid || $data.talkid)}}\" class=\"mdspost-comment-actions__checkbox js-comment-checkbox\" autocomplete=\"off\" >{{else}}<a href=\"{{if ($value.href || $data.href)}}{{html ($value.href || $data.href)}}{{else}}#{{/if}}\" rel=\"nofollow\" class=\"mdspost-comment-actions__link\" >{{html ($value.title || $data.title)}}</a>{{if ($value.ljusers || $data.ljusers)}}&nbsp;{{html ($value.ljusers || $data.ljusers)}}{{if ($value.moreusers || $data.moreusers)}}, &ellipsis;{{/if}}{{/if}}{{/if}}{{/if}}</li>{{/if}}{{/if}}{{/if}}{{/if}}{{/each}}</ul> </footer> {{/if}} </div> </article> {{else}} <article {{if !($data.noid)}} id=\"t{{html $data.dtalkid}}\" {{/if}} class=\" mdspost-comment {{if $data.leafclass}} mdspost-comment--{{html $data.leafclass}} {{/if}} {{if $data.suspended}} mdspost-comment--suspended {{/if}} {{if $data.tracked}} mdspost-comment--tracked {{/if}} {{if $data.subclass}} mdspost-comment--{{html $data.subclass}} {{/if}} {{if $data.p_tracked}} mdspost-comment--tracked-parent {{/if}} {{if $data.modereply}} mdspost-comment--modereply {{/if}} {{if $data.uname == $data.poster}} mdspost-comment--poster {{/if}} {{if $data.subject}} mdspost-comment--withsubject {{/if}} {{if $data.is_best}} mdspost-comment--best {{/if}} {{if $data.is_promo}} mdspost-comment--promo {{/if}} comment p-comment \" data-username=\"{{html $data.uname}}\" data-displayname=\"{{html $data.dname}}\" data-updated-ts=\"{{html $data.ctime_ts}}\" {{if $data.loaded}} data-full=\"1\" {{/if}} {{if $data.subject}} data-subject=\"{{html $data.subject}}\" {{/if}} ><div class=\"mdspost-comment__inner\"><header class=\"mdspost-comment__header\"><a href=\"{{html $data.commenter_journal_base}}\" target=\"_blank\" class=\"mdspost-comment-userpic\" >{{if $data.userpic}}<span class=\"mdspost-comment-userpic__pic\" style=\"background-image: url({{html $data.userpic}});\" ><img src=\"{{html $data.userpic}}\" alt=\"\" class=\"mdspost-comment-userpic__img\" {{if $data.upictitle}} title=\"{{html $data.upictitle}}\" {{/if}} ></span>{{else}}<span class=\"mdspost-comment-userpic__pic\" style=\"background-image: url({{html $data.statprefix}}{{if $data.username}}/img/userpics/userpic-user.png?v=15821{{else}}/img/userpics/userpic-anonymous.png?v=15821{{/if}});\" ><img src=\"{{html $data.statprefix}}{{if $data.username}}/img/userpics/userpic-user.png?v=15821{{else}}/img/userpics/userpic-anonymous.png?v=15821{{/if}}\" alt=\"\" class=\"mdspost-comment-userpic__img\" ></span>{{/if}}</a><div class=\"mdspost-comment-details\">{{if $data.shown}}<p class=\"mdspost-comment-username\"><span class=\"mdspost-comment-username__name\">{{if $data.username}}{{if $data.deleted_poster}}{{html $data.deleted_poster}}{{else}}{{each ($value.username || $data.username)}}{{if ($value.legacy || $data.legacy)}}{{html ($value.ljuser || $data.ljuser)}}{{else}}{{if ($value.amp || $data.amp)}} <span class=\"ljuser {{if !(($value.inline_css || $data.inline_css))}} i-ljuser {{if ($value.striked || $data.striked)}} i-ljuser-deleted {{/if}} i-ljuser-type-{{html ($value.journaltype || $data.journaltype)}} {{/if}} {{if ($value.noctxpopup || $data.noctxpopup)}} noctxpopup i-ljuser-nopopup {{/if}} {{if ($value.alias || $data.alias)}} with-alias i-ljuser-withalias {{/if}} {{if ($value.side_alias || $data.side_alias)}} with-alias-value i-ljuser-showalias {{/if}} \">{{if ($value.show_userhead || $data.show_userhead)}}<a href=\"{{html ($value.profile_url || $data.profile_url)}}\" class=\"i-ljuser-profile\" ><amp-img class=\"i-ljuser-userhead\" src=\"{{html ($value.userhead_url || $data.userhead_url)}}\" width=\"16\" height=\"16\" ></amp-img></a>{{/if}}<a href=\"{{html ($value.journal_url || $data.journal_url)}}\" class=\"i-ljuser-username\" ><b>{{html ($value.journal || $data.journal)}}</b></a></span> {{else}} <span {{if ($value.inline_css || $data.inline_css)}} style=\" white-space:nowrap; {{if ($value.striked || $data.striked)}} text-decoration:line-through; {{/if}} \" {{/if}} class=\"ljuser {{if !(($value.inline_css || $data.inline_css))}} i-ljuser {{if ($value.striked || $data.striked)}} i-ljuser-deleted {{/if}} i-ljuser-type-{{html ($value.journaltype || $data.journaltype)}} {{/if}} {{if ($value.noctxpopup || $data.noctxpopup)}} noctxpopup i-ljuser-nopopup {{/if}} {{if ($value.alias || $data.alias)}} with-alias i-ljuser-withalias {{/if}} {{if ($value.side_alias || $data.side_alias)}} with-alias-value i-ljuser-showalias {{/if}} \" {{html ($value.attrs || $data.attrs)}} data-ljuser=\"{{html ($value.username || $data.username)}}\" lj:user=\"{{html ($value.username || $data.username)}}\" >{{if ($value.show_userhead || $data.show_userhead)}}<a href=\"{{html ($value.profile_url || $data.profile_url)}}\" {{if ($value.target || $data.target)}} target=\"{{html ($value.target || $data.target)}}\" {{/if}} class=\"i-ljuser-profile\" ><img {{if ($value.inline_css || $data.inline_css)}} width=\"16\" height=\"16\" style=\"vertical-align:text-bottom;border:0;padding-right:1px;\" {{else}} class=\"i-ljuser-userhead\" {{/if}} src=\"{{html ($value.userhead_url || $data.userhead_url)}}\" /></a>{{/if}}<a href=\"{{html ($value.journal_url || $data.journal_url)}}\" class=\"i-ljuser-username\" {{if ($value.color || $data.color)}} style=\"color:{{html ($value.color || $data.color)}};\" {{/if}} {{if ($value.target || $data.target)}} target=\"{{html ($value.target || $data.target)}}\" {{/if}} {{if ($value.alias || $data.alias)}} title=\"{{html ($value.user_alias || $data.user_alias)}}\" {{/if}} >{{if ($value.inline_css || $data.inline_css)}}{{if ($value.bold || $data.bold)}}<b>{{/if}}{{html ($value.journal || $data.journal)}}{{if ($value.alias || $data.alias)}}<span class=\"useralias-value\">*</span>{{/if}}{{if ($value.bold || $data.bold)}}</b>{{/if}}{{else}}{{if ($value.bold || $data.bold)}}<b>{{/if}}{{html ($value.journal || $data.journal)}}{{if ($value.bold || $data.bold)}}</b>{{/if}}{{/if}}</a>{{if ($value.alias || $data.alias) && ($value.side_alias || $data.side_alias)}}<span class=\"alias-value i-ljuser-alias\">{{html ($value.user_alias || $data.user_alias)}}</span>{{/if}}</span>{{/if}} {{/if}}{{/each}}{{/if}}{{else}}{{html LJ.mltext(\'talk.anonuser\')}}{{/if}}</span>{{if $data.ipaddr}}<span class=\"mdspost-comment-username__ipaddr\">{{html $data.ipaddr}}</span>{{/if}}</p><p class=\"mdspost-comment-meta\">{{if $data.ctime}}<a href=\"{{html $data.thread_url}}\" class=\"mdspost-comment-time mdspost-comment-time--ctime\" >{{html $data.ctime}}</a>{{/if}}{{if $data.stime}}<time class=\"mdspost-comment-time mdspost-comment-time--shorttime\">{{html $data.stime}}</time>{{/if}}{{if $data.etime}}<time class=\"mdspost-comment-time mdspost-comment-time--editedtime\">{{html LJ.mltext(\'talk.edited\')}}&nbsp;{{html $data.etime}}</time>{{/if}}</p>{{/if}}{{if $data.loaded}}{{if $data.controls}}<ul class=\"mdspost-comment-controls\">{{each ($value.controls || $data.controls)}}{{if ($value.allowed || $data.allowed)}}{{if !($value.nocontrols || $data.nocontrols) || ($value.name || $data.name) == \'cancel_best\'}}<li class=\" mdspost-comment-controls__item mdspost-comment-controls__item--{{html ($value.name || $data.name)}}\" >{{if ($value.checkbox || $data.checkbox)}}<input type=\"checkbox\" id=\"c{{html ($value.dtalkid || $data.dtalkid)}}\" name=\"selected_{{html ($value.talkid || $data.talkid)}}\" class=\"mdspost-comment-controls__checkbox js-comment-checkbox\" autocomplete=\"off\" >{{else}}<a class=\" mdspost-comment-controls__button mdspost-comment-controls__button--{{html ($value.name || $data.name)}} \" title=\"{{html ($value.title || $data.title)}}\" href=\"{{if ($value.href || $data.href)}}{{html ($value.href || $data.href)}}{{else}}javascript:void(0){{/if}}\" rel=\"nofollow\" >{{if ($value.name || $data.name) == \'delete\'}}<svg class=\"mdspost-comment-controls__svg\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"30\" viewBox=\"0 0 24 30\"><svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" height=\"30\" width=\"24\" version=\"1.1\" viewBox=\"0 0 24 30\" y=\"0\"><path id=\"delete_repost-Shape\" d=\"m-3.6637e-14 10h23.863v-0.5514c0-1.3171-1.336-4.0827-2.983-4.0827h-17.897c-1.6466 0-2.983 2.7656-2.983 4.0827l-3.6637e-14 0.5514zm2.3068 18.178c0.0981 1.002 1.0739 1.822 2.1689 1.822h14.914c1.095 0 2.071-0.82 2.169-1.822l1.441-16.178h-22l1.3068 16.178zm7.2608-2.178h-2.7437l-0.9145-11.056h3.6582v11.056zm4.7654 0v-11.056h3.658l-0.915 11.056h-2.743zm4.667-20.634c0-2.1601-0.861-5.3659-2.794-5.3659h-8.3819c-1.9332 0-2.794 3.2058-2.794 5.3659h13.97zm-11.378 0l0.6904-2.8148 7.1524 0.0155 0.697 2.7993h-8.5398z\"/></svg></svg>{{else ($value.name || $data.name) == \'spam\'}}<svg class=\"mdspost-comment-controls__svg\" xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\"><svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" height=\"30\" width=\"30\" version=\"1.1\" viewBox=\"0 0 30 30\" y=\"0\"><path d=\"m15 30c-8.2843 0-15-6.716-15-15 0-8.2843 6.7157-15 15-15 8.284 0 15 6.7157 15 15 0 8.284-6.716 15-15 15zm0-4c6.075 0 11-4.925 11-11 0-6.0751-4.925-11-11-11-6.0751 0-11 4.9249-11 11 0 6.075 4.9249 11 11 11z\"/><path d=\"m4.5858 7.4142l18.111 18.111 1.414 1.414 2.828-2.828-1.414-1.414-18.111-18.111-1.414-1.4144-2.8284 2.8284 1.4142 1.4142z\"/></svg></svg>{{else ($value.name || $data.name) == \'unspam\'}}<svg class=\"mdspost-comment-controls__svg\" xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\"><svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" height=\"30\" width=\"30\" version=\"1.1\" viewBox=\"0 0 30 30\" y=\"0\"><path d=\"m15 30c-8.2843 0-15-6.716-15-15 0-8.2843 6.7157-15 15-15 8.284 0 15 6.7157 15 15 0 8.284-6.716 15-15 15zm0-4c6.075 0 11-4.925 11-11 0-6.0751-4.925-11-11-11-6.0751 0-11 4.9249-11 11 0 6.075 4.9249 11 11 11z\"/><path d=\"m4.5858 7.4142l18.111 18.111 1.414 1.414 2.828-2.828-1.414-1.414-18.111-18.111-1.414-1.4144-2.8284 2.8284 1.4142 1.4142z\"/><path fill=\"#F73C32\" d=\"m28.981 2.5514c0.581-0.5909 0.572-1.5406-0.018-2.1212-0.591-0.58071-1.541-0.57246-2.122 0.0184l-26.411 26.874c-0.58051 0.591-0.57226 1.54 0.0186 2.121 0.5909 0.581 1.5406 0.573 2.1212-0.018l26.411-26.875v0.0004z\"/></svg></svg>{{else ($value.name || $data.name) == \'freeze\'}}<svg class=\"mdspost-comment-controls__svg\" xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"29\" viewBox=\"0 0 30 29\"><svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" height=\"29\" width=\"30\" version=\"1.1\" viewBox=\"0 0 30 29\" y=\"0\"><path d=\"m20.777 9.9048l-4.872 2.8132v-5.3831l4.978-4.9786c0.419-0.4186 0.419-1.0974 0-1.516-0.418-0.41869-1.097-0.41869-1.516-0.00004l-3.462 3.4625v-3.2308c0-0.59204-0.48-1.072-1.072-1.072s-1.072 0.47996-1.072 1.072v3.2308l-3.463-3.4625c-0.4185-0.41869-1.0973-0.41869-1.5159-0.00004-0.4187 0.41864-0.4187 1.0974 0 1.516l4.9789 4.9786v5.3111l-4.5383-2.62-1.8223-6.8004c-0.1533-0.5719-0.7411-0.9113-1.313-0.7581-0.5719 0.1533-0.9113 0.7411-0.758 1.313l1.2674 4.7299-2.798-1.6154c-0.5127-0.296-1.1683-0.1203-1.4644 0.3924-0.296 0.5127-0.1203 1.1684 0.3924 1.4644l2.7979 1.6152-4.7299 1.268c-0.57186 0.153-0.91124 0.741-0.75801 1.313 0.15324 0.571 0.74107 0.911 1.313 0.758l6.8008-1.823 4.6004 2.656-4.5384 2.62-6.8009-1.822c-0.5719-0.153-1.1597 0.186-1.313 0.758-0.1532 0.572 0.18618 1.16 0.75807 1.313l4.7299 1.267-2.798 1.616c-0.5127 0.296-0.6884 0.951-0.3923 1.464 0.296 0.513 0.9516 0.688 1.4644 0.392l2.7979-1.615-1.2674 4.73c-0.1532 0.572 0.1862 1.16 0.7581 1.313 0.5718 0.153 1.1597-0.186 1.3129-0.758l1.8223-6.801 4.4764-2.584v5.411l-4.9789 4.979c-0.4187 0.419-0.4187 1.097 0 1.516 0.4186 0.419 1.0974 0.419 1.5159 0l3.463-3.462v2.989c0 0.592 0.48 1.072 1.072 1.072s1.072-0.48 1.072-1.072v-2.989l3.462 3.462c0.419 0.419 1.098 0.419 1.516 0 0.419-0.419 0.419-1.097 0-1.516l-4.978-4.979v-5.483l4.81 2.778 1.823 6.8c0.153 0.572 0.741 0.912 1.313 0.758 0.572-0.153 0.911-0.741 0.758-1.313l-1.268-4.729 2.589 1.494c0.513 0.296 1.169 0.121 1.465-0.392s0.12-1.168-0.393-1.464l-2.589-1.495 4.73-1.268c0.572-0.153 0.912-0.741 0.758-1.313-0.153-0.571-0.741-0.911-1.313-0.758l-6.801 1.823-4.748-2.742 4.81-2.777 6.801 1.822c0.572 0.153 1.16-0.186 1.313-0.758s-0.186-1.16-0.758-1.313l-4.73-1.267 2.589-1.4953c0.513-0.296 0.689-0.9516 0.393-1.4644-0.296-0.5127-0.952-0.6884-1.465-0.3924l-2.589 1.4948 1.268-4.7299c0.153-0.5719-0.187-1.1597-0.758-1.3129-0.572-0.1533-1.16 0.1861-1.313 0.758l-1.823 6.8009z\"/></svg></svg>{{else ($value.name || $data.name) == \'unfreeze\'}}<svg class=\"mdspost-comment-controls__svg\" xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\"><svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" height=\"30\" width=\"30\" version=\"1.1\" viewBox=\"0 0 30 30\" y=\"0\"><path d=\"m10.223 9.9048l4.872 2.8132v-5.3831l-4.978-4.9786c-0.419-0.4186-0.419-1.0974 0-1.516 0.418-0.41869 1.097-0.41869 1.516-0.00004l3.462 3.4625v-3.2308c0-0.59204 0.48-1.072 1.072-1.072s1.072 0.47996 1.072 1.072v3.2308l3.463-3.4625c0.419-0.41869 1.097-0.41869 1.516-0.00004 0.419 0.41864 0.419 1.0974 0 1.516l-4.979 4.9786v5.3111l4.538-2.62 1.823-6.8004c0.153-0.5719 0.741-0.9113 1.313-0.7581 0.571 0.1533 0.911 0.7411 0.758 1.313l-1.268 4.7299 2.798-1.6154c0.513-0.296 1.169-0.1203 1.465 0.3924s0.12 1.1684-0.393 1.4644l-2.798 1.6152 4.73 1.268c0.572 0.153 0.911 0.741 0.758 1.313-0.153 0.571-0.741 0.911-1.313 0.758l-6.801-1.823-4.6 2.656 4.538 2.62 6.801-1.822c0.572-0.153 1.16 0.186 1.313 0.758 0.154 0.572-0.186 1.16-0.758 1.313l-4.73 1.267 2.798 1.616c0.513 0.296 0.689 0.951 0.393 1.464s-0.952 0.688-1.465 0.392l-2.798-1.615 1.268 4.73c0.153 0.572-0.186 1.16-0.758 1.313s-1.16-0.186-1.313-0.758l-1.823-6.801-4.476-2.584v5.411l4.979 4.979c0.419 0.419 0.419 1.097 0 1.516s-1.097 0.419-1.516 0l-3.463-3.462v2.989c0 0.592-0.48 1.072-1.072 1.072s-1.072-0.48-1.072-1.072v-2.989l-3.462 3.462c-0.419 0.419-1.098 0.419-1.516 0-0.419-0.419-0.419-1.097 0-1.516l4.978-4.979v-5.483l-4.81 2.778-1.8227 6.8c-0.1532 0.572-0.7411 0.912-1.3129 0.758-0.5719-0.153-0.9113-0.741-0.7581-1.313l1.2674-4.729-2.589 1.494c-0.5128 0.296-1.1684 0.121-1.4644-0.392-0.2961-0.513-0.1204-1.168 0.3923-1.464l2.5891-1.495-4.7299-1.268c-0.5719-0.153-0.9113-0.741-0.7581-1.313 0.1533-0.571 0.7411-0.911 1.313-0.758l6.8009 1.823 4.7484-2.742-4.8104-2.777-6.8008 1.822c-0.5719 0.153-1.1598-0.186-1.313-0.758-0.15324-0.572 0.1861-1.16 0.758-1.313l4.7299-1.267-2.589-1.4953c-0.5127-0.296-0.6884-0.9516-0.3924-1.4644 0.296-0.5127 0.9517-0.6884 1.4644-0.3924l2.5891 1.4948-1.2674-4.7299c-0.1533-0.5719 0.1861-1.1597 0.758-1.3129 0.5719-0.1533 1.1597 0.1861 1.313 0.758l1.8226 6.8009z\"/><path fill=\"#F73C32\" d=\"m29.961 0.43016c-0.59-0.58067-1.54-0.57242-2.121 0.01844l-26.41 26.874c-0.5805 0.591-0.57225 1.54 0.0186 2.121 0.5908 0.581 1.5405 0.573 2.1211-0.018l26.41-26.875c0.581-0.5905 0.572-1.5402-0.019-2.1208v-0.00004z\"/></svg></svg>{{else ($value.name || $data.name) == \'screen\'}}<svg class=\"mdspost-comment-controls__svg\" xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\"><svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" height=\"30\" width=\"30\" version=\"1.1\" viewBox=\"0 0 30 30\" y=\"0\"><path d=\"m29.96 12.991c-0.545-2.315-5.2-4.6524-14.753-4.6524-9.1548 0-13.616 2.3384-14.138 4.6524-0.49708 2.209 1.4287 12.963 14.138 12.963 13.263 0 15.271-10.754 14.753-12.963zm-15.065-1.92c-0.626 0.718-1.019 1.652-1.019 2.688 0 1.035 0.393 1.97 1.019 2.688-2.056-0.11-3.68-1.265-3.68-2.688 0-1.424 1.625-2.579 3.68-2.688zm0.312 12.174c-10.431 0-11.232-8.06-11.975-9.383-0.7421-1.322 2.2338-1.167 5.5889-1.998-0.1713 0.601-0.2671 1.236-0.2671 1.894 0 3.741 2.9792 6.776 6.6532 6.776 3.673 0 6.652-3.035 6.652-6.776 0-0.66-0.102-1.293-0.276-1.897 3.359 0.831 6.599 2 6.599 2s-2.544 9.384-12.975 9.384zm0.282-17.845c6.576 0.6967 9.212 1.4551 9.381 1.5162 0.502 0.1822 1.057-0.0774 1.24-0.5798 0.182-0.5024-0.078-1.0575-0.58-1.2397-0.049-0.0178-5.021-2.0967-10.041-2.0967-5.021 0-9.992 2.0789-10.041 2.0967-0.5026 0.1822-0.7622 0.7373-0.58 1.2397s0.7372 0.762 1.2397 0.5798c0.1686-0.0611 2.8051-1.2065 9.3813-1.5162z\"/><path fill=\"#F73C32\" d=\"m29.981 2.5514c0.581-0.5909 0.572-1.5406-0.018-2.1212-0.591-0.58071-1.541-0.57246-2.122 0.0184l-26.411 26.874c-0.58051 0.591-0.57226 1.54 0.0186 2.121 0.5909 0.581 1.5406 0.573 2.1212-0.018l26.411-26.875v0.0004z\"/></svg></svg>{{else ($value.name || $data.name) == \'unscreen\'}}<svg class=\"mdspost-comment-controls__svg\" xmlns=\"http://www.w3.org/2000/svg\" width=\"29\" height=\"23\" viewBox=\"0 0 29 23\"><svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" height=\"23\" width=\"29\" version=\"1.1\" viewBox=\"0 0 29 23\" y=\"0\"><path d=\"m28.96 9.9905c-0.545-2.3148-5.2-4.6519-14.753-4.6519-9.1548 0-13.616 2.3381-14.138 4.6519-0.49708 2.2095 1.4287 12.964 14.138 12.964 13.263 0 15.271-10.754 14.753-12.964v0.0005zm-15.065-1.92c-0.626 0.7181-1.019 1.6529-1.019 2.6885 0 1.035 0.393 1.97 1.019 2.688-2.056-0.11-3.68-1.265-3.68-2.688 0-1.4236 1.625-2.5791 3.68-2.6885zm0.312 12.174c-10.431 0-11.232-8.06-11.975-9.383-0.7421-1.3225 2.2338-1.1666 5.5889-1.9979-0.1713 0.601-0.2671 1.2359-0.2671 1.8939 0 3.741 2.9792 6.776 6.6532 6.776 3.673 0 6.652-3.035 6.652-6.776 0-0.66-0.102-1.2929-0.276-1.8968 3.359 0.8313 6.599 1.9998 6.599 1.9998s-2.544 9.384-12.975 9.384zm0.282-17.845c6.576 0.6967 9.212 1.4551 9.381 1.5162 0.502 0.1822 1.057-0.0774 1.24-0.5798 0.182-0.5024-0.078-1.0575-0.58-1.2397-0.049-0.0178-5.021-2.0967-10.041-2.0967-5.0207-1.4337e-8 -9.992 2.0789-10.041 2.0967-0.5026 0.1822-0.7622 0.7373-0.58 1.2397s0.7372 0.762 1.2397 0.5798c0.1686-0.0611 2.8051-1.2065 9.3813-1.5162z\"/></svg></svg>{{else ($value.name || $data.name) == \'track\'}}<svg class=\"mdspost-comment-controls__svg\" xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\"><svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" height=\"30\" width=\"30\" version=\"1.1\" viewBox=\"0 0 30 30\" y=\"0\"><path d=\"m12.385 24.568c0.344 4.024 2.124 2.119 4.078 0.163 1.001-1.001 2.115-2.14 3.246-3.303l7.678 7.683 2.613 0.889-0.862-2.641-7.703-7.707c1.437-1.481 2.827-2.91 3.962-4.048 1.461-1.461 2.482-2.893-0.377-3.373-1.471-0.246-3.478-0.186-4.754-0.108l-5.487-5.4903c0.153-1.3626 0.29-3.2732 0.062-4.6279-0.48-2.8599-2.257-2.2292-3.718-0.7679-2.4768 2.4786-6.3304 6.1478-9.1207 8.9411-1.9535 1.955-3.5112 4.126 0.5103 4.47 1.1233 0.096 2.6398-0.033 3.8977-0.189l6.0617 6.065c-0.105 1.238-0.191 2.832-0.087 4.044z\"/></svg></svg>{{else ($value.name || $data.name) == \'untrack\'}}<svg class=\"mdspost-comment-controls__svg\" xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\"><svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" height=\"30\" width=\"30\" version=\"1.1\" viewBox=\"0 0 30 30\" y=\"0\"><path d=\"m13.385 24.568c0.344 4.024 2.124 2.119 4.078 0.163 1.001-1.001 2.115-2.14 3.246-3.303l7.678 7.683 2.613 0.889-0.862-2.641-7.703-7.707c1.437-1.481 2.827-2.91 3.962-4.048 1.461-1.461 2.482-2.893-0.377-3.373-1.471-0.246-3.478-0.186-4.754-0.108l-5.487-5.4903c0.153-1.3626 0.29-3.2732 0.062-4.6279-0.48-2.8599-2.257-2.2292-3.718-0.7679-2.4768 2.4786-6.3304 6.1478-9.1207 8.9411-1.9535 1.955-3.5112 4.126 0.5103 4.47 1.1233 0.096 2.6398-0.033 3.8977-0.189l6.0617 6.065c-0.105 1.238-0.191 2.832-0.087 4.044z\"/><path fill=\"#F73C32\" d=\"m29.981 2.5514c0.581-0.5909 0.572-1.5406-0.018-2.1212-0.591-0.58071-1.541-0.57246-2.122 0.0184l-26.411 26.874c-0.58051 0.591-0.57226 1.54 0.0186 2.121 0.5909 0.581 1.5406 0.573 2.1212-0.018l26.411-26.875v0.0004z\"/></svg></svg>{{else ($value.name || $data.name) == \'edit\'}}<svg class=\"mdspost-comment-controls__svg\" xmlns=\"http://www.w3.org/2000/svg\" width=\"28\" height=\"30\" viewBox=\"0 0 28 30\"><svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" height=\"30\" width=\"28\" version=\"1.1\" viewBox=\"0 0 28 30\" y=\"0\"><path d=\"m10.451-1.7764e-15l17.517 18.681v11.238l-10.571 0.081-17.397-18.552 0.0055967-0.851 1e-7 -1.3202 8.5789-9.1847 0.8903 0.000031 0.9762-0.092131v-1.7764e-15zm-4.9484 12.993l6.8994-6.9702-3.0204-3.2418-6.8928 7.0502 3.0138 3.1618zm12.851 14.444l6.601-0.494 0.526-6.728-7.127 7.222z\"/></svg></svg>{{else ($value.name || $data.name) == \'best\'}}<svg class=\"mdspost-comment-controls__svg\" xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\"><svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" height=\"30\" viewBox=\"0 0 30 30\" width=\"30\" version=\"1.1\" y=\"0\" x=\"0px\" enable-background=\"new 0 0 30 30\"><path d=\"m29.951 11.514c-0.162-0.507-0.559-0.614-1.27-0.614h-9.711s-0.005-0.002-0.007-0.004h0.007s-2.708-8.451-3.001-9.363c-0.219-0.683-0.443-1.033-0.968-1.033s-0.746 0.338-0.968 1.033c-0.303 0.943-3.002 9.363-3.002 9.363h0.004l-0.004 0.004h-9.713c-0.708 0-1.107 0.107-1.27 0.614-0.162 0.506 0.087 0.823 0.671 1.253 0.791 0.583 7.858 5.788 7.858 5.788s-2.708 8.451-3 9.362c-0.219 0.685-0.241 1.1 0.185 1.414 0.426 0.313 0.8 0.171 1.382-0.26 0.792-0.583 7.857-5.788 7.857-5.788s7.067 5.205 7.858 5.788c0.582 0.429 0.959 0.573 1.383 0.26 0.426-0.312 0.403-0.729 0.185-1.414-0.292-0.911-3.003-9.362-3.003-9.362s7.068-5.205 7.859-5.788c0.58-0.43 0.83-0.747 0.668-1.253z\"/></svg></svg>{{else ($value.name || $data.name) == \'cancel_best\'}}<svg class=\"mdspost-comment-controls__svg\" xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\"><svg xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:space=\"preserve\" height=\"30\" viewBox=\"0 0 30 30\" width=\"30\" version=\"1.1\" y=\"0\" x=\"0px\" enable-background=\"new 0 0 30 30\"><path d=\"m29.951 11.514c-0.162-0.507-0.559-0.614-1.27-0.614h-9.711s-0.005-0.002-0.007-0.004h0.007s-2.708-8.451-3.001-9.363c-0.219-0.683-0.443-1.033-0.968-1.033s-0.746 0.338-0.968 1.033c-0.303 0.943-3.002 9.363-3.002 9.363h0.004l-0.004 0.004h-9.713c-0.708 0-1.107 0.107-1.27 0.614-0.162 0.506 0.087 0.823 0.671 1.253 0.791 0.583 7.858 5.788 7.858 5.788s-2.708 8.451-3 9.362c-0.219 0.685-0.241 1.1 0.185 1.414 0.426 0.313 0.8 0.171 1.382-0.26 0.792-0.583 7.857-5.788 7.857-5.788s7.067 5.205 7.858 5.788c0.582 0.429 0.959 0.573 1.383 0.26 0.426-0.312 0.403-0.729 0.185-1.414-0.292-0.911-3.003-9.362-3.003-9.362s7.068-5.205 7.859-5.788c0.58-0.43 0.83-0.747 0.668-1.253z\"/><path d=\"m28.98 2.551c0.581-0.591 0.573-1.541-0.018-2.121-0.592-0.581-1.541-0.572-2.121 0.019l-26.411 26.873c-0.581 0.592-0.572 1.541 0.019 2.122s1.541 0.572 2.121-0.019l26.41-26.874z\" fill=\"#F73C32\"/></svg></svg>{{/if}}</a>{{/if}}</li>{{/if}}{{/if}}{{/each}}</ul>{{/if}}{{/if}}</div></header>{{if $data.article}}<div class=\"mdspost-comment__body\">{{if $data.subject}}<h4 class=\"mdspost-comment__subject\">{{html $data.subject}} </h4>{{/if}}{{html $data.article}}</div>{{/if}}{{if $data.actions}}<footer class=\"mdspost-comment__footer\"><ul class=\" mdspost-comment-actions svgpreloader svgpreloader-pseudo svgpreloader-16 \" >{{each ($value.actions || $data.actions)}}{{if ($value.name || $data.name) != \'permalink\'}}{{if !($value.noid || $data.noid) || ($value.name || $data.name) != \'collapse\'}}{{if ($value.allowed || $data.allowed)}}{{if !($value.checkbox || $data.checkbox) || ($value.massactions || $data.massactions)}}<li class=\" mdspost-comment-actions__item mdspost-comment-actions__item--{{if ($value.checkbox || $data.checkbox)}}check{{else}}{{html ($value.name || $data.name)}}{{/if}} {{if ($value.noid || $data.noid) && ($value.name || $data.name) == \'reply\'}} mdspost-comment-actions__item--noid {{/if}} {{if ($value.active || $data.active)}} mdspost-comment-actions__item--active {{/if}} \" data-tid=\"t{{html ($value.dtalkid || $data.dtalkid)}}\" >{{if ($value.disabled || $data.disabled)}}{{html ($value.title || $data.title)}}{{else}}{{if ($value.checkbox || $data.checkbox)}}<input type=\"checkbox\" id=\"c{{html ($value.dtalkid || $data.dtalkid)}}\" name=\"selected_{{html ($value.talkid || $data.talkid)}}\" class=\"mdspost-comment-actions__checkbox js-comment-checkbox\" autocomplete=\"off\" >{{else}}<a href=\"{{if ($value.href || $data.href)}}{{html ($value.href || $data.href)}}{{else}}#{{/if}}\" rel=\"nofollow\" class=\"mdspost-comment-actions__link\" >{{html ($value.title || $data.title)}}</a>{{if ($value.ljusers || $data.ljusers)}}&nbsp;{{html ($value.ljusers || $data.ljusers)}}{{if ($value.moreusers || $data.moreusers)}}, &ellipsis;{{/if}}{{/if}}{{/if}}{{/if}}</li>{{/if}}{{/if}}{{/if}}{{/if}}{{/each}}</ul></footer>{{/if}}</div></article> {{/if}} {{/if}} {{/if}} </div> ", 'JQuery.stat');
!function(e,t){"use strict";var s=function(){function e(e){var s=l[e];if(s){if(t(e))return!0;i(e)}return!1}function t(e){var t=new Date,s=m[e];return 1e3*d>t-s}function s(){for(var e;r.length>c;)e=r[0],i(e)}function o(t,o){e(t)||(o?(l[t]=o,m[t]=new Date,r.push(t),s()):h._fetchThread(t,function(e){l[t]=e,m[t]=new Date,r.push(t),s()}))}function a(t){return e(t)?l[t]:null}function i(e){l[e]&&(delete l[e],delete m[e],r=r.filter(function(t){return t!==e}))}function n(e,t){h=e}var r=[],l={},m={},d=180,c=10,h=null;return{init:n,add:o,remove:i,get:a,isCached:e}}();e.widget("lj.comments",e.lj.basicWidget,{options:{selectors:{linkCollapse:LJ.Util.isMediusJournal()?".mdspost-comment-actions__item--collapse a":".b-leaf-actions-collapse a",linkExpand:LJ.Util.isMediusJournal()?".mdspost-comment-actions__item--expand a":".b-leaf-actions-expand a",linkExpandChildren:LJ.Util.isMediusJournal()?".mdspost-comment-actions__item--expandchilds a":".b-leaf-actions-expandchilds a",linkPromote:".b-leaf-actions-promote a",linkUnpromote:".b-leaf-actions-cancel_promo a",leafMore:LJ.Util.isMediusJournal()?".mdspost-comment--seemore":".b-leaf-seemore",seeMore:LJ.Util.isMediusJournal()?".mdspost-comment-seemore__more":".b-leaf-seemore-more a, .b-leaf-seemore-expand a",commentDeleted:LJ.Util.isMediusJournal()?".mdspost-comment--deleted":".b-leaf-deleted",leaf:LJ.Util.isMediusJournal()?".mdspost-comment":".b-leaf",leafCollapsed:LJ.Util.isMediusJournal()?".mdspost-comment--collapsed":".b-leaf-collapsed",tree:".b-tree-root",twig:LJ.Util.isMediusJournal()?".mdspost-thread":".b-tree-twig",pager:".b-pager",replyCounter:LJ.Util.isMediusJournal()?".mdspost-comments-controls__count .js-amount":".b-xylem-cell-amount .js-amount",spamCounter:".b-xylem-cell-spam .js-amount",commentsJSON:"#comments_json",title:"title",metaDescription:"meta[name=description]",actionsItem:LJ.Util.isMediusJournal()?".mdspost-comment-actions__item":".b-leaf-actions-item",treeStart:LJ.Util.isMediusJournal()?".mdscomments-list--":".b-tree-"},classNames:{groveLoading:"b-grove-loading",newComment:"b-leaf-new",leafCollapsed:LJ.Util.isMediusJournal()?"mdspost-comment--collapsed":"b-leaf-collapsed",leafCollapsing:"b-leaf-collapsing",leafExpanding:"b-leaf-expanding",leafActive:"b-leaf-commenting",leafShow:"b-leaf-hover",leafClipped:"b-leaf-clipped",leafLevelUp:"b-leaf-seemore-parent",leafMore:"b-leaf-seemore",shortTime:LJ.Util.isMediusJournal()?"mdspost-comment-time--shorttime":"b-leaf-shorttime",seeMoreVertical:"b-leaf-seemore-depth",groveShowOnHover:"b-grove-hover",showSpam:"b-grove-showspam",twigLevel:"b-tree-twig-"},templates:{twig:LJ.Util.isMediusJournal()?'<div class="mdspost-thread mdspost-thread--level-{level} mdspost-thread--leveldeep-{deepLevel}" style="margin-left: {margin}px" data-tid="t{dtalkid}">{html}</div>':'<div class="b-tree-twig b-tree-twig-{level} b-tree-twig-deep-{deepLevel}" style="margin-left: {margin}px" data-tid="t{dtalkid}">{html}</div>',emptyLeaf:'<div class="b-leaf" id="t{dtalkid}"></div>',promoBubble:"templates-Widgets-promocomment",leaf:LJ.Util.isMediusJournal()?"templates-Comments-v6-Comment":"templates-Comments-Twig"}},_create:function(){e.lj.basicWidget.prototype._create.apply(this);var o,a=location.href.match(/(\d+)\.html/),i=this.options.selectors,n=null;this._itemid=a&&a[1],this._remoteBalance=LJ.get("remote.balance"),this._root=this._el("tree"),this._pager=this._el("pager"),this._constructionCache={},this._showSpamPage=this.element.hasClass(this._cl("showSpam")),this.element.removeClass(this._cl("groveShowOnHover")),this._bindControls(),this._pager.commentsPager(),this._pagerWidget=this._pager.first().data("commentsPager"),this._title=e(i.title),this._pageTitle=this._title.text(),this._description=e(i.metaDescription),this._pageDescription=this._description.attr("content"),this._titleMl=LJ.ml("talk.post.subject_page"),this._descriptionMl=LJ.ml("talk.post.meta_desct_page"),this._addPagerData(),this._replycount=LJ.get("replycount")||0,this._spamcount=LJ.get("spamcount")||0,this._bestTid=e(LJ.Util.isMediusJournal()?".mdscomments-list--best .mdspost-thread":".b-tree-best .b-tree-twig").attr("data-tid")||"",this._promoTid=e(".b-tree-promo .b-tree-twig").attr("data-tid")||"",this._promoPrice=Number(e(".b-tree-promo").attr("data-currentprice")),s.init(this,this._pagerWidget),this._on("cachePage",s.add),"undefined"!=typeof LJ.get("comments")&&(this.element.addClass(this._cl("groveLoading")),this._root.css({"min-height":e(t).height()}),this._hideRoot(),this._one("commentsConstructed",function(){this._restoreRoot(),this.element.removeClass(this._cl("groveLoading"))}.bind(this)),this._on("commentsPage",function(){this._root.css({"min-height":e(t).height()}),this._loadPage.apply(this,[].slice.call(arguments)),e(t).scrollTop(this.element.offset().top+this.element.outerHeight()-this.element.height())}.bind(this)),this._on("commentsConstructed",function(){setTimeout(function(){LJ.Event.trigger("social:widgets:parse")},300),this._root.removeAttr("style"),this.hasOwnProperty("_realRoot")&&this._realRoot.removeAttr("style")}.bind(this)),n=LJ.get("comments"),this._pagerWidget&&(o=this._pagerWidget.page(),s.add(o,n)),this._constructComments(n),setTimeout(function(){document.location.hash.length>0&&(document.location.hash=document.location.hash)},0))},_loadPage:function(e){var t,o,a=this,i=!1,n=function(){i=!0},r=function(t){i||(a._one("commentsConstructed",function(){a._restoreRoot(),a.element.removeClass(a._cl("groveLoading"))}),a._hideRoot(),a._off("commentsPage",n),a._constructComments(t),a._fire("commentsPageLoaded",[e]))};return Function.defer(this._one.bind(this,"commentsPage",n)),this._constructionCache={},this._currentPage=e,this._root.empty(),s.isCached(e)?r(s.get(e)):(t=+new Date,o=1500,this.element.addClass(this._cl("groveLoading")),void this._fetchThread(e,function(a){var i=+new Date;o>i-t?setTimeout(r.bind(null,a),o-(i-t)):r(a),s.add(e,a)}))},_bindControls:function(){var t,o,a=this,i=this.options.selectors,n=this.options.classNames;e.lj.basicWidget.prototype._bindControls.apply(this),["Expand","Collapse","ExpandChildren","Promote","Unpromote"].forEach(function(t){var s=i["link"+t],o=t.toLowerCase();"expandchildren"===o&&(o="expand"),a.element.delegate(s,"click",function(t){var s=e(this),n=s.closest(i.leaf);a[o](n.prop("id"),n,s.prop("href"),s.closest(i.actionsItem)[0]),t.preventDefault()})}),o=new LJ.DelayedCall(function(e){e.addClass(n.leafShow)},150),t=new LJ.DelayedCall(this._loadTimestamp.bind(this),150),this.element.delegate(i.leaf,"click",function(){e(this).removeClass(n.newComment)}).delegate(i.seeMore,"click",function(t){var s=e(this).closest(i.leaf),o=s.hasClass(n.leafExpanding)||s.hasClass(n.leafCollapsing);s.hasClass(n.leafLevelUp)||(o||a._loadMore(s),t.preventDefault())}).delegate(i.leaf,"mouseover",function(s){var a=e(this);s.target.className.indexOf&&-1!==s.target.className.indexOf(n.shortTime)&&!s.target.getAttribute("title")&&t.run(a,e(s.target)),a.hasClass(n.leafShow)||o.run(a)}).delegate(i.leaf,"mouseout",function(s){var a=e(this),i=e(s.relatedTarget);t.stop(),0===i.closest(a).length&&(o.stop(),a.removeClass(n.leafShow))}),this.element.bind("expand",function(e,t,s){a.expand(t,null,s)}).bind("collapse",function(e,t,s){a.collapse(t,null,s)}).bind("refreshThread",this._refreshThread.bind(this)).bind("newComment",this._addNewComment.bind(this)).bind("deleteComment",this._deleteComment.bind(this)).bind("removeFromDOM",this._removeFromDOM.bind(this)),this.element.bind("commentsUpdated",function(e,t,s,o){var i=0;"addnew"===s?i=1:("delone"===s||"delmany"===s)&&(i=-o),0!==i&&(a._showSpamPage?a._spamNumberChanged(i):a._commentsNumberChanged(i)),LJ.Event.trigger("entry/fixLinks"),setTimeout(function(){LJ.Event.trigger("social:widgets:parse")},300)}),0===this._el("commentsJSON").length&&setTimeout(this._highlightNewComments.bind(this),100),LJ.Event.on("commentator/submit",function(){a._pagerWidget&&s.remove(a._pagerWidget.page())}),LJ.Event.on("commentsPager/change",a._addPagerData.bind(a))},_addPagerData:function(){var e,t=this._pageTitle,s=this._pageDescription;this._pagerWidget&&(e=this._pagerWidget.page()),e&&1!==e&&(t+=" - "+this._titleMl+" "+e,s+=" - "+this._descriptionMl+" "+e),this._title.text(t),this._description.attr("content",s)},_loadTimestamp:function(t,s){var o={journal:Site.currentJournal,thread:t.attr("id").substr(1)},a=function(e){"ok"===e.status&&s.attr("title",e.stamp)};e.get(LiveJournal.getAjaxUrl("get_thread_timestamp"),o,a,"json")},_highlightNewComments:function(){this._highlightNewLeaves(this.element.find(this.options.selectors.leaf))},_highlightNewLeaves:function(t,s){s=s||this._getPageTimestamp();var o,a=this,i=this.options.classNames.newComment,n=s||0;e.each(t,function(){var e=parseInt(this.getAttribute("data-updated-ts"),10),t=this.getAttribute("data-username"),o=this.className,r=-1!==o.indexOf(a._cl("leafMore"));e>n&&!r&&(n=e),s&&e>s&&(!Site.remoteUser||Site.remoteUser!==t)&&(this.className=o+" "+i,r&&this.setAttribute("data-max-ts",s))}),o=this._getPageTimestamp(),(!s||n>o)&&this._setPageTimestamp(n)},_getPageTimestamp:function(){var e=this._getPageHash(),t=LJ.Storage.getItem(e)||{};return t&&parseInt(t.stamp,10)},_setPageTimestamp:function(e){if(e){var t=this._getPageHash();LJ.Storage.setItem(t,{stamp:e,updated:+new Date})}},_getPageHash:function(){var e=["url="+Site.currentEntry];return e.push("thread="+(LiveJournal.parseGetArgs(location.href).thread||0)),e.push("page="+this._getCurrentPage()),e.join(";")},_getCurrentPage:function(){return 0===this._pager.length?1:this._pager.commentsPager("page")},_addPoster:function(e){e.poster=LJ.get("entry.poster")},_createComment:function(t){var s,o,a,i,n,r,l,m,d=this.options.selectors,c=this.options.templates;return t.parent?(l=this._constructionCache.hasOwnProperty(t.parent)?this._constructionCache[t.parent]:this._root.find("#t"+t.parent),m=e.comments.getThread(l,!0),a=t.level?t.level:e.comments.level(l)+1,r=m[m.length-1].closest(d.twig)):(a=1,r=this._root),n=t.margin||30*(a-1),i=a>=50?50:10*Math.floor(a/10),o={dtalkid:t.dtalkid,level:a,deepLevel:i,margin:n},t.hasOwnProperty("html")?s=e(c.twig.supplant({html:t.html||c.emptyLeaf}).supplant(o)):(t=e.extend({},t,{level:a,deepLevel:i,margin:n}),this._addPoster(t),s=this._tmpl("leaf",t)),r===this._root?r.append(s):s.insertAfter(r),this._constructionCache[t.dtalkid]=s,s},_addNewComment:function(s,o){if(this._showSpamPage||!LiveJournal.parseGetArgs(location.href).thread&&this._getCurrentPage()-o.page!==0||!o.parenttalkid&&LiveJournal.parseGetArgs(location.href).thread)return void(t.location.href=decodeURIComponent(o.result));if(0===e("#t"+o.dtalkid).length){var a=o.parenttalkid&&o.parenttalkid.substr(1)||null;this._createComment({dtalkid:o.dtalkid,parent:a,html:""}),e("#t"+o.dtalkid).empty()}this._refreshThread(null,o.dtalkid,!0,"addnew"),setTimeout(function(){t.location.hash="t"+o.dtalkid},0)},_constructComments:function(e,t){function s(){o._restoreRoot(),r.resetQueue()}var o=this,a=[],i=e.length,n=0,r=LJ.Function.threshold(function(){if(n===i)return o._off("commentsPage",s),o._highlightNewLeaves(a,t),o._fire("commentsConstructed",null,!0),LJ.Event.trigger("entry/fixLinks"),void n++;if(!(n>i)){var l=o._createComment(e[n]).find(o._s("leaf"));a.push(l.get(0)),n++,r()}},25,!0);!function(e){return e}(),t=t||this._getPageTimestamp(),r.batch(20),Function.defer(o._one.bind(o,"commentsPage",s)),r()},_loadMore:function(e){var t=this,s=e.data("parent");e.addClass(this.options.classNames.leafExpanding),this._fetchThread("t"+s,function(s){s.shift(),t._constructComments(s,e.data("max-ts")),e.remove()},null,e.hasClass(this._cl("seeMoreVertical"))?0:2)},_deleteComment:function(t,s,o,a){function i(){var t=0;c.each(function(s){c[s].id&&(r._bestTid===c[s].id&&(c=c.add(e(LJ.Util.isMediusJournal()?".mdscomments-list--best .mdspost-thread .mdspost-comment":".b-tree-best .b-tree-twig .b-leaf"))),r._promoTid===c[s].id&&(c=c.add(e(".b-tree-promo .b-tree-twig .b-leaf"))),t++)}),c.replaceWith(d),r.element.trigger("commentsUpdated",["t"+s,o||a?"delmany":"delone",t]),r._checkSpamPageStatus()}var n=this.options.selectors,r=this,l=function(e){return e.clone().wrap("<div/>").parent().html()},m=this.element.find(n.commentDeleted+":first"),d=m.length&&l(m),c=this.element.find("#t"+s);0===m.length&&this._fetchThread("t"+s,function(t){var o=t.pop(),a=o.hasOwnProperty("html")?e(o.html).filter(n.commentDeleted):r._tmpl("leaf",o).find(n.commentDeleted);if(0===a.length)throw new Error("Comment t"+s+" has not been deleted");d=l(a),i()},!0),o&&(c=c.add(e.comments.getThread(c))),a&&(c=c.add(this.element.find(n.leaf+"[data-username="+a+"]"))),0!==m.length&&i()},_removeFromDOM:function(t,s,o){e.isArray(s)||(s=[s]),s.forEach(function(t){var s="#t"+t,o=e(s);o.length>0&&o.remove()}),this._checkSpamPageStatus(),!this._showSpamPage||"spamcomment"!==o&&"unspam"!==o||(this._spamNumberChanged(-s.length),this._commentsNumberChanged(s.length))},_checkSpamPageStatus:function(){var e,t,s=this.options.selectors,o=s.leaf+":not("+s.commentDeleted+"):first";this._showSpamPage&&0===this.element.find(o).length&&(e=LiveJournal.parseGetArgs(location.href),t=location.href.split("?")[0],delete e.mode,delete e.page,location.href=LiveJournal.constructUrl(t,e).replace(/\?$/,"")+"#comments")},_refreshThread:function(t,s,o,a){var i=this;this._fetchThread("t"+s,function(t){i._applyFetchResults(t,!0,function(){if(!o){var n,r,l,m,d=[];for(l=0,m=t.length;m>l;++l)d.push("t"+t[l].dtalkid);n=" "+d.join(" ")+" ",r=e.comments.getThread(e("#t"+s)).filter(function(){return-1===n.indexOf(" "+this.id+" ")}),r.addClass(i._cl("leafCollapsed")).removeAttr("data-full")}i.element.trigger("commentsUpdated",["t"+s,a])},a),/set_(promo|best)/.test(a)&&i._updateTop(t,function(){i.element.trigger("topUpdated")},a)},o)},_fetchThread:function(t,s,o,a){function i(){m._restoreRoot(),n.abort()}o=o||!1,s=s||e.noop;var n,r,l,m=this,d=t.toString().match(/t(\d+)/),c=d&&d[1],h="thread";c||(h="page",c=t),l={journal:Site.currentJournal,itemid:this._itemid,flat:o?"1":"",skip:a?a:""},r=LiveJournal.parseGetArgs(location.href),l[h]=c,"thread"===h&&(l.expand_all=o?"":"1"),r&&r.style&&"mine"===r.style&&(l.style="mine"),n=e.ajax({url:LiveJournal.getAjaxUrl("get_thread"),data:l,dataType:"json",timeout:7500}).success(function(e){m._off("commentsPage",i),e.hasOwnProperty("comments")&&(m._updateCounters(e),e=e.comments),s(e)}).error(function(e,a){"abort"!==a&&(m._off("commentsPage",i),setTimeout(m._fetchThread.bind(m,t,s,o),7500))}),function(e){return e}(),Function.defer(m._one.bind(m,"commentsPage",i))},_updateCounters:function(e){"replycount"in e&&this._el("replyCounter").html(LJ.ml("talk.replycount",{count:e.replycount})),"spamcount"in e&&this._el("spamCounter").html(LJ.ml("talk.spamcount",{count:e.spamcount}))},_applyFetchResults:function(t,s,o,a){var i=this,n=t.length,r=function(){n--,n||o()};o=o||e.noop,t.forEach(function(t){var s,o,n;t.html?n=e(t.html).filter("div"):(i._addPoster(t),n=i._tmpl("leaf",t).find(i._s("leaf"))),s=n.prop("id"),o=e("#"+s),o.hasClass(i._cl("leafCollapsed"))&&!n.hasClass(i._cl("leafCollapsed"))&&n.addClass(i._cl("leafCollapsed")).data("full",1),"expand"===a&&o.hasClass(i.options.classNames.leafActive)?"expand"===a&&o.removeClass(i._cl("leafExpanding")):o.replaceWith(n),r()})},_commentsNumberChanged:function(t){var s=e(".b-watering").data("commentform");"edit"===s.previousState()?s.syncPreviousState():(this._replycount+=t,this._updateCounters({replycount:this._replycount}))},_spamNumberChanged:function(e){this._spamcount+=e,this._el("spamCounter").html(LJ.ml("talk.spamcount",{count:this._spamcount}))},expand:function(t,s,o){if(s=s||e("#"+t),!s.hasClass(this.options.classNames.leafExpanding)&&!s.hasClass(this.options.classNames.leafCollapsing)){s.addClass(this.options.classNames.leafExpanding);var a=this,i=a.options.classNames.leafCollapsed,n=this.options.selectors,r=e.comments.getThread(s),l=r.filter(n.leafCollapsed),m=function(t){return function(){var s=e(this),o=!!s.data("full");return o===t}},d=function(t){t.filter(a._s("leafMore")).each(function(){var t=e(this),s=+t.data("count");25>s&&a._loadMore(t)})};void 0===o&&(o=e.comments.skipAnimation),!s.data("full")&&s.hasClass(i)||l.filter(m(!1)).length>0?this._fetchThread(t,function(t){a._applyFetchResults(t,!1,function(){var t=e();l.each(function(){t=t.add(e("#"+this.id))}),a._expandNodes(s,s.prop("id"),t.filter(m(!0)),o),d(r)},"expand")}):s.hasClass(i)||l.length>0?(this._expandNodes(s,s.prop("id"),l.filter(m(!0)),o),d(r)):s.removeClass(this.options.classNames.leafExpanding)}},_expandNodes:function(t,s,o,a){var i=this,n=i.options.classNames.leafCollapsed;void 0===a&&(a=e.comments.skipAnimation),t.removeClass(this.options.classNames.leafExpanding),a?o.removeClass(n):o.each(function(){var t,s=e(this),o=s.height();s.hasClass(i.options.classNames.leafActive)||(s.removeClass(n).attr("style",""),t=s.height(),s.css({opacity:0,height:o,overflow:"hidden"}).animate({opacity:1,height:t},{duration:300,complete:function(){s.attr("style","")},queue:!1}))}),this.element.trigger("commentsUpdated",[s,"expand"])},collapse:function(t,s,o){var a,i,n,r,l=this,m=l.options.classNames.leafCollapsed,d=l.options.classNames.leafClipped,c=l.options.classNames.leafCollapsing;s=s||e("#"+t),void 0===o&&(o=e.comments.skipAnimation),s.hasClass(this.options.classNames.leafExpanding)||s.hasClass(c)||(i=this.options.selectors,n=s.closest(i.twig),r=e.comments.getThread(s).filter(":not(."+m+"):not(."+c+"):not(."+d+")"),s.hasClass(m)&&0===r.length||(r.addClass(m),a=n.height(),r.removeClass(m).data("full",!0).attr("style","").addClass(c),o?r.addClass(m).removeClass(c):r.each(function(){var t=e(this),s=t.height();t.css({height:s,overflow:"hidden"}),t.animate({opacity:0,height:a},{duration:300,complete:function(){r.addClass(m).attr("style","").removeClass(c)},queue:!1})}),this.element.trigger("commentsUpdated",[t,"collapse"])))},_promoteApi:function(t,s,o){o=o||e.noop,LJ.Api.call("promo."+s,{"class":"comments",type:"comment",user:LJ.get("currentJournal"),ditemid:this._itemid,price:this._promoPrice,object_url:t},o)},_promoteDone:function(e,t,s){this.element.trigger("refreshThread",[t.slice(1),!0,s]),this._promoPrice=e.current_price},_promoteFail:function(e){alert(e.error.message),location.reload()},promote:function(t,s,o,a){var i,n,r,l,m,d,c=this;r=function(){e(this).addClass("b-flatbutton-loading"),i.addClass("promocomment-loading"),c._promoteApi(o,"promote",function(e){return e.error?void l(e):(c._promoteDone(e,t,"set_promo"),void i.bubble("hide"))})},l=function(){e(this).addClass("promocomment-update-loading"),i.addClass("promocomment-loading"),c._promoteApi(o,"get_slot",function(e){return e.error?void c._promoteFail(e):(n=!0,c._promoPrice=e.comment[0].buyout_cost,c._remoteBalance=e.comment[0].balance,i.bubble("hide"),void d())})},m=function(){s.removeClass("b-leaf-herbarium"),i.closest(".b-popup").remove()},d=function(){var e={promoMessage:n,tokens:c._promoPrice,promoAllowed:c._remoteBalance>c._promoPrice,siteroot:LJ.get("siteroot")},t={target:a};s.addClass("b-leaf-herbarium"),i=c._tmpl("promoBubble",e).delegate(".promocomment-submit","click",r).delegate(".promocomment-update","click",l).bind("bubblehide",m).bubble(t).bubble("show")},setTimeout(d,0)},unpromote:function(e,t,s){var o=this;this._promoteApi(s,"withdraw",function(t){return t.error?void o._promoteFail(t):void o._promoteDone(t,e,"unset_promo")})},_updateTop:function(t,s,o){if(t&&t[0]&&o){var a,i,n,r,l=this,m=o.split("_");if(s=s||e.noop,r=e(l.options.selectors.treeStart+m[1]),i=r.find(l.options.selectors.twig),"unset"===m[0])return l["_"+m[1]+"Tid"]="",i.remove(),void s();if(l["_"+m[1]+"Tid"]="t"+t[0].dtalkid,a=l._tmpl("leaf",e.extend({},t[0],{is_promo:"promo"===m[1],is_best:"best"===m[1],noid:!0,noactions:!0,nocontrols:!0,massactions:!1})),0===i.length)return r.append(a),void s();n=i.attr("data-tid").slice(1),i.replaceWith(a),e("#t"+n).length>0&&l.element.trigger("refreshThread",[n,!0]),s()}},_hideRoot:function(){this.hasOwnProperty("_realRoot")||(this._realRoot=this._root,this._root=e("<div />"))},_restoreRoot:function(){this.hasOwnProperty("_realRoot")&&(this._realRoot.append(this._root.children()),this._root=this._realRoot,delete this._realRoot)}})}(jQuery,window);
/* <<< file end: js/jquery/jquery.lj.comments.js */

//# map link was there [jquery.lj.comments.js.map]
/* >>> file start: js/captcha.js */
!function(e){return e}(),function(e){"use strict";function c(){return"undefined"!=typeof _}function a(){var c=e.Deferred();return"keycaptcha"===LJ.Captcha.current?(c.resolve(),c.promise()):(p?c.resolve(p):LJ.Api.call("captcha.get_public_key",{},function(e){p=e.captcha_public,c.resolve(p)}),c.promise())}function t(){return"solve_media_captcha"===LJ.Captcha.current?"https:"===location.protocol?"https://api-secure.solvemedia.com/papi/challenge.ajax":"http://api.solvemedia.com/papi/challenge.ajax":location.protocol+"//www.google.com/recaptcha/api/js/recaptcha_ajax.js"}function n(t,n){var o=e.Deferred();return n=e.extend(d,n||{}),LJ.Captcha.current?e.when(a(),l()).then(function(){c()?_.create(p,t,n):console.error("Something went wrong. Captcha object is not defined.")}):(o.resolve(),o.promise())}function o(){c()&&_.destroy()}function i(){c()&&_.reload.apply(null,arguments)}function r(){return c()?"keycaptcha"===LJ.Captcha.current?null:_.get_challenge():void 0}function s(){return c()?"keycaptcha"===LJ.Captcha.current?e("#"+window.s_s_c_captcha_field_id).val():_.get_response():void 0}LJ.define("LJ.Captcha"),LJ.Captcha={create:n,reload:i,destroy:o,getChallenge:r,getResponse:s,isDefined:c,responseFieldName:LJ.Flags.isEnabled("solve_media_captcha")?"adcopy_response":"recaptcha_response_field",current:["keycaptcha","solve_media_captcha","recaptcha"].filter(LJ.Flags.isEnabled).shift()};var p,_,d={lang:"ru"},l=LJ.Function.once(function(){var c=e.Deferred();return window.ACPuzzleOptions={onload:function(){_=ACPuzzle,c.resolve()}},"keycaptcha"===LJ.Captcha.current?LJ.Api.call("captcha.get_public_key",{},function(a){var t=LJ.get("page.captcha_field_id")||"capcode";window.s_s_c_user_id=a.user_id,window.s_s_c_session_id=a.session_id,window.s_s_c_captcha_field_id=LJ.get("page.captcha_field_id")||"capcode",window.s_s_c_submit_button_id=LJ.get("page.submitbtn_id")||"createpage_create",window.s_s_c_web_server_sign=a.server_sign,window.s_s_c_web_server_sign2=a.server_sign2,e("#"+t).before('<input type="hidden" name="captcha_type" value='+LJ.Captcha.current+">"),LJ.injectScript(location.protocol+"//backs.keycaptcha.com/swfs/cap.js").then(function(){_={create:function(){},destroy:function(){},reload:function(e){e&&window.s_s_c_onload&&window.s_s_c_onload(e,window.s_s_c_captcha_field_id,window.s_s_c_submit_button_id)}},c.resolve()})}):LJ.injectScript(t()).then(function(){"solve_media_captcha"!==LJ.Captcha.current&&(_=Recaptcha,c.resolve())}),c.promise()})}(jQuery);
/* <<< file end: js/captcha.js */

//# map link was there [captcha.js.map]
/* >>> file start: js/jquery/jquery.lj.commentator.js */
//= require js/captcha.js
!function(e,r){e.widget("lj.commentator",{options:{publicKey:"",ajax:!0,needCaptcha:!1,keyCaptchaLoaded:!1,captchaContainerId:"",selectors:{comments:"#comments",errorWrapper:".b-msgsystem-errorbox",errorBlock:".b-postform-alert-ajax",blockingErrorBlocks:".b-bubble-warning",preloaderElem:".b-postform-preload",controls:":button, :submit",ajaxField:'input[name="json"]',captchaResponse:'input[name="captcha_response"]',captchaType:'input[name="captcha_type"]',previewControl:'input[name="submitpreview"]',inputParentTalkid:"#parenttalkid",submitControl:"button[name=submitpost]",form:"form",captchaBox:".b-postform-captchabox",anonLoginSubmit:".b-watering-authtype-user.b-watering-user-notreg"},classNames:{idle:"b-postform-preload-active",captchaActive:"b-postform-captchabox-active",errorWrapperShow:"b-msgsystem-errorbox-show",replyPage:"b-postform"},templates:{frame:'<iframe class="b-watering-commentator" name="commentator" width="0" height="0" frameborder="0" />'}},_create:function(){function t(e){LJ.Flags.isEnabled("messages_v6")?JSON.parse(e).forEach(LJ.Messages.add.bind(LJ.Messages)):alert(e)}var o=this,a=o.element,s=o.options,n=s.selectors,i=s.classNames;o._isReplyPage=a.hasClass(i.replyPage),o._form=a.find(n.form),e(s.templates.jsonField).prependTo(o._form),e(s.templates.frame).prependTo(document.body),o._errorBlock=a.find(n.errorBlock),o._errorsWrapper=a.find(n.errorWrapper),o._blockingErrorBlocks=a.find(n.blockingErrorBlocks),o._preloaderElem=a.find(n.preloaderElem),o._controls=a.find(n.controls),o._ajaxField=a.find(n.ajaxField),o._captchaResponse=a.find(n.captchaResponse),o._captchaType=a.find(n.captchaType),o._captchaBox=a.find(n.captchaBox),o._inputParentTalkid=a.find(n.inputParentTalkid),o._isCommentFormVisible=o.element.is(":visible"),o._setOptions(s),a.bind("authtypechange",function(e,r){o._setOptions(r),o.toggleCaptcha(r.needCaptcha)}).bind("keydown",function(e){!o._disabled&&13===e.which&&e.ctrlKey&&(o._form.trigger("submit"),e.preventDefault())}),a.bind("commentformopen",function(){o._isCommentFormVisible=!0,o.toggleCaptcha(!0)}).bind("commentformclose",function(){o._errorsWrapper.removeClass(i.errorWrapperShow),o._isCommentFormVisible=!1,o.toggleCaptcha()}).bind("commentformdisable",function(e,r){o._disabled=!!r}),o._controls.on("click",function(e){"submitpreview"===jQuery(e.target).prop("name")&&(o._setOption("ajax",!1),o._form.append('<input type="hidden" name="submitpreview" value="1" />')),o.options.needCaptcha||o._controls.prop("disabled")||(o._form.submit(),e.preventDefault())}),o._form.bind("submit",function(){o._errorsWrapper.removeClass(i.errorWrapperShow),o._preloaderElem.addClass(i.idle),o._controls.prop("disabled",!0),o._captchaResponse.val(LJ.Captcha.getResponse())}),LJ.Event.on("commentator/submit",function(e){switch(o.option("needCaptcha",e.need_captcha),e.status){case"redirect":if(o._isReplyPage||o.element.is(n.anonLoginSubmit))e.hidden&&t(e.message),r.location.href=decodeURIComponent(e.result);else{if(e.hidden&&(setTimeout(function(){t(e.message)},500),!LJ.get("remote")))return;e.parenttalkid=o.element.data("parenttalkid"),o.element.trigger("newComment",e)}break;case"error":if(e.redirect)return void(r.location.href=decodeURIComponent(e.redirect));o.option("error",decodeURIComponent(e.result)),o._errorsWrapper.addClass(i.errorWrapperShow),o._preloaderElem.removeClass(i.idle),o._controls.prop("disabled",!1),o._errorsWrapper.length>0&&jQuery("html, body").scrollTop(o._errorsWrapper.offset().top)}})},_setOption:function(r,t){var o,a=this,s=a.options,n=s.classNames;switch(r){case"error":if(this._errorsWrapper.removeClass(n.errorWrapperShow),this._errorBlock.hide(),t){if(o=a._blockingErrorBlocks.filter(":visible"),o.html()===t)return this._errorBlock.hide(),o.fadeOut("fast",function(){o.fadeIn("fast")}),!0;this._errorBlock.html(t).show()}break;case"needCaptcha":a.options.needCaptcha=Boolean(t),a._captchaBox.toggleClass(n.captchaActive,Boolean(t)),a.toggleCaptcha(t);break;case"ajax":t?(this._ajaxField.val(1),this._form.attr("target","commentator")):(this._ajaxField.val(0),this._form.attr("target","_self"));break;case"authtype":return}e.lj.basicWidget.prototype._setOption.apply(this,arguments)},error:function(){return this._errorsWrapper.addClass(this.options.classNames.errorWrapperShow),this._errorBlock.show(),this},hide:function(){return this._errorBlock.slideUp("fast"),this},toggleCaptcha:function(e){if(e){if(!this.options.needCaptcha||!this._isCommentFormVisible)return;return LJ.Captcha.isDefined()?void LJ.Captcha.reload(this.options.captchaContainerId):void LJ.Captcha.create(this.options.captchaContainerId,{lang:"ru",tabindex:70})}"keycaptcha"!==LJ.Captcha.current&&LJ.Captcha.destroy()}})}(jQuery,this);
/* <<< file end: js/jquery/jquery.lj.commentator.js */

//# map link was there [jquery.lj.commentator.js.map]
/* >>> file start: js/jquery/jquery.lj.authtype.js */
function _typeof(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}!function(e,t){e.widget("lj.authtype",e.lj.basicWidget,{options:{selectControl:{},state:"collapsed",selectedIndex:0,focusedIndex:0,nativeAuthTypes:"cookieuser, livejournal, anonymous",index:0,authType:"livejournal",authTypesControls:{},forceStartupCaptcha:!1,classNames:{expanded:"b-postform-login-services-show",startAuthTypePrefix:"b-postform-trueauth-",authTypePrefix:"b-postform-authtype-",willBeScreened:"b-postform-user-screened",notfriend:"b-postform-user-notafriend",captchaForAnonymous:"b-postform-captcha-anon",captchaForNonFriends:"b-postform-captcha-nonfriend",captchaForAll:"b-postform-captcha-all",notaspammer:"b-postform-notaspammer",activeItem:"b-watering-user-services-active"},selectors:{activeSelectItem:"a[href=#{authType}]",selectControl:".b-postform-login-services",authTypesControls:".b-postform-login-services-items a:not(.b-postform-login-services-disabled, .b-postform-login-invisible)",authInputs:"input.auth-input",authTypeNotInSelect:".b-postform-notselect",authTypesDisabledControls:".b-postform-login-services-disabled",authTypeRadios:'input[id^="{authType}"]',inputForFocus:"input:visible:first",mobileSelect:"#usertype"}},_create:function(){var t=this,s=t.options,o=s.selectors;e.lj.basicWidget.prototype._create.apply(this),s.authInputs=t.element.find(o.authInputs),s.selectControl=t.element.find(o.selectControl),s.authTypesControls=t.element.find(o.authTypesControls),s.commentWillBeScreened=t.element.hasClass(s.classNames.willBeScreened),s.captchaForAll=t.element.hasClass(s.classNames.captchaForAll),s.captchaForNonFriends=t.element.hasClass(s.classNames.captchaForNonFriends),s.captchaForAnonymous=t.element.hasClass(s.classNames.captchaForAnonymous),LJ.Support.isMobile()?this._bindControlsMobile():this._bindControls()},_bindControlsMobile:function(){var t=this,s=t.options;e.lj.basicWidget.prototype._bindControls.apply(this),t._setStartAuthType(t.element[0].className);var o=t.element.find(s.selectors.mobileSelect);t.element.bind("commentformclose",function(e){t._setOption("authType",s.startAuthType)}),o.bind("change",function(e){s.authType!==this.value&&t.authType(this.value)})},_bindControls:function(){var t=this,s=this.options,o=this.options.selectors,a=e.browser.webkit||e.browser.msie?"keydown":"keypress";e.lj.basicWidget.prototype._bindControls.apply(this),t._setStartAuthType(t.element[0].className),t._setActiveSelectItem(),t.element.bind("commentformclose",function(e){t._setOption("authType",s.startAuthType)}).delegate(o.selectControl,"click",function(e){e.preventDefault(),t.toggleState()}).delegate(o.authTypesDisabledControls,"click",function(e){e.preventDefault()}).delegate(o.selectControl,a,function(e){switch(e.keyCode){case 38:e.preventDefault(),t.index("-1");break;case 40:e.preventDefault(),t.index("+1")}return!0}).delegate(o.authTypesControls,"click",function(s){var o=e(this),a=o.attr("href").replace("#","");s.preventDefault(),s.stopPropagation(),"expanded"==t.state()?(t.authType(a),t.state("collapsed"),t.option("activeItem",o)):t.state("expanded")}).delegate(o.authTypeNotInSelect,"click",function(s){var o=e(this),a=o.attr("href").replace("#","");s.preventDefault(),s.stopPropagation(),t.authType(a)}).delegate(o.authTypesControls,"mouseenter",function(e){s.authTypesControls.trigger("blur"),t.option("focusedIndex",-1)}).delegate(":input","focus",function(e){"expanded"==t.state()&&t.state("collapsed")}),e(document).bind("keydown","escape",function(e){t.state("collapsed")}),s.selectControl.bind("click",function(e){t._suppressNextEvent("documentClick")}),this._on("documentClick",function(){t.state("collapsed")})},_setOption:function(e,t){var s,o,a,n,i=this,r=i.options,l=r.selectors,c=r.classNames;switch(e){case"state":"expanded"==t?(r.selectControl.addClass(r.classNames.expanded),this.option("focusedIndex",-1)):r.selectControl.removeClass(r.classNames.expanded);break;case"activeItem":r.activeItem&&r.activeItem.removeClass(c.activeItem),t.addClass(c.activeItem);break;case"authType":s=-1==r.nativeAuthTypes.indexOf(t),r.authInputs.val(""),o=s&&t!==r.startAuthType||"anonymous"==t&&r.commentWillBeScreened,a=!o,n=(r.captchaForAnonymous||r.captchaForNonFriends||r.captchaForAll)&&"anonymous"==t||t===r.startAuthType&&!this.element.hasClass(c.notaspammer)&&(r.captchaForAll&&Site.currentJournal!==Site.remoteUser||r.captchaForNonFriends&&this.element.hasClass(c.notfriend)),r.forceStartupCaptcha&&(n=!0,this._setOption("forceStartupCaptcha",!1)),i.element.removeClass(r.classNames.authTypePrefix+r.authType).addClass(r.classNames.authTypePrefix+t).trigger("authtypechange",{authtype:t,ajax:a,needCaptcha:n,error:!1}).find(l.authTypeRadios.supplant({authType:t})).trigger("click").end().find(l.inputForFocus).trigger("focus"),i._setActiveSelectItem(t)}i.options[e]=t},_setStartAuthType:function(e){var t=this.options,s=RegExp(t.classNames.startAuthTypePrefix+"(\\w+)"),o=e.match(s),a=o[1];this._setOption("startAuthType",a),s=RegExp(t.classNames.authTypePrefix+"(\\w+)"),o=e.match(s),o&&(a=o[1]),this._setOption("authType",a)},_setActiveSelectItem:function(t){for(var s,o=this.options,a=o.authTypesControls,n=t||o.authType,i=o.selectors.activeSelectItem.replace("{authType}",n),r=0,l=a.length;l>r;r++)if(s=e(a[r]),s.filter(i).length)return o.selectedIndex=r,this._setOption("activeItem",s),!0},toggleState:function(){return this.state("expanded"==this.options.state?"collapsed":"expanded"),this},authType:function(e){return"undefined"==typeof e?this.options.authType:(this._setOption("authType",e),this)},state:function(e){return"undefined"==typeof e?this.options.state:(this._setOption("state",e),this)},index:function(e){var t,s,o,a=this,n=a.options,i=n.state,r=n.authTypesControls,l="expanded"==i?n.focusedIndex:n.selectedIndex;return void 0===("undefined"==typeof e?"undefined":_typeof(e))?this.options.index:(e=parseInt(e,10),t=l+e,"collapsed"==i&&(t>=r.length||0>t)?!1:(t>=r.length?t=0:0>t&&(t=r.length-1),s=r.eq(t),void("expanded"==i?(s.trigger("focus"),n.focusedIndex=t):(o=s.attr("href").replace("#",""),a.authType(o)))))}})}(jQuery,this);
/* <<< file end: js/jquery/jquery.lj.authtype.js */

//# map link was there [jquery.lj.authtype.js.map]
/* >>> file start: js/jquery/mixins/cursor.js */
LJ.UI.mixin("cursor",function(n,e){function l(n,e,l){i.locked()||(o(null===u?0:e?n:u+n),l.preventDefault())}function o(n){if(e.items.eq(u).removeClass(e.hoverClass),null!==n){u=e.cyclic?(r+n)%r:0>n?0:n>=r?r-1:n;var l=e.items.eq(u);l.addClass(e.hoverClass);var o=e.container.scrollTop(),t=l.prop("offsetTop"),i=l.outerHeight(),d=e.container.height();t+i>o+d?e.container.scrollTop(t+i-d):o>=t&&e.container.scrollTop(t),e.cursorUpdate(n,l)}else u=null}function t(){var n;i.locked()||null!==u&&(n=e.items.eq(u),e.select(n.data("name"),n),o(null))}e=n.extend({},{target:null,items:null,container:null,cancel:n.noop,cursorUpdate:n.noop,cyclic:!1,hoverClass:"hover",columns:1},e);var i=this,u=null,r=e.items.length;return function(n){return n}(),e.target.bind("keydown","esc",e.cancel).bind("keydown","return",t).bind("keydown","home",l.bind(null,0,!0)).bind("keydown","end",l.bind(null,r-1,!0)),1===e.columns?e.target.bind("keydown","up",l.bind(null,-1,!1)).bind("keydown","down",l.bind(null,1,!1)):e.target.bind("keydown","left",l.bind(null,-1,!1)).bind("keydown","right",l.bind(null,1,!1)).bind("keydown","up",l.bind(null,-e.columns,!1)).bind("keydown","down",l.bind(null,e.columns,!1)),{reset:function(){o(null)},index:function(n){return 0===arguments.length?u:void o(n)},setData:function(n,l){l=void 0===l?null:0,e.items=n,r=e.items.length,o(l)},item:function(n){return e.items.eq(n||u)}}});
/* <<< file end: js/jquery/mixins/cursor.js */

//# map link was there [cursor.js.map]
/* >>> file start: js/jquery/jquery.lj.userpicker.js */
//= require js/jquery/mixins/cursor.js
LJ.injectStyle('/* >>> file start: stc/userpicselector.css */\n.b-ljuserpic{margin:0}#js .b-ljuserpic-mobile .b-myuserpic,.b-myuserpic{display:none}#js .b-myuserpic{display:block}#js .b-ljuserpic-selector{display:none}#js .b-ljuserpic-mobile .b-ljuserpic-selector{display:inline}.b-ljuserpic-default{display:none}.b-myuserpic{width:100px;margin:0 0 15px;padding:8px 8px 4px;border:2px solid #59D;border-radius:5px;box-shadow:0 1px 1px rgba(0,0,0,.3);border-collapse:collapse;background:#FFF;cursor:pointer}.b-myuserpic:hover{border-color:#C00;cursor:pointer}.b-myuserpic-current:active,.b-myuserpic-current:hover,.b-myuserpic-current:link,.b-myuserpic-current:visited{display:block;width:100px;height:100px;margin:0;padding:0;border:0;background-repeat:no-repeat;background-position:50% 50%;text-decoration:none;font:0/0 serif}.b-myuserpic-current:focus{outline:dotted thin}.b-myuserpic-unfocus:focus{outline:0!important}.b-myuserpic-options{display:block;margin:0}.b-myuserpic-title{position:relative;display:inline-block;margin:0;padding:5px 0 0;font-size:11px;color:#369}.b-myuserpic-title I{overflow:hidden;position:absolute;top:6px;right:-16px;display:block;width:16px;height:16px;background:url(/img/icons/popup-expand.png?v=15718) no-repeat}.b-myuserpic:hover .b-myuserpic-title I{background-position:0 -16px}.b-myuserpic:focus .b-myuserpic-title I{background-position:0 -32px}.b-myuserpic-title .b-pseudo{overflow:hidden;margin:0;display:inline-block;max-width:80px;white-space:nowrap;text-overflow:ellipsis;font-size:11px}.b-ljuserpic-disabled .b-myuserpic-title,.b-ljuserpic-off .b-myuserpic-options,.b-ljuserpic-off .b-userpicselector,.b-userpicselector .i-popup-close{display:none}.b-myuserpic:hover .b-myuserpic-title .b-pseudo{color:#C00}.b-myuserpic-anonymous{padding:8px;cursor:default}.b-myuserpic-anonymous:hover{border-color:#59D;cursor:default}.b-myuserpic-anonymous .b-myuserpic-current:active,.b-myuserpic-anonymous .b-myuserpic-current:focus,.b-myuserpic-anonymous .b-myuserpic-current:hover,.b-myuserpic-anonymous .b-myuserpic-current:link,.b-myuserpic-anonymous .b-myuserpic-current:visited{outline:0;cursor:default}.b-myuserpic-nouserpics{padding:8px;cursor:default}.b-myuserpic-nouserpics:hover{border-color:#59D;cursor:default}.b-myuserpic-nouserpics .b-myuserpic-current:active,.b-myuserpic-nouserpics .b-myuserpic-current:focus,.b-myuserpic-nouserpics .b-myuserpic-current:hover,.b-myuserpic-nouserpics .b-myuserpic-current:link,.b-myuserpic-nouserpics .b-myuserpic-current:visited{outline:0;cursor:default}.b-ljuserpic-disabled .b-myuserpic{opacity:.5;padding:8px;cursor:default}.b-ljuserpic-off,.b-ljuserpic-off .b-myuserpic{margin:0;padding:0;cursor:default}.b-ljuserpic-disabled .b-myuserpic:hover{border-color:#59D;cursor:default}.b-ljuserpic-disabled .b-myuserpic-current:active,.b-ljuserpic-disabled .b-myuserpic-current:focus,.b-ljuserpic-disabled .b-myuserpic-current:hover,.b-ljuserpic-disabled .b-myuserpic-current:link,.b-ljuserpic-disabled .b-myuserpic-current:visited{outline:0;cursor:default}.b-ljuserpic-off .b-myuserpic{width:100px;border:0;border-radius:0;box-shadow:none;border-collapse:collapse;background:#FFF}.b-ljuserpic-off .b-myuserpic-current:active,.b-ljuserpic-off .b-myuserpic-current:focus,.b-ljuserpic-off .b-myuserpic-current:hover,.b-ljuserpic-off .b-myuserpic-current:link,.b-ljuserpic-off .b-myuserpic-current:visited{outline:0;cursor:default}.b-userpicselector{overflow:hidden;position:absolute;z-index:100;clear:both;margin:-17px -17px 0;padding:15px 15px 0;border:2px solid #59D;border-radius:9px;box-shadow:0 10px 15px rgba(53,99,161,.8);background:#FAFAFA;background:-webkit-gradient(linear,left top,left bottom,color-stop(0,#FAFCFE),color-stop(25%,#E2E3E7),color-stop(100%,#FAFAFA));background:-webkit-linear-gradient(top,#FAFCFE 0,#E2E3E7 25%,#FAFAFA 100%);background:linear-gradient(top,#FAFCFE 0,#E2E3E7 25%,#FAFAFA 100%);filter:progid:DXImageTransform.Microsoft.gradient( startColorstr=\'#FAFCFE\', endColorstr=\'#E2E3E7\', GradientType=0 );font:14px/1.2 Arial,sans-serif}.b-userpicselector .b-popup-inner,.b-userpicselector .b-popup-outer{position:relative;z-index:100;margin:0;padding:0;border-radius:0;border:0;background:0 0}.b-userpicselector .i-popup-arr{visibility:hidden}.b-userpicselector-inner{width:620px}.b-userpicselector-tiny4{width:480px}.b-userpicselector-tiny3{width:360px}.b-userpicselector-wrapper{overflow:auto;position:relative;height:308px;margin:0;padding:0;background:url(/img/preloader/preloader-circle-gray.gif?v=21229) 50% 50% no-repeat;font:14px/1.2 Arial,sans-serif}.b-userpicselector-loaded .b-userpicselector-wrapper{background:0 0}.b-userpicselector-tiny .b-userpicselector-wrapper{overflow:hidden;height:145px}.b-userpicselector-items{margin:0;padding:0;list-style:none}.b-userpicselector-items:after,.b-userpicselector-items:before{display:table;border-collapse:collapse;content:\"\"}.b-userpicselector-items:after{clear:both}.b-userpicselector-item{overflow:hidden;position:relative;float:left;width:100px;height:124px;margin:0 0 10px;padding:10px;text-align:left}.b-userpicselector-tiny3 .b-userpicselector-item,.b-userpicselector-tiny4 .b-userpicselector-item{margin-bottom:0}.b-userpicselector-item LABEL{display:block;margin:-10px;padding:10px;text-align:center;font-size:11px}#js .b-userpicselector-checkbox{position:absolute;left:-199px}.b-userpicselector-pic{display:block;width:100px;height:100px;margin:0;padding:0;cursor:pointer;color:#0051B7;background-repeat:no-repeat;background-position:50% 50%;font:0/0 serif}.b-userpicselector-item .b-pseudo{overflow:hidden;display:inline-block;height:14px;max-width:100px;margin:0;padding:5px 0 0;border-bottom:1px dotted;white-space:nowrap;text-overflow:ellipsis;color:#369;cursor:pointer}.b-userpicselector-item:hover .b-pseudo{color:#C00}.b-userpicselector-active LABEL{border-radius:5px;background:#58E;background:-webkit-gradient(linear,left top,left bottom,color-stop(0,#347),color-stop(100%,#58E)) #58E;background:-webkit-linear-gradient(top,#347 0,#58E 100%) #58E;background:linear-gradient(top,#347 0,#58E 100%) #58E;filter:progid:DXImageTransform.Microsoft.gradient( startColorstr=\'#334477\', endColorstr=\'#5588EE\', GradientType=0 )}.b-userpicselector-active .b-pseudo{color:#FFF}.b-userpicselector-selected LABEL{padding:9px;border:1px dotted #000}.b-userpicselector-selected .b-pseudo{color:#C00}.b-userpicselector-selected.b-userpicselector-active LABEL{border:1px solid #473479}.b-userpicselector-selected.b-userpicselector-active .b-pseudo{color:#FFF}.b-userpicselector-selected.b-userpicselector-active:hover .b-pseudo{color:#C00}.b-userpicselector-controls{margin:15px -15px 0;padding:20px;-moz-border-radius-bottomleft:7px;-moz-border-radius-bottomright:7px;border-bottom-left-radius:7px;border-bottom-right-radius:7px;background:#CDE;background:-webkit-gradient(linear,left top,left bottom,color-stop(0,#CDE),color-stop(100%,#FFF)) #CDE;background:-webkit-linear-gradient(top,#CDE 0,#FFF 100%) #CDE;background:linear-gradient(top,#CDE 0,#FFF 100%) #CDE;filter:progid:DXImageTransform.Microsoft.gradient( startColorstr=\'#CCDDEE\', endColorstr=\'#FFFFFF\', GradientType=0 );font:14px/1.2 Arial,sans-serif}.b-userpicselector-keywords{display:none;width:16em;margin:0 20px 0 0}#js .b-userpicselector-keywords{display:inline-block}#js .b-userpicselector-tiny .b-userpicselector-keywords,.b-userpicselector-tiny .placeholder-wrapper{display:none}BODY .b-userpicselector-showall,BODY .b-userpicselector-showall:link,BODY .b-userpicselector-showall:visited{margin:0;border:0;color:#0051B7!important;text-decoration:underline}BODY .b-userpicselector-showall:active,BODY .b-userpicselector-showall:hover{color:#C00!important;border:0;text-decoration:underline}BODY .b-userpicselector-close:active,BODY .b-userpicselector-close:hover,BODY .b-userpicselector-close:link,BODY .b-userpicselector-close:visited{display:none;position:absolute;bottom:21px;right:4px;z-index:3;margin:0 16px 0 0;border-bottom:1px dotted;cursor:pointer;color:#000!important;text-decoration:none}BODY .b-userpicselector-close:active,BODY .b-userpicselector-close:hover{color:#C00!important}BODY .b-userpicselector-close:after{content:\" \";position:absolute;top:2px;right:-18px;width:16px;height:16px;margin:0;padding:0;background:url(/img/icons/popup-close.png?v=15718) no-repeat;font:0/0 serif;cursor:pointer}BODY .b-userpicselector-close:hover:after{background-position:0 -16px}#js .b-userpicselector-close:active,#js .b-userpicselector-close:hover,#js .b-userpicselector-close:link,#js .b-userpicselector-close:visited{display:block}\n/* <<< file end: stc/userpicselector.css */\n\n/*# sourceMappingURL=userpicselector.css.map */\n');
LJ.UI.registerTemplate('templates-Form-UpicSelect', "{{if !($data.renderpics)}} <div class=\" b-userpicselector-inner {{if $data.hasdefaultuserpic}} {{if $data.hasuserpics < 6}} b-userpicselector-tiny {{if $data.hasuserpics < 5}} b-userpicselector-tiny4 {{/if}} {{if $data.hasuserpics < 4}} b-userpicselector-tiny3 {{/if}} {{/if}} {{else}} {{if $data.hasuserpics < 5}} b-userpicselector-tiny {{/if}} {{if $data.hasuserpics < 4}} b-userpicselector-tiny b-userpicselector-tiny4 {{/if}} {{/if}} \"> <div class=\"b-userpicselector-wrapper\"> <ul class=\"b-userpicselector-items\"> {{if !($data.hasdefaultuserpic)}} <li class=\"b-userpicselector-item b-userpicselector-item-nodefault\" data-name=\"\"><label for=\"u{{html $data.id}}\"><span class=\"b-userpicselector-pic\" data-pic=\"url({{html $data.statprefix}}/img/userpics/userpic-user.png?v=15821)\" title=\"{{html LJ.mltext(\'talk.no.default.userpic\')}}\">&nbsp;</span><span class=\"b-pseudo\">{{html LJ.mltext(\'talk.default.userpic\')}}</span> </label> </li> {{/if}} {{/if}} {{if $data.renderpics}} {{each ($value.userpics || $data.userpics)}} <li class=\" b-userpicselector-item {{if ($value.active || $data.active)}} b-userpicselector-active {{/if}}\" data-name=\"{{html ($value.keyword || $data.keyword)}}\"><label for=\"u{{html ($value.id || $data.id)}}\"><span class=\"b-userpicselector-pic\" data-pic=\"url({{html ($value.src || $data.src)}})\" title=\"{{html ($value.title || $data.title)}}\">&nbsp;</span><span class=\"b-pseudo\">{{html ($value.title || $data.title)}}</span></label> </li> {{/each}} {{/if}} {{if !($data.renderpics)}} </ul> </div> <div class=\"b-userpicselector-controls\"> {{if $data.hasuserpics >= 6}} <input type=\"search\" id=\"\" placeholder=\"{{html LJ.mltext(\"talk.searchuserpic\")}}\" class=\"b-userpicselector-keywords\" tabindex=\"31\"> {{/if}} <a href=\"{{html $data.siteroot}}/editpics.bml\" class=\"b-userpicselector-showall\" target=\"_blank\">{{html LJ.mltext(\'talk.manageuserpic\')}}</a> <a href=\"javascript:void(0)\" class=\"b-userpicselector-close b-pseudo\" tabindex=\"32\">{{html LJ.mltext(\'talk.close\')}}</a> </div> </div> {{/if}} ", 'JQuery.stat');
!function(e,t){e.widget("lj.userpicker",e.lj.basicWidget,{options:{updateDefaultUserpic:!1,useCurrentJournal:!1,classNames:{active:"b-userpicselector-active",selected:"b-userpicselector-selected",unfocus:"b-myuserpic-unfocus",loaded:"b-userpicselector-loaded",nodefaultItem:"b-userpicselector-item-nodefault",startAuth:"b-watering-trueauth-"},selectors:{nodefaultItem:".b-userpicselector-item-nodefault",active:".b-userpicselector-active",listWrapper:".b-userpicselector-wrapper",pickerControl:".b-myuserpic",pickerContainer:".b-userpicselector",userpic:".b-userpicselector-item",userpicsList:".b-userpicselector-items",currentImage:".b-myuserpic-current",currentText:".b-myuserpic-title span",imageNode:".b-userpicselector-pic",textNode:".b-pseudo",closeControl:".b-userpicselector-close",keywordInput:".b-userpicselector-keywords",commentWidget:".b-watering-comment",select:"#prop_picture_keyword"},templates:{popup:"templates-Form-UpicSelect"}},_create:function(){var t=this;return e.lj.basicWidget.prototype._create.apply(this),this._currentAuthSelected=!0,this._data=null,this._loadingSkiped=!1,this._shouldUpdateHeaderPic=!0,this.options.useCurrentJournal&&LJ.get("current_journal.is_comm")?(this._user=LJ.get("currentJournal"),this._shouldUpdateHeaderPic=!1):this._user=LJ.get("remoteUser"),LJ.Support.isMobile()?void this._fallbackToMobile():(this._cachedDimensions=[],this._visible=!1,this._suppressTargetClick=!1,this._picsLoaded=!1,this._picKeyword=LJ.get("activeuserpic")||"",this._defaultKeyword=this._picKeyword,this._defaultPicUrl=this._el("currentImage").css("background-image"),this._nodefLabel=this._el("currentImage").data("nodeflabel"),this._nodefPic=this._el("currentImage").data("nodefpic"),this._currentPicNode=null,this._keywords={},this._el("select").children().each(function(){t._keywords[this.getAttribute("value")]=!0}),this._preparePopup(),this._findNodes(),this._setupCursor(),void this._bindControls())},_augmentUserpicData:function(e){var t=this;return e.userpics?this._data=e.userpics.map(function(e){var i=e.keywords.join(", ");return{title:i,keyword:i.trim().toLowerCase(),active:i===t._defaultKeyword,id:e.id,src:e.url}}):this._data=[],this._data},_preparePopup:function(){var e={hasuserpics:LJ.get("hasuserpics"),hasdefaultuserpic:LJ.get("hasdefaultuserpic"),hasactiveuserpic:!!LJ.get("activeuserpic"),statprefix:LJ.get("statprefix"),siteroot:LJ.get("siteroot")};this._popupContent=this._tmpl("popup",e),this._popupContent.bubble({target:this._el("pickerControl"),alwaysShowUnderTarget:!0,closeOnDocumentClick:!1,classNames:{containerAddClass:"b-userpicselector"},showEffect:"fade",selectors:{closeControl:this._s("closeControl")},offset:{x:-12,y:-128}}),this._el("userpicsList",this._popupContent)},_loadPics:function(){this._lock(),LJ.Api.call("userpic.get_all_userpics",{user:this._user},function(e){this._picsLoaded=!0,this._unlock(),this._popupContent.addClass(this._cl("loaded")),this._initPics(this._augmentUserpicData(e)),this._defaultActiveUserpic||(this._defaultActiveUserpic=LJ.get("hasactiveuserpic")||LJ.get("hasdefaultuserpic")?this._popupContent.find(this._s("active")):this._popupContent.find(this._s("nodefaultItem")));var t=this._picKeyword!==this._defaultKeyword,i=this._picKeyword;this._findDefaultActive(),t&&this._findByKeyword(i),this._bindPopupControls(),this._updateUserpics(),0===this._cachedDimensions.length&&(this._cachedDimensions.cellheight=this._userpics.eq(0).outerHeight(!0),this._cachedDimensions.frameHeight=this._listWrapper.height())}.bind(this))},_initPics:function(e){var t={userpics:e,renderpics:!0};this._tmpl("popup",t).appendTo(this._userpicsList),this._userpicsImgList=this._userpicsList.find(this._s("imageNode")),this._userpics=this._userpicsList.find(this._s("userpic"))},_fallbackToMobile:function(){var e,t;e=this._el("select"),t=e.val(),this.element.bind("commentformclose userpic",function(i,s){e.val(s||t)})},_findDefaultActive:function(){return this._picsLoaded?void(this._defaultActiveUserpic.length&&this._setActiveUserpic(this._defaultActiveUserpic)):void this._setUserpic(this._defaultKeyword,this._defaultPicUrl)},_findNodes:function(){var e=this._popupContent;this._pickerContainer=e,this._el("keywordInput",e),this._el("listWrapper",e),this._el("currentImage"),this._el("currentText"),this._windowHeight=this._listWrapper.height()},_setupCursor:function(){var e=this;e._use("cursor",{target:this._el("pickerControl"),items:jQuery(),container:e._el("listWrapper"),cancel:e.onHide.bind(e,null),columns:5,select:function(t,i){e._visible&&(e._setActiveUserpic(i,!0),e.hide(),e._suppressTargetClick=!0)},hoverClass:this._cl("selected")}),e._("cursor").index(0)},_bindControls:function(){var t=this;e.lj.basicWidget.prototype._bindControls.apply(this),t.element.on("click",this._s("pickerControl"),function(e){t._pickerContainer.length>0&&t._currentAuthSelected&&!t._suppressTargetClick&&!t._el("select").attr("disabled")&&(t.show(),t._suppressNextEvent("documentClick"),t._picsLoaded||t.locked()||t._loadPics()),t._suppressTargetClick=!1,e.preventDefault()});var i=LJ.get("hasuserpics")||0;i>=6&&t.element.on("keypress",this._s("pickerControl"),function(e){if(!t._visible)return!0;var i=0;"undefined"==typeof e.which?i=e.keyCode:"number"==typeof e.which&&e.which>0&&(e.ctrlKey||e.metaKey||e.altKey||8==e.which||(i=e.which)),i&&(t._keywordInput.val(t._keywordInput.val()+String.fromCharCode(e.which)),Function.defer(function(){t._keywordInput.input().trigger("focus");var e=t._keywordInput.val().length;DOM.setSelectedRange(t._keywordInput.get(0),e,e)}))}),this._popupContent.on("click",this._s("userpic"),function(i){t._setActiveUserpic(e(this),!0),t.hide()}).on("click",this._suppressNextEvent.bind(this,"documentClick")),this._popupContent.on("bubbleshow",this.onShow.bind(this)).on("bubblehide",this.onHide.bind(this)),t.element.on("authtypechange",function(e,i){var s=t._cl("startAuth")+i.authtype;t._currentAuthSelected=t.element.hasClass(s)}).on("commentformclose",function(){t._keywordInput.val(""),t._picsLoaded&&(t._userpics.show(),t._("cursor").setData(t._userpics,0)),t._findDefaultActive()}).on("userpic",function(e,i,s){t._picsLoaded?t._findByKeyword(i):t._setUserpic(i,"url("+s+")")}),this._on("documentClick",this.hide.bind(this))},_bindPopupControls:function(){var e=this;this._keywordInput.labeledPlaceholder().input(LJ.Function.throttle(function(){e.filter(e._keywordInput.val())},this.value),100),this._listWrapper.scroll(this._updateUserpics.bind(this)),this._currentImage.blur(function(t){e._("cursor").item().removeClass(e._cl("selected"))}).focus(function(t){e._("cursor").index(0)}),this._userpicsImgList.one("activate",function(){var e=jQuery(this),t=e.data("pic");e.css("background-image",t),this.loaded=!0})},_updateUserpics:function(){var e=this._listWrapper.offset().top+this._windowHeight,t=this._userpicsImgList.filter(function(){return jQuery(this).offset().top<e+200}).trigger("activate");this._userpicsImgList=this._userpicsImgList.not(t)},_findByKeyword:function(t){if(!t)return void this._findDefaultActive();t=String(t).toLowerCase();var i=this._userpicNodes=this._pickerContainer.find(this._s("userpic")).filter(function(){var i=e(this).data("name");return i?!!String(i).split(/, */).filter(function(e){return e===t}).length:!1}).first();i.length>0?this._setActiveUserpic(i):this._findDefaultActive()},filter:function(e){var t=this;e=e.trim().toLowerCase();var i=jQuery(),s=this._("cursor").index(),r=this._("cursor").item().get(0);e.length>0?this._userpics.each(function(){var c=jQuery(this),n=c.data("name").toString().indexOf(e)>-1;c.toggle(n),n?i=i.add(c):this===r&&(s=0,c.removeClass(t._cl("selected")))}):(i=this._userpics,i.show()),this._("cursor").setData(i,s),this._updateUserpics(),this._currentImage.trigger("blur")},onShow:function(){this._visible=!0,this._picsLoaded&&this._updateUserpics(),this._listWrapper.scrollTop(0),this._currentImage.trigger("focus"),Function.defer(function(){this._currentImage.trigger("focus")}.bind(this)),this._picsLoaded&&this._("cursor").index(0)},onHide:function(e){this._visible=!1,this._pickerContainer.removeClass(this._cl("unfocus"))},_setActiveUserpic:function(e,t){var i,s,r;if(e.hasClass(this._cl("nodefaultItem"))?(s="",r=""):(i=e.find(this._s("imageNode")),s=i.css("background-image"),s&&"none"!==s||(s=i.data("pic")),r=e.find(this._s("textNode")).text()),this._setUserpic(r,s),!this._currentPicNode||this._currentPicNode.get(0)!==e.get(0)){var c=this._currentPicNode;this._currentPicNode=e,this._visible&&t?this._popupContent.one("bubblehide",function(){this._setUserpicNode(c,e)}.bind(this)):this._setUserpicNode(c,e)}},_setUserpic:function(t,i){var s=t.split(/, */),r=this,c=null;this.options.updateDefaultUserpic&&(c=this._getDataByTitle(t),c&&this._loadingSkiped?this._sendUpdateUserpicRequest(c.id):this._loadingSkiped=!0),e.each(s,function(e,t){r._keywords[t]&&r._el("select").val(t)}),s.indexOf(this._el("select").val())>=0&&(t=t||this._nodefLabel,i=i||this._nodefPic,this._picKeyword=t,this._currentImage.css("background-image",i),this._currentText.text(t))},_setUserpicNode:function(e,t){e&&e.removeClass(this._cl("active")),this._("cursor").item().removeClass(this._cl("selected")),t.addClass(this._cl("active")).prependTo(this._userpicsList),this._userpics=this._popupContent.find(this._s("userpic")),this._("cursor").setData(this._userpics,0)},hide:function(){this._popupContent.bubble("hide")},show:function(){this._popupContent.bubble("show")},_getDataByTitle:function(e){var t=this._data.filter(function(t){return t.title===e});return t.length>0?t[0]:null},_sendUpdateUserpicRequest:function(e){this.options.updateDefaultUserpic&&LJ.Api.call("userpic.set_default_userpic",{user:this._user,defaultpic:e},this._afterUserpicUpdate.bind(this))},_afterUserpicUpdate:function(t){var i;"ok"===t.result&&this._shouldUpdateHeaderPic&&("lanzelot"===LJ.get("scheme")?e("#header").find(".userpic").attr("src",t.url):(e(".b-userpic-wrap").removeClass("b-userpic-wrap-empty").find("#defaultpic").css("background-image","url('"+t.url+"')"),e(".s-userpic-wrap").removeClass("s-userpic-wrap-empty").find(".userpic").attr("src",t.url)),i=this._popupContent.find(this._s("nodefaultItem")),i.length&&i.remove())}})}(jQuery,this);
/* <<< file end: js/jquery/jquery.lj.userpicker.js */

//# map link was there [jquery.lj.userpicker.js.map]
/* >>> file start: js/jquery/jquery.lj.commentsFormToolbar.js */
//= require js/jquery/jquery.hotkeys.js
!function(t,o){t.widget("lj.commentsFormToolbar",jQuery.lj.basicWidget,{options:{additionalRoles:[],selectors:{buttons:".b-updateform-button",photoPreview:".b-updateform-bubble-photo-preview",toolbar:".b-updateform-bar",htmlTextarea:"#body"},classNames:{preloader:"b-updateform-bubble-photo-preload"}},init:{},_create:function(){this._el("toolbar"),t.lj.basicWidget.prototype._create.apply(this),this._el("buttons"),this._emptyGif=null,this._imgPreload=new Image,this._bindControls()},_bindControls:function(){var o=this;this.options.selectors;t.lj.basicWidget.prototype._bindControls.apply(this),this._on("rte_on",function(t){o.rteOn=!!t})},_checkPhotoLoad:function(t,o,e){var i=o.val().trim(),r=this,s=t.find(this.options.selectors.photoPreview);s.attr("src",this._emptyGif),0!==i.length&&(t.addClass(this.options.classNames.preloader),0!==i.length&&(this._imgPreload.src="",this._imgPreload.onload=function(){0!==r._imgPreload.src.length&&(t.removeClass(r.options.classNames.preloader),s.attr("src",r._imgPreload.src))},this._imgPreload.onerror=function(){t.removeClass(r.options.classNames.preloader)},clearTimeout(this._imgPreload.timer),this._imgPreload.timer=setTimeout(function(){r._imgPreload.src=i},200)))},attachHotkeys:function(t){t=jQuery(t);var o=function(t,o){this.insertContent(t),o.preventDefault(),o.stopPropagation()};t.bind("keydown","ctrl+b",o.bind(this,"bold")).bind("keydown","ctrl+i",o.bind(this,"italic")).bind("keydown","ctrl+u",o.bind(this,"underline"))}})}(jQuery,window);
/* <<< file end: js/jquery/jquery.lj.commentsFormToolbar.js */

//# map link was there [jquery.lj.commentsFormToolbar.js.map]
/* >>> file start: js/jquery/jquery.easing.js */
jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(n,e,t,u,a){return jQuery.easing[jQuery.easing.def](n,e,t,u,a)},easeInQuad:function(n,e,t,u,a){return u*(e/=a)*e+t},easeOutQuad:function(n,e,t,u,a){return-u*(e/=a)*(e-2)+t},easeInOutQuad:function(n,e,t,u,a){return(e/=a/2)<1?u/2*e*e+t:-u/2*(--e*(e-2)-1)+t},easeInCubic:function(n,e,t,u,a){return u*(e/=a)*e*e+t},easeOutCubic:function(n,e,t,u,a){return u*((e=e/a-1)*e*e+1)+t},easeInOutCubic:function(n,e,t,u,a){return(e/=a/2)<1?u/2*e*e*e+t:u/2*((e-=2)*e*e+2)+t},easeInQuart:function(n,e,t,u,a){return u*(e/=a)*e*e*e+t},easeOutQuart:function(n,e,t,u,a){return-u*((e=e/a-1)*e*e*e-1)+t},easeInOutQuart:function(n,e,t,u,a){return(e/=a/2)<1?u/2*e*e*e*e+t:-u/2*((e-=2)*e*e*e-2)+t},easeInQuint:function(n,e,t,u,a){return u*(e/=a)*e*e*e*e+t},easeOutQuint:function(n,e,t,u,a){return u*((e=e/a-1)*e*e*e*e+1)+t},easeInOutQuint:function(n,e,t,u,a){return(e/=a/2)<1?u/2*e*e*e*e*e+t:u/2*((e-=2)*e*e*e*e+2)+t},easeInSine:function(n,e,t,u,a){return-u*Math.cos(e/a*(Math.PI/2))+u+t},easeOutSine:function(n,e,t,u,a){return u*Math.sin(e/a*(Math.PI/2))+t},easeInOutSine:function(n,e,t,u,a){return-u/2*(Math.cos(Math.PI*e/a)-1)+t},easeInExpo:function(n,e,t,u,a){return 0==e?t:u*Math.pow(2,10*(e/a-1))+t},easeOutExpo:function(n,e,t,u,a){return e==a?t+u:u*(-Math.pow(2,-10*e/a)+1)+t},easeInOutExpo:function(n,e,t,u,a){return 0==e?t:e==a?t+u:(e/=a/2)<1?u/2*Math.pow(2,10*(e-1))+t:u/2*(-Math.pow(2,-10*--e)+2)+t},easeInCirc:function(n,e,t,u,a){return-u*(Math.sqrt(1-(e/=a)*e)-1)+t},easeOutCirc:function(n,e,t,u,a){return u*Math.sqrt(1-(e=e/a-1)*e)+t},easeInOutCirc:function(n,e,t,u,a){return(e/=a/2)<1?-u/2*(Math.sqrt(1-e*e)-1)+t:u/2*(Math.sqrt(1-(e-=2)*e)+1)+t},easeInElastic:function(n,e,t,u,a){var r=1.70158,i=0,s=u;if(0==e)return t;if(1==(e/=a))return t+u;if(i||(i=.3*a),s<Math.abs(u)){s=u;var r=i/4}else var r=i/(2*Math.PI)*Math.asin(u/s);return-(s*Math.pow(2,10*(e-=1))*Math.sin((e*a-r)*(2*Math.PI)/i))+t},easeOutElastic:function(n,e,t,u,a){var r=1.70158,i=0,s=u;if(0==e)return t;if(1==(e/=a))return t+u;if(i||(i=.3*a),s<Math.abs(u)){s=u;var r=i/4}else var r=i/(2*Math.PI)*Math.asin(u/s);return s*Math.pow(2,-10*e)*Math.sin((e*a-r)*(2*Math.PI)/i)+u+t},easeInOutElastic:function(n,e,t,u,a){var r=1.70158,i=0,s=u;if(0==e)return t;if(2==(e/=a/2))return t+u;if(i||(i=a*(.3*1.5)),s<Math.abs(u)){s=u;var r=i/4}else var r=i/(2*Math.PI)*Math.asin(u/s);return 1>e?-.5*(s*Math.pow(2,10*(e-=1))*Math.sin((e*a-r)*(2*Math.PI)/i))+t:s*Math.pow(2,-10*(e-=1))*Math.sin((e*a-r)*(2*Math.PI)/i)*.5+u+t},easeInBack:function(n,e,t,u,a,r){return void 0==r&&(r=1.70158),u*(e/=a)*e*((r+1)*e-r)+t},easeOutBack:function(n,e,t,u,a,r){return void 0==r&&(r=1.70158),u*((e=e/a-1)*e*((r+1)*e+r)+1)+t},easeInOutBack:function(n,e,t,u,a,r){return void 0==r&&(r=1.70158),(e/=a/2)<1?u/2*(e*e*(((r*=1.525)+1)*e-r))+t:u/2*((e-=2)*e*(((r*=1.525)+1)*e+r)+2)+t},easeInBounce:function(n,e,t,u,a){return u-jQuery.easing.easeOutBounce(n,a-e,0,u,a)+t},easeOutBounce:function(n,e,t,u,a){return(e/=a)<1/2.75?u*(7.5625*e*e)+t:2/2.75>e?u*(7.5625*(e-=1.5/2.75)*e+.75)+t:2.5/2.75>e?u*(7.5625*(e-=2.25/2.75)*e+.9375)+t:u*(7.5625*(e-=2.625/2.75)*e+.984375)+t},easeInOutBounce:function(n,e,t,u,a){return a/2>e?.5*jQuery.easing.easeInBounce(n,2*e,0,u,a)+t:.5*jQuery.easing.easeOutBounce(n,2*e-a,0,u,a)+.5*u+t}});
/* <<< file end: js/jquery/jquery.easing.js */

//# map link was there [jquery.easing.js.map]
/* >>> file start: js/jquery/jquery.lj.commentform.js */
//= require js/jquery/jquery.easing.js
!function(t){t.widget("lj.commentform",t.lj.basicWidget,{options:{classNames:{active:"active",startAuth:"b-watering-trueauth-",buttonDisabled:"b-ljbutton-disabled",activeComment:"b-leaf-commenting",editComment:"b-leaf-editing",controlNoId:"b-leaf-actions-noid",formEditComment:"b-watering-editing",formEditMyComment:"b-watering-editing-mycomment",authtypeAnonymous:"b-watering-authtype-anonymous",notfriend:"b-watering-user-notafriend",notreg:"b-watering-user-notreg",regonly:"b-watering-user-regonly",friendonly:"b-watering-user-friendonly",errorWrapperShow:"b-msgsystem-errorbox-show",commentFrozen:"b-leaf-frozen",commentScreened:"b-leaf-screened",commentSpammed:"b-leaf-spammed",firstLevelParent:LJ.Util.isMediusJournal()?"mdspost-comments-controls":"b-xylem",showSpam:"b-grove-showspam",previewVisible:"b-watering-preview-enabled"},selectors:{form:"#postform",errorWrapper:".b-msgsystem-errorbox",aside:".b-watering-aside",tail:".b-watering-arrows",toolbar:".b-updateform-bar",submitControl:LJ.Util.isMediusJournal?".b-watering-submit":".b-ljbutton-submit",submitButton:LJ.Util.isMediusJournal?".b-watering-submit [type=submit]":".b-ljbutton-submit [type=submit]",comment:"#body",subject:"[name=subject]",editid:"input[name=editid]",inputReplyto:"#replyto",inputParentTalkid:"#parenttalkid",inputViewingThread:"#viewing_thread",commentsRoot:LJ.Util.isMediusJournal()?".mdspost-comments":".b-grove",addFirstLevelControl:LJ.Util.isMediusJournal()?".mdspost-comments-controls__add":".b-addcomment",firstLevelParent:LJ.Util.isMediusJournal()?".mdspost-comments-controls":".b-xylem",firstLevelCommentContainer:LJ.Util.isMediusJournal()?".mdspost-comments__addcomment":".b-xylem-cell-add",addControl:LJ.Util.isMediusJournal()?".mdspost-comment-actions__item--reply":".b-leaf-actions-reply",addControlLink:".b-pseudo",commentContainer:LJ.Util.isMediusJournal()?".mdspost-comment":".b-leaf",twig:LJ.Util.isMediusJournal()?".mdspost-thread":".b-tree-twig",editLink:LJ.Util.isMediusJournal()?".mdspost-comment-controls__item--edit":".b-controls-edit",userpicImg:".b-leaf-userpic-inner > img",commentText:".b-leaf-article",commentSubject:".b-leaf-subject",closeControl:".b-watering-close",previewForm:".b-watering-preview",showPreviewCheckbox:"input#preview-comment"},disabledRegex:/b-watering-user-(deleted|suspended|banned|notmail)/,focusTimeout:700,isSubjectEnabled:LJ.get("is_subject_enabled")},_create:function(){t.lj.basicWidget.prototype._create.apply(this),this._findNodes(),this._bindEvents(),this._disabled=!1,this._authToken=this._commentsRoot.data("authtoken"),this._updateFormState(),this._state=null,this._previousState=null,this._node=null,this._blurTimeout=0},_findNodes:function(){var e=this.options.selectors;this._inputs={editid:this.element.find(e.editid),replyTo:this.element.find(e.inputReplyto),parentTalkid:this.element.find(e.inputParentTalkid),viewingThread:this.element.find(e.inputViewingThread),previewCheck:this.element.find(e.showPreviewCheckbox)},this._tail=this.element.find(e.tail),this._tailHeight=parseInt(this._tail.css("height"),10),this._commentsRoot=t(e.commentsRoot),this._firstLevelParent=t(e.firstLevelParent).eq(0),this._firstLevelCommentContainer=t(e.firstLevelCommentContainer).eq(0),this._submitControl=this.element.find(e.submitControl),this._submitButton=this.element.find(e.submitButton),this._commentArea=this.element.find(e.comment),this._subject=this.element.find(e.subject),this._errorsWrapper=this.element.find(e.errorWrapper),this._form=this.element.find(e.form),this._toolbar=this.element.find(e.toolbar),this._preview=this.element.find(e.previewForm)},_bindEvents:function(){var e=this,i=e.options.selectors,s=e.options.classNames;this._commentArea.input(this._updateFormState.bind(this)),this._commentsRoot.delegate(i.addFirstLevelControl+":first","click",function(t){e.add(),t.preventDefault()}),this._commentsRoot.delegate(i.addFirstLevelControl+":gt(0)","click",function(t){e._scrollToForm(),e.element.is(":visible")&&e._node.get(0)===e._firstLevelCommentContainer.get(0)||e.add(),t.preventDefault()}),this._commentsRoot.delegate(i.addControl,"click",function(n){var o=t(this),a=o.attr("data-tid");o.hasClass(s.controlNoId)&&(o=t("#"+a).find(i.addControl)),0!==o.length&&(e.add(o),e._commentArea.focus(),n.preventDefault())}),this.element.delegate(i.closeControl,"click",function(t){e._closeForm(),t.preventDefault()}),this._form.bind("submit",function(){setTimeout(function(){e._setDisabled(!0),e._commentArea.attr("disabled",!0)},0)}),LJ.Event.on("commentator/submit",function(t){t.hidden&&!Site.remoteUser&&e._closeForm(),e._updateFormState(),e._commentArea.attr("disabled",!1)}),this._toolbar.bind("insertText",function(t,i){e._insertText(i.text,i.defaultSelection,i.insertTimeout)}).bind("terminateAction",function(){e._currentSelection=null}).commentsFormToolbar("attachHotkeys",this._commentArea),this._commentArea.bind("keydown mousedown mouseup"+(jQuery.browser.msie?"":" blur"),function(){Function.defer(function(){e._currentSelection=window.DOM.getSelectedRange(e._commentArea.get(0))})}).bind("blur",function(){e._blurTimeout=+new Date}),this.element.bind("newComment",function(){jQuery.fx.off=!0,e._node&&e._node.find(i.editLink).remove(),e._commentArea.val(""),e._subject.val(""),e._closeForm(),jQuery.fx.off=!1}).bind("authtypechange",function(t,i){var n=s.startAuth+i.authtype;e._currentAuthSelected=e.element.hasClass(n),e._updateFormState()}),t(document).bind("commentsUpdated",function(i,s,n){var o=e._node;o&&(0===o.parent().length||o.attr("id")===s&&"expand"!==n||-1===["expand","delone","screen","unscreen"].indexOf(n)&&t.comments.parent(o,s)!==!1)&&e._closeForm()}).bind("editComment",function(t,i){e.edit(i)}),this._on("commentsPage",function(){t.fx.off=!0,e.add(),e._node&&e._closeForm(),t.fx.off=!1}),LJ.Flags.isEnabled("s1comment_preview")&&this._inputs.previewCheck.change(function(t){t.target.checked?e._showPreview():e._hidePreview()})},previousState:function(){return this._previousState},syncPreviousState:function(){this._previousState=this._state},_updateFormState:function(){var t=this.options.classNames,e=0===this._commentArea.val().trim().length||this._currentAuthSelected&&(this.options.disabledRegex.test(this.element.prop("className"))||this.element.hasClass(t.friendonly)&&this.element.hasClass(t.notfriend)||this.element.hasClass(t.notreg)&&(this.element.hasClass(t.regonly)||this.element.hasClass(t.friendonly)))||this.element.hasClass(t.authtypeAnonymous)&&(this.element.hasClass(t.regonly)||this.element.hasClass(t.friendonly));this._setDisabled(e)},_setDisabled:function(t){t=!!t,window.operamini&&(t=!1),this._submitControl.toggleClass(this.options.classNames.buttonDisabled,t),t?this._submitButton.attr("disabled","disabled"):this._submitButton.removeAttr("disabled"),this._disabled=t,this.element.trigger("commentformdisable",this._disabled)},_insertText:function(t,e,i){var s,n,o,a=this._commentArea[0].value,r=this._currentSelection,l="{posifempty}",m=!1;if(e=e||"",!r||i-this._blurTimeout>this.options.focusTimeout&&!this._commentArea.is(":focus"))s=a+t.supplant({caret:e}),n=s.length,m=!0;else{var d=a.substring(r.start,r.end),c=a.substring(0,r.start),h=a.substring(r.end);0===d.length&&(d=e),0===d.length&&(m=!0),d=t.supplant({caret:d}),m||(d=d.supplant({posifempty:""})),s=c+d+h,n=r.start+d.length}m&&(o=s.indexOf(l))>=0&&(n=o),s=s.replace(l,""),this._commentArea.val(s);var u=this._commentArea.get(0);window.DOM.setSelectedRange(u,n,n),this._currentSelection=null,this._commentArea.focus(),this._updateFormState()},_scrollToForm:function(){var t=this._commentsRoot.offset().top-parseInt(this._commentsRoot.css("margin-top"),10);return jQuery("html, body").animate({scrollTop:t}),this},_setOption:function(t,e){var i=this.options,s=i.classNames,n=s.active;switch(t){case"activeControl":i.activeControl&&i.activeControl.removeClass(n),e&&e.addClass(n)}i[t]=e},_setCommentPending:function(t,e){this.element.trigger("commentpending",[t,e])},_isInState:function(t,e){return this._state===t&&this._node&&e.get(0)===this._node.get(0)},_closeForm:function(){var t=this,e=this.options,i=this.options.classNames,s=this._node,n=function(){t._inputs.replyTo.val("0"),t._inputs.parentTalkid.val("0"),t._inputs.editid.val("0"),t.element.data("parenttalkid",null),t._setOption("activeControl",null),t._previousState=t._state,t._state=null,t._node&&t._node.removeClass(i.activeComment),t._node=null,t._errorsWrapper.removeClass(i.errorWrapperShow)};this._subject.val(""),this._commentArea.val(""),e.activeControl&&!e.activeControl.hasClass(e.classNames.firstLevelParent)&&e.activeControl.find(e.selectors.addControlLink).html(Site.ml_text["talk.replytothis"]),s.removeClass(i.editComment),this.element.removeClass(i.formEditComment).removeClass(i.formEditMyComment),this.hide(n,null)},show:function(t){var e=this;if(this.element.css({display:"block",height:""}),jQuery.comments.skipAnimation)this._fixIEProblemsShow(),this.element.css({opacity:""}),t&&t(),this.element.trigger("commentformopen");else{var i=this.element.height();this._tail.css({height:"",top:""}),this._tailHeight=parseInt(this._tail.css("height"),10),this._tail.css({height:"-="+this._tailHeight,top:"+="+this._tailHeight}).animate({height:"+="+this._tailHeight,top:"-="+this._tailHeight},250),this.element.css({opacity:0,height:"1px"});var s,n=this.element.offset().top,o=jQuery("html, body"),a=jQuery(window),r=a.height(),l=a.scrollTop(),m=l+r-i-jQuery("#ljtime").height(),d=!1;l>m&&(m=l),s=-m+n,n>m&&(d=!0),this.element.animate({height:i,opacity:1},{duration:500,easing:"easeOutExpo",step:function(t,e){d&&"opacity"===e.prop&&o.scrollTop(l+s*t)},complete:function(){e.element.removeAttr("style").css("display","block"),t&&t(),e.element.trigger("commentformopen")}})}},_fixIEProblemsShow:function(){if(t.browser.msie&&!(parseInt(t.browser.version,10)>8)){this._aside||(this._aside=this.element.find(this.options.selectors.aside));var e=this._aside.get(0),i=e.parentNode,s=i.clientWidth;e.style.marginLeft=-1*(s-parseInt(i.currentStyle.paddingLeft,10)-parseInt(i.currentStyle.paddingRight,10))}},hide:function(e,i){var s=this,n=jQuery(document);if(this.element.trigger("commentformclose"),i=i||this.options.activeControl,0===i.parent().length?i=jQuery("#"+this._node.attr("id")):i.hasClass(this.options.classNames.firstLevelParent)||(i=i.closest(this.options.selectors.commentContainer)),"block"===this.element[0].style.display){var o=n.scrollTop(),a=o+t(window).height(),r=this.element.offset().top,l=r+this.element.outerHeight(),m=i.offset().top-o;if(o>l||r>a||jQuery.comments.skipAnimation)this.element.detach(),n.scrollTop(i.offset().top-m),e&&e();else{var d=this.element.height();this.element.css({height:d}),this._tail.animate({height:"-="+this._tailHeight,top:"+="+this._tailHeight},200),this.element.animate({height:0,opacity:0},{duration:300,easing:"easeOutExpo",step:function(){n.scrollTop(i.offset().top-m)},complete:function(){n.scrollTop(i.offset().top-m),s.element.css("display",""),e&&e()}})}}else e&&e();LJ.Flags.isEnabled("s1comment_preview")&&this._hidePreview()},add:function(t){var e=this.options,i=this.comment("add",t);e.activeControl&&!e.activeControl.hasClass(e.classNames.firstLevelParent)&&e.activeControl.find(e.selectors.addControlLink).html(Site.ml_text["talk.replytothis"]),i&&(this._inputs.editid.val(""),this._submitButton.html(Site.ml_text["talk.postcomment"]),t&&t.find(e.selectors.addControlLink).html(Site.ml_text["talk.answer"])),this._updateFormState()},edit:function(e){function i(t,i,s,r,l){n.comment("edit",o),e.toggleClass(n.options.classNames.editComment,t),n.element.toggleClass(n.options.classNames.formEditComment,t),Site.remoteUser!==Site.currentJournal&&n.element.toggleClass(n.options.classNames.formEditMyComment,t),t&&(n._inputs.editid.val(a),n._commentArea.val(i),n._subject.val(l),n._submitButton.html(Site.ml_text["talk.editcomment"]),n.element.trigger("userpic",[s,r]),n._updateFormState())}function s(i){n._setCommentPending(e,!0),t.getJSON(LiveJournal.getAjaxUrl("get_comment_source",{thread:a,journal:Site.current_journal.username})).success(function(t){n._setCommentPending(e,!1),"ok"===t.status?i&&i(t.message,t.userpic_keyword,e.find(n.options.selectors.userpicImg).attr("src")):alert(t.message)}).error(function(){setTimeout(s.bind(null,i),200)})}if(e){var n=this,o=e.find(this.options.selectors.editLink),a=e.attr("id").substr(1);if(this.options.activeControl&&this.options.activeControl.find(this.options.selectors.addControlLink).html(Site.ml_text["talk.replytothis"]),this._isInState("edit",e))i(!1);else{var r=e.find(this.options.selectors.commentSubject).text();s(function(t,e,s){i(!0,t,e,s,r)})}}},comment:function(t,e){var i,s,n,o=this,a=this.options.selectors,r=this.options.classNames,l=function(t){t[0].parentNode.appendChild(o.element[0])},m=function(e,s){o._setOption("activeControl",s),o._inputs.replyTo.val(o.ditemid),o._inputs.parentTalkid.val(o.ditemid),o.element.data("parenttalkid",e.attr("id")||null),l(e),o.show(),"edit"===o._state&&"edit"!==t&&(o._commentArea.val(""),o._subject.val("")),o._state=t,o._node&&o._node.removeClass(r.activeComment),o._node=i,o._node.addClass(r.activeComment),Function.defer(function(){o._commentArea.focus()}),o._updateFormState()};if(e){if(i=e.closest(a.commentContainer),this.ditemid=Math.floor(parseInt(i.prop("id").substr(1),10)/256),i.hasClass(r.commentFrozen)||i.hasClass(r.commentScreened)&&"edit"!==t||i.hasClass(r.commentSpammed)&&!this._commentsRoot.hasClass(r.showSpam))return!1;n=this._inputs.viewingThread.data("thread"),n&&this._inputs.viewingThread.val(n),"add"===t&&this.options.isSubjectEnabled&&(s=o._getSubject(i),0!==s.length&&this._subject.val("RE: "+s.replace(/^RE:\s*/,"")))}else i=this._firstLevelCommentContainer,e=this._firstLevelParent,n=this._inputs.viewingThread.val(),this._inputs.viewingThread.val("").data("thread",n),this.ditemid="0",l=function(t){o.element.appendTo(t)};return this._isInState(t,i)?("edit"===this._state&&(this._commentArea.val(""),this._subject.val("")),this._closeForm(),!1):(this._node&&this._node.removeClass(r.editComment),this.hide(m.bind(null,i,e),e),this.element.removeClass(r.formEditComment).removeClass(r.formEditMyComment),!0)},_getSubject:function(t){var e=t.data("subject");return("undefined"==typeof e||null===e)&&(e=""),String(e).trim()},_showPreview:function(){var t=this.options.classNames,e=this._preview,i=this._commentArea,s=function(){LJ.Api.call("comment.preview",{body:i.val()},function(i){e.html(i.preview),e.addClass(t.previewVisible)})}.bind(this),n=LJ.Function.debounce(s,1e3);i.val()&&s(),i.on("keyup paste",n),LJ.Event.on("contentInsert",n)},_hidePreview:function(){this._preview.html(""),this._commentArea.off("keyup paste"),this._preview.removeClass(this.options.classNames.previewVisible),this._inputs.previewCheck.attr("checked",!1),LJ.Event.off("contentInsert")}})}(jQuery);
/* <<< file end: js/jquery/jquery.lj.commentform.js */

//# map link was there [jquery.lj.commentform.js.map]
/* >>> file start: js/jquery/jquery.lj.commentsOperations.js */
function _typeof(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}
LJ.UI.registerTemplate('templates-Widgets-deletecomment', "<div class=\"deletecomment\"> <h3 class=\"deletecomment-header\"> {{html LJ.mltext(\'comment.delete.deleting\')}} </h3> <div class=\"deletecomment-items\"> {{if $data.markSpam}} <label class=\" deletecomment-item deletecomment-item-spam \" > <input type=\"checkbox\" name=\"spam\" tabindex=\"100\" class=\"deletecomment-checkbox\" checked disabled > <span class=\"deletecomment-label\"> {{html LJ.mltext(\'comment.mark.spam.title\')}} </span> </label> {{/if}} <label class=\" deletecomment-item deletecomment-item-delete \" > <input type=\"checkbox\" name=\"delete\" tabindex=\"100\" class=\"deletecomment-checkbox\" checked disabled > <span class=\"deletecomment-label\"> {{html LJ.mltext(\'comment.delete.q\')}} </span> </label> {{if $data.canBan}} <label class=\" deletecomment-item deletecomment-item-ban \" > <input type=\"checkbox\" name=\"ban\" tabindex=\"100\" class=\"deletecomment-checkbox\" {{if $data.markSpam}} checked disabled {{/if}} > <span class=\"deletecomment-label\"> {{html LJ.mltext(\'comment.ban.user\', \'username\', $data.author)}} </span> </label> {{/if}} {{if $data.canDelThread}} <label class=\" deletecomment-item deletecomment-item-sub \" > <input type=\"checkbox\" name=\"delthread\" tabindex=\"100\" class=\"deletecomment-checkbox\" {{if $data.markSpam}} checked disabled {{/if}} > <span class=\"deletecomment-label\"> {{html LJ.mltext(\'comment.delete.all.sub\')}} </span> </label> {{/if}} {{if $data.canDelAuthor}} <label class=\" deletecomment-item deletecomment-item-author \" > <input type=\"checkbox\" name=\"delauthor\" tabindex=\"100\" class=\"deletecomment-checkbox\" {{if $data.markSpam}} checked disabled {{/if}} > <span class=\"deletecomment-label\"> {{if $data.author == $data.user}} {{html LJ.mltext(\'comment.delete.all.my\')}} {{else}} {{html LJ.mltext(\'comment.delete.all.author\', \'author\', $data.author)}} {{/if}} </span> </label> {{/if}} {{if $data.superBanFlag}} {{if $data.canBan}} <label class=\" deletecomment-item deletecomment-item-everywhere \" > <input type=\"checkbox\" name=\"deleverywhere\" tabindex=\"100\" class=\"deletecomment-checkbox\" {{if $data.markSpam}} checked disabled {{/if}} > <span class=\"deletecomment-label\"> {{html LJ.mltext(\'comment.delete.all.everywhere\', \'author\', $data.author)}} </span> </label> {{/if}} {{/if}} </div> <div class=\"deletecomment-buttons\"> <button type=\"submit\" tabindex=\"100\" class=\" b-flatbutton b-flatbutton-simple b-flatbutton-red delete-comment-button \" > {{if $data.markSpam}} {{html LJ.mltext(\'comment.delete.delete.spam\')}} {{else}} {{html LJ.mltext(\'comment.delete.delete\')}} {{/if}} </button> </div> </div> ", 'JQuery.stat');
!function(e,t){e.widget("lj.commentsOperations",jQuery.lj.basicWidget,{options:{selectors:{links:"a:not(.b-controls-track)",checkboxes:"input[type=checkbox]",comment:LJ.Util.isMediusJournal()?".mdspost-comment":".b-leaf",ctrlPopupClose:"button"},classNames:{alwaysShowControls:"b-leaf-herbarium",deleteClass:LJ.Util.isMediusJournal()?"mdspost-comment-controls__button--delete":"b-leaf-deleting",editLink:LJ.Util.isMediusJournal()?"mdspost-comment-controls__button--edit":"b-controls-edit",ctrlPopup:"b-leaf-deleting-bubble",processing:"b-leaf-processing",bestComment:LJ.Util.isMediusJournal()?"mdspost-comment-controls__button--best":"b-controls-best",bestCommentCancel:LJ.Util.isMediusJournal()?"mdspost-comment-controls__button--cancel_best":"b-controls-cancel_best"},templates:{ctrlPopup:"templates-Widgets-deletecomment"}},_create:function(){e.lj.basicWidget.prototype._create.apply(this);var t=location.href.match(/(\d+)\.html/);this._itemid=t&&t[1],this._authToken=this.element.data("authtoken"),this._ctrlPopup=jQuery("<div/>").bubble({classNames:{containerAddClass:this.options.classNames.ctrlPopup},alwaysShowUnderTarget:!0,arrowWidth:"auto"}),this._ctrlPopupCallback=null,this._bindControls()},_bindControls:function(){var t=this,o=this.options.selectors,n=this.options.classNames;e.lj.basicWidget.prototype._bindControls.apply(this),this.element.bind("commentpending",function(e,o,n){t._pending(o,n)}),this.element.delegate(o.links,"click",function(e){var s=jQuery(this).closest(o.comment);if(0!==s.length){if(s.hasClass(t.options.classNames.processing))return void e.preventDefault();var i=this.href.match(/(\w+)\.bml/),r=i&&i[1],a="",l=this,c=!1;if(this.className.indexOf(n.editLink)>-1)return t.element.trigger("editComment",[s]),void e.preventDefault();switch(-1!==this.className.indexOf(n.bestComment)&&(a="bestComment",r="set_best"),-1!==this.className.indexOf(n.bestCommentCancel)&&(a="bestComment",r="unset_best"),r){case"delcomment":a="delete",c=e.shiftKey,-1!==this.href.indexOf("spam=1")&&(r="markAsSpam");break;case"talkscreen":r=LiveJournal.parseGetArgs(this.href).mode,a="moderate";break;case"spamcomment":a="moderate"}a&&(e.preventDefault(),setTimeout(function(){t[a](l,r,s,c)},0))}});var s,i,r,a,l,c,m=function(e){return e.length>0&&e.attr("checked")};this._ctrlPopup.delegate(o.ctrlPopupClose,"click",function(){t._ctrlPopup.bubble("hide"),t._ctrlPopupCallback&&t._ctrlPopupCallback()}).bind("bubbleshow",function(){var e=t._ctrlPopup.bubble("option","target").closest(o.comment);e.addClass(n.alwaysShowControls),s=t._ctrlPopup.find("[name=delete]"),r=t._ctrlPopup.find("[name=delthread]"),i=t._ctrlPopup.find("[name=delauthor]"),a=t._ctrlPopup.find("[name=deleverywhere]"),l=t._ctrlPopup.find("[name=ban]"),c=t._ctrlPopup.find(o.ctrlPopupClose)}).bind("bubblehide",function(){var e=t._ctrlPopup.bubble("option","target").closest(o.comment);e.removeClass(n.alwaysShowControls).removeClass(n.deleteClass)}).delegate(o.checkboxes,"click",function(){this===a[0]&&m(a)&&i.attr("checked",!0),this!==i[0]||m(i)||a.attr("checked",!1)})},_pending:function(e,t){e.toggleClass(this.options.classNames.processing,!!t)},_getComment:function(e){return"object"!==("undefined"==typeof e?"undefined":_typeof(e))&&(e=jQuery(e)),0!==e.length?{node:e,ditemid:e.prop("id").substr(1),username:e.data("username"),displayname:e.data("displayname")}:void 0},_showDeletePopup:function(o,n,s){var i=this,r=LJ.get("remoteUser"),a=LJ.get("remote_is_maintainer"),l=jQuery(t),c=l.scrollTop();return function(e){return e}(),r?(i._ctrlPopup.html(i._tmpl("ctrlPopup",{ditemid:s.ditemid,author:s.username||"",user:r,markSpam:"markAsSpam"===n,canBan:s.username&&s.username!==r&&a,canDelThread:e.comments.hasChildren(s.node)&&a,superBanFlag:LJ.Flags.isEnabled("superban_step2"),canDelAuthor:s.username&&a})),this._ctrlPopupCallback=function(){s.props=[],i._ctrlPopup.find(":checkbox:checked").each(function(){s.props.push(this.name)}),i._removeComment(s)},s.node.addClass(this.options.classNames.deleteClass),i._ctrlPopup.bubble("option","target",jQuery(o)).bubble("option","name","deleteBubble").bubble("show"),void(LJ.Util.isMediusJournal()&&jQuery("body").hasClass("iphone")&&l.width()<=650&&LJ.Event.on("bubble:popup:hide:deleteBubble",function m(){setTimeout(function(){l.scrollTop(c),LJ.Event.off("bubble:popup:hide:deleteBubble",m)})}))):!0},_banUser:function(o,n){var s=function(e,s){jQuery.post(LiveJournal.getAjaxUrl("changerelation"),{target:o,action:"setBan",auth_token:e}).success(function(){t.ContextualPopup&&t.ContextualPopup.cleanCache(s),n&&n()})};e.getJSON(LiveJournal.getAjaxUrl("ctxpopup"),{user:o,mode:"getinfo"}).success(function(e){e.setBan_authtoken&&s(e.setBan_authtoken,[String(e.userid),e.username,e.url_userpic])})},_removeComment:function(e){var t=this,o=LiveJournal.getAjaxUrl("delcomment",LiveJournal.parseGetArgs(e.postLink)),n={confirm:"1",lj_form_auth:this._authToken,format:"json"},s=!1,i=!1;e.props&&e.props.forEach(function(e){"ban"!==e?(n[e]="1",i=!0):s=!0}),this._pending(e.node,!0),s&&(Site.current_journal.is_comm?n.ban=1:this._banUser(e.node.data("username"),function(){i||t.element.trigger("refreshThread",[e.ditemid,!0,"delmany"])})),i&&jQuery.post(o,n,function(o){var s="";n.delauthor&&(s=e.node.data("username")),"ok"===o.status?t.element.trigger("deleteComment",[e.ditemid,n.delthread,s]):alert(o.message)},"json")},"delete":function(e,t,o,n){var s=this._getComment(o);s&&(s.postLink=e.href,n?(s.props=["delete"],this._removeComment(s)):this._showDeletePopup(e,t,s))},bestComment:function(e,t,o){var n=this._getComment(o),s=this;n&&(this._pending(o,!0),LJ.Api.call("comment."+t,{journalid:LJ.get("journal.id"),itemid:this._itemid,talkid:n.ditemid},function(e){e.error&&(alert(e.error.message),location.reload()),s.element.trigger("refreshThread",[n.ditemid,!0,t])}))},moderate:function(e,t,o){var n=this._getComment(o),s=this;if(n){var i="spamcomment"===t?"spamcomment":"talkscreen",r=LiveJournal.getAjaxUrl(i,LiveJournal.parseGetArgs(e.href)),a={confirm:"Y",lj_form_auth:this._authToken};r+="&format=json",this._pending(o,!0),jQuery.post(r,a,function(e){if("ok"!==e.status)throw new Error(e.message);return"spamcomment"===t?void s.element.trigger("removeFromDOM",[n.ditemid,t]):void s.element.trigger("refreshThread",[n.ditemid,!t.match(/(un)?freeze/),t])},"json")}}})}(jQuery,window);
/* <<< file end: js/jquery/jquery.lj.commentsOperations.js */

//# map link was there [jquery.lj.commentsOperations.js.map]
/* >>> file start: js/jquery/jquery.lj.commentsMassActions.js */
function _typeof(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}
//= require js/jquery/jquery.hotkeys.js
!function(e,t){e.widget("lj.commentsMassActions",jQuery.lj.basicWidget,{options:{selectors:{form:"#multiform",massActions:".b-massaction",massActionsMobile:".b-massaction-mobile",ljButtons:".b-massaction .b-ljbutton button",ljButtonsMobile:".b-massaction-mobile .b-ljbutton button",massActionsCheckAll:".b-massaction-checkall input",checkboxes:LJ.Util.isMediusJournal()?".js-comment-checkbox":".b-leaf-actions-checkbox",links:"a",comment:LJ.Util.isMediusJournal()?".mdspost-comment":".b-leaf",firstLevel:".b-tree-twig-1",twig:LJ.Util.isMediusJournal()?".mdspost-thread":".b-tree-twig",twigSelected:".b-tree-twig-selected",massOperationsAnchor:".b-massaction-anchor",ljtimes:"#ljtime",ditemid:"#ditemid",error:".b-massaction-error"},classNames:{hidden:"b-grove-3comments",massActionsFixed:"b-massaction-fixed",commentSelected:"b-leaf-selected",twigSelected:"b-tree-twig-selected",preload:"b-massaction-processing",error:"b-massaction-problems"}},_create:function(){e.lj.basicWidget.prototype._create.apply(this);var t=this.options.selectors;this._authToken=this.element.data("authtoken"),this._massActions=this.element.find(t.massActions),this._massActionsCheckAll=this.element.find(t.massActionsCheckAll),this._massActionsAnchor=this.element.find(t.massOperationsAnchor),this._ljtimes=jQuery(t.ljtimes),this._ditemid=this.element.find(t.ditemid).val(),this._form=this.element.find(t.form),this._buttons=this.element.find(t.ljButtons),this._hidden=this.element.hasClass(this.options.classNames.hidden),this._setActive(!1),this._bindControls()},_bindControls:function(){var s=this,i=this.options.selectors;e.lj.basicWidget.prototype._bindControls.apply(this),this.element.delegate(i.checkboxes,"click",function(){var e=jQuery(this),t=this.checked;s._markChecked(e,t),LJ.Util.isMediusJournal()&&(e=e.closest(i.comment).find(i.checkboxes)),Function.defer(s._updateBoxes.bind(s),e,t)}),this._el("ljButtons").on("click",function(e){s._massAction(this.getAttribute("data-value")),e.preventDefault()}),this._el("ljButtonsMobile").on("click",function(e){var t=this.getAttribute("data-value").toLowerCase();"collapse-all"===t&&s.collapseAll(),"expand-all"===t&&s.expandAll(),e.preventDefault()}),this._massActionsCheckAll.click(function(){Function.defer(s._updateBoxes.bind(s),s.element.find(i.checkboxes),this.checked)}),jQuery(t).bind("scroll resize",this._checkMassActionsPanelPosition.bind(this)),this.element.bind("commentsUpdated",this._updateMassActionsPanel.bind(this,!1)).bind("newComment",this._checkVisibility.bind(this)),jQuery(document).bind("keyup","alt+ctrl++",this.expandAll.bind(this)).bind("keyup","alt+ctrl+-",this.collapseAll.bind(this))},_checkVisibility:function(){Function.defer(function(){this._hidden&&this.element.find(this.options.selectors.comment).length>2&&(this.element.removeClass(this.options.classNames.hidden),this._hidden=!1)}.bind(this))},_setPending:function(e){this._buttons.attr("disabled",!!e),this.element.toggleClass(this.options.classNames.preload,!!e),e&&this._massActions.removeClass(this.options.classNames.error)},_setActive:function(e){this._panelFixed=!!e,this._buttons.attr("disabled",!e)},_findTopChecked:function(){var t,s=this.options.selectors,i=this.element.find(s.twigSelected),n=0,o=jQuery();return i.each(function(){var i=jQuery(this),c=e.comments.level(i);n&&c>n&&t&&e.comments.isChild(i,t)||(n=c,o=o.add(i.find(s.comment)),t=i)}),o},_massAction:function(e){e=e.toLowerCase();var t,s=this,i=LiveJournal.constructUrl(LiveJournal.getAjaxUrl("talkmulti"),{format:"json"}),n={confirm:"1",lj_form_auth:this._authToken,mode:e,ditemid:this._ditemid,journal:Site.currentJournal},o=this._form.get(0).elements,c=[];if(["collapse","expand","freeze","unfreeze"].indexOf(e)>-1&&this._findTopChecked().each(function(){c.push(this.getAttribute("id"))}),["screen","unscreen","freeze","unfreeze","delete","deletespam","unspam"].indexOf(e)>-1)for(var l=!/((un)?freeze)/.test(e),a=0,h=o.length;h>a;++a)o[a].name.match(/selected_\d+/)&&o[a].checked&&(n[o[a].name]="on",l&&c.push(o[a].id));return"collapse"===e||"expand"===e?(t=LJ.Function.threshold(function(t){s.element.trigger(e,[t,!0])},20,!0),c.forEach(t),this._setPending(!1),void this._updateBoxes(this.element.find(this.options.selectors.checkboxes+":checked"),!1)):(this._setPending(!0),void(0!==c.length&&jQuery.post(i,n,function(t){if(s._setPending(!1),"ok"===t.status)if("unspam"===e){var i=c.map(function(e){return e.substr(1)});s.element.trigger("removeFromDOM",[i,"unspam"])}else s._refreshComments(e,c);else s.element.find(s.options.selectors.error).html(t.message),s._massActions.addClass(s.options.classNames.error)},"json")))},_refreshComments:function(e,t){var s=t.map(function(e){return e.substr(1)}),i=this;s.forEach(function(t){Function.defer(function(){e.match(/^delete/)?i.element.trigger("deleteComment",[t]):i.element.trigger("refreshThread",[t,!e.match(/^(un)?freeze/),e])})})},_checkMassActionsPanelPosition:function(){var e=jQuery.browser.msie&&jQuery.browser.version.substr(0,1)<9?document.documentElement.scrollTop:t.pageYOffset,s=0,i=this.options.classNames.massActionsFixed;this._panelFixed?(s=this._massActionsAnchor.offset().top,this._massActions.hasClass(i)&&(s+=this._massActions.height()),s+this._ljtimes.height()>jQuery(t).height()+e?this._massActions.addClass(i):this._massActions.removeClass(i)):this._massActions.removeClass(i)},_updateBoxes:function(e,t){var s=this;e.each(function(){this.checked=t,s._markChecked(jQuery(this),t)}),this._updateMassActionsPanel(t)},_markChecked:function(e,t){t=!!t;var s=this.options.selectors,i=this.options.classNames,n=e.closest(s.comment);t&&n.hasClass(i.commentSelected)||n.toggleClass(i.commentSelected,t).closest(s.twig).toggleClass(i.twigSelected,t)},_updateMassActionsPanel:function(e){var t=this.options.selectors,s=this.options.classNames.massActionsFixed;0===this._ljtimes.length&&(this._ljtimes=jQuery(t.ljtimes));var i=this._panelFixed;this._setActive(!!e||this.element.find(t.checkboxes+":checked:first").length>0),this._checkMassActionsPanelPosition(),this._panelFixed&&this._massActions.hasClass(s)&&(i||this._massActions.hide().fadeIn(100));var n=e&&0===this.element.find(t.checkboxes+":not(:checked):first").length;this._massActionsCheckAll.attr("checked",n)},_getComment:function(e){return"object"!==("undefined"==typeof e?"undefined":_typeof(e))&&(e=jQuery(e)),0!==e.length?{node:e,ditemid:e.prop("id").substr(1),username:e.data("username"),displayname:e.data("displayname")}:void 0},_toggleAll:function(e){var t=this,s=LJ.Function.threshold(function(s){t.element.trigger(e,[s,!0])},20,!0);s.batch(2),this.element.find(this.options.selectors.firstLevel).each(function(){s(this.getAttribute("data-tid"))})},expandAll:function(){this._toggleAll("expand")},collapseAll:function(){this._toggleAll("collapse")}})}(jQuery,window);
/* <<< file end: js/jquery/jquery.lj.commentsMassActions.js */

//# map link was there [jquery.lj.commentsMassActions.js.map]
