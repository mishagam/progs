(function(g,f,B){if(!g.hpmd||!g.hpmd.INITIALIZED){var R="https:"==location.protocol?"https:":"http:",k,s=null,y=[],S,I,l,t,T=!1,m={view:[],expand:[],collapse:[],interstitial:[]},u=0,p,U,V=!0,q,n,W=!!g.hpmd,C={},X={},J=[],v=W?hpmd:[],z=function(a){a.method||(a.method="POST");a.url||(a.url=R+"//banner.hpmdnetwork.ru/");a.data?"string"==typeof a.data?a.type||(a.type="application/x-www-form-urlencoded"):(a.data=JSON.stringify(a.data),a.type||(a.type="application/json")):a.data="";var b=new XMLHttpRequest;
b.open(a.method,a.url,!0);b.withCredentials=!0;a.type&&b.setRequestHeader("Content-Type",a.type);a.success&&(b.onreadystatechange=function(){if(4==this.readyState){try{this.json=JSON.parse(this.responseText)}catch(b){this.json=null}a.success.bind(this).call()}});b.send(a.data)},w=function(a,b,d){var c="";d&&(c="; expires="+(new Date((new Date).valueOf()+1E3*d)).toUTCString());f.cookie=a+"="+b+"; path=/; domain="+t+c},K=function(a){try{a()}catch(b){g.console&&console.log("hpmd: callback error:",b)}},
Y=function(a,b){if("undefined"==typeof m[a])throw Error("Unknown event "+a);m[a].push(b)},Z=function(a,b){if("undefined"==typeof m[a])throw Error("Unknown event "+a);for(var d=0;d<m[a].length;d++)m[a][d]===b&&(m[a][d]=null)},E=function(a,b){if("close"==a){if(L(),0!=y.length){var d=y[0];y=y.slice(1);M(d);D(d)}}else for(d=0;d<m[a].length;d++)if(m[a][d])try{m[a][d](b)}catch(c){}},F=[],N,G=function(a){F.push(a);var b=function(){if(f.body){for(var a=0;a<F.length;a++)F[a]();F=[]}else N||(N=setTimeout(function(){N=
null;b()},300))};b()},A=[],x=function(){switch(f.readyState){case "interactive":case "complete":f.removeEventListener("DOMContentLoaded",x);f.removeEventListener("readystatechange",x);g.removeEventListener("load",x);for(var a=0;a<A.length;a++)G(A[a]);A=[]}},fa=function(a){switch(f.readyState){case "interactive":case "complete":G(a);break;default:A.push(a),1==A.length&&(f.addEventListener("DOMContentLoaded",x),f.addEventListener("readystatechange",x),g.addEventListener("load",x))}},O=[],ga=function(){for(var a=
0;a<O.length;a++)O[a]();$=function(a){a()}},$=function(a){O.push(a)},D=function(a,b){G(function(){if(!b){try{L()}catch(d){}q=a}a.nodes=[];var c=f.createElement("style");c.setAttribute("type","text/css");c.innerHTML=a.data.css;f.getElementsByTagName("head")[0].appendChild(c);a.nodes.push(c);c=f.createElement("div");for(c.innerHTML=a.data.html;0<c.children.length;)a.nodes.push(c.children[0]),f.body.appendChild(c.children[0]);try{B(a.data.js)(a.hpmd),b&&aa(a)}catch(e){if(a.imitation)a.onException(e);
else a.hpmd.trackEvent("hpmd.js-exception",{exception:{name:e.name,message:e.message,source:{file:e.fileName,line:e.lineNumber,char:e.columnNumber},stack:e.stack.toString()}}),g.console&&console.log("hpmd.banner: error: ",e)}})},ba=function(a,b){var d=function(c){var e=c.target||c.srcElement;if(e){var h=!1;do h=!!e.tagName&&"a"==e.tagName.toLowerCase(),h||(e=e.parentNode);while(e&&!h);if(h&&(!e.getAttribute("target")||"_self"==e.getAttribute("target"))){for(h=e;h&&h.getAttribute;){if(h.getAttribute("id")&&
0==h.getAttribute("id").indexOf("hpmd")||-1<h.className.indexOf("hpmd"))return;h=h.parentNode}if((e=e.getAttribute("href"))&&!(-1<e.indexOf("#"))&&(f.documentElement.removeEventListener("click",d),a(e),b)){try{c.preventDefault()}catch(g){}try{c.stopPropagation()}catch(P){}return!1}}}};f.documentElement.addEventListener("click",d)},aa=function(a){ba(function(b){!p&&k&&L();S=b;!p&&k&&M(a,function(){E("interstitial")});a.hpmd.data.openBanner()},!0)},ha=function(){ba(function(){w("hpmd_if","1",86400)},
!1)},L=function(){if(q){if(q.hpmd.data.destroy&&"function"==typeof q.hpmd.data.destroy)try{q.hpmd.data.destroy()}catch(a){}for(var b=0;b<q.nodes.length;b++)try{q.nodes[b].parentNode.removeChild(q.nodes[b])}catch(d){}}},M=function(a,b){z({data:{method:"ad.view",data:{view_id:a.view.id,hash:a.view.hash,uid:l}},success:function(){var d=this.json;!0===d.success&&(a.viewAllocated(d.data.view_id),b&&b())}})},ia=function(){var a;if(f.referrer){var b;a=(b=/\/\/([^\/]+)\//.exec(f.referrer))?b[1]==t||b[1].indexOf("."+
t)==b[1].length-t.length-1?!1:!0:!1}else a=!0;b=!/hpmd_session=/.exec(f.cookie);w("hpmd_session","1",1800);return a&&b},ca=function(a){for(var b,d,c=0;c<a.length;c++){b=a[c];switch(b.type){case "native":d=r(1);break;case "native_wrapper":d=r(2);break;default:d=null}try{b.id&&(X[b.id]=d),function(a,b){var d=function(){B(a.js)(b)};G(d);"native_wrapper"==a.type&&(fa(d),g.addEventListener("load",function(){d();g.removeEventListener("load",d)}))}(b,d)}catch(e){g.console&&console.log("hpmd.plugins."+b.type,
": error:",e)}}},ja=function(a){X.native.slotReady(a)},Q=[],ka=function(a){for(var b=0;b<a.length;b++)r(0,a[b]),"interstitial"==a[b].format&&(T=!0),"number"==typeof a[b].view?D(a[b],"interstitial"==a[b].format):"interstitial"==a[b].format?D(a[b],!0):"native"==a[b].format?Q.push(a[b]):y.push(a[b]);a.length&&(n=a[0],da())},ea=function(a){var b={uid:l,site_id:k,url:location.href.toString(),new_session:ia()};s&&(b.section_id=s);if(p)if(V)b.demo=p,V=!1;else return;u&&(b.native=u);a&&(b.context={},["format",
"subformat","except_format","formats"].map(function(d){a[d]&&(b.context[d]=a[d])}));z({data:{method:"ad.get",data:b},success:function(){var b=!1;try{var c=this.json;if(!0===c.success){c.data.uid&&(l=parseInt(c.data.uid),w("hpmd_uid2",l,31536E3));-1<f.cookie.indexOf("hpmd_if=1")&&(w("hpmd_if","",-86400),z({data:{method:"ad.capacity",data:{site_id:k,type:"interstitial",uid:l,url:location.href.toString()}}}));c.data.segment&&(C=c.data.segment,C.site=k);c.data.config&&c.data.config.site&&(I=c.data.config.site);
if(b=!!c.data.banners&&!!c.data.banners.length){if(1==u){for(var e=c.data.banners.length,h=0;h<9*e;h++)c.data.banners[c.data.banners.length]=c.data.banners[h%e];var g={"small-square":5,small:4,expand:3,expandable:2,stretch:1};c.data.banners=c.data.banners.sort(function(a,b){return g[b.data.subformat]-g[a.data.subformat]})}ka(c.data.banners)}c.data.plugins&&c.data.plugins.length&&(ca(c.data.plugins),0<J.length&&ca(J));T||ha()}if(2==u){var P=f.createElement("script");P.setAttribute("src","//misc-dev.hpmdnetwork.ru/native/debug/merge.js?"+
Math.random());f.getElementsByTagName("head")[0].appendChild(P)}}catch(m){}p||E("view",{hasBanner:b,isCommercial:!0,uid:l,context:a});ga()}})},la=function(){U=!0},ma=function(a){ea(a)},na=function(a){var b=[],d=[],c=[];a.viewAllocated=function(e){a.view=e;a.hpmd.trackEvent=function(b,d){z({data:{method:"ad.event",data:{uid:l,banner_id:a.data.id,site_id:k,section_id:s,url:location.href.toString(),view:a.view,event:b,data:"undefined"==typeof d?null:d}}})};a.hpmd.trackLink=function(b,d,c,e){c||(c={});
b=a.hpmd.prepareLink(b,d,e);c.newWindow?g.open(b,c.name?c.name:null,c.specs?c.specs:null,!!c.replace):location.href=b};a.hpmd.prepareLink=function(b,d,c){b=R+"//banner.hpmdnetwork.ru/track/event?uid="+l+"&banner_id="+a.data.id+"&site_id="+k+"&view="+a.view+"&event="+encodeURIComponent(b)+"&redirect_uri="+encodeURIComponent(d)+"&url="+encodeURIComponent(location.href.toString());s&&(b+="&section_id="+s);c="undefined"==typeof c?null:c;null!==c&&(b+="&data="+encodeURIComponent(JSON.stringify(c)));
return b};a.hpmd.ready=function(a){a()};a.hpmd.asyncPrepareLink=function(b,c,d){arguments[arguments.length-1](a.hpmd.prepareLink.apply(this,[].slice.call(arguments,0,arguments.length-1)))};for(e=0;e<b.length;e++)a.hpmd.trackEvent.apply(this,b[e]);for(e=0;e<d.length;e++)a.hpmd.trackLink.apply(this,d[e]);for(e=0;e<c.length;e++)c[e]();c=d=b=null};"number"==typeof a.view?a.viewAllocated(a.view):(a.hpmd.trackEvent=function(){b.push([].slice.call(arguments))},a.hpmd.trackLink=function(){d.push([].slice.call(arguments))},
a.hpmd.prepareLink=function(){throw Error("hpmd.banner: this banner has not been initialized yet");},a.hpmd.ready=function(a){c.push(a)},a.hpmd.asyncPrepareLink=function(){var b=[].slice.call(arguments);a.hpmd.ready(function(){a.hpmd.asyncPrepareLink.apply(this,b)})})},H=function(a){return C[a]},oa=function(a){z({data:{method:"ad.sysview",data:{banner_id:a.data.id,view_buffer_id:a.view.id,site_id:k,section_id:s,uid:l,url:location.href.toString()}}})},r=function(a,b){switch(a){case 3:return{push:K,
events:{add:Y,remove:Z,fire:function(a,b){E(a,b)}},requestBanners:ma,mute:la,INITIALIZED:!0};case 0:return b.hpmd={data:{},getSegment:H,push:K,events:{add:Y,remove:Z,fire:function(a,c){"interstitial"==b.format&&"close"==a?location.href=S:E(a,c)}}},na(b),"native"==b.format&&(b.allocateView=function(){M(b);delete b.allocateView}),function(a){var b;b=I?B(I)():{zIndex:{active:1E6,inactive:1E6}};a.getConfig=function(){return b}}(b.hpmd),k||(b.hpmd.setSegments=function(a){C=a}),b.hpmd;case 1:return{getSegment:H,
banners:Q,eval:B,sysview:oa};case 2:return{getSegment:H,slotReady:ja}}},da=function(){if(W&&(!g.hpmd||!g.hpmd.INITIALIZED)&&(k&&50!=k?hpmd=r(3):(hpmd=n?n.hpmd:k?r(3):r(0,{}),hpmd.initializeInterstitial=function(){aa({hpmd:hpmd})},p&&(hpmd.getViewId=function(){return n.view}),hpmd.imitate=function(a,d){var c=function(){var c={data:{id:1,html:a.html,css:a.css,js:a.js,subformat:a.subformat},placement:a.placement,format:a.format,view:1,imitation:!0,onException:a.onException};r(0,c);"native"==c.format?
Q.push(c):D(c,"interstitial"==c.format);d&&d()};"native"==a.format?c():$(c)},hpmd.imitatePlugins=function(a){J.push(a)}),u)){if(n)hpmd.trackEvent=n.hpmd.trackEvent,hpmd.trackLink=n.hpmd.trackLink,hpmd.prepareLink=n.hpmd.prepareLink,hpmd.asyncPrepareLink=n.hpmd.asyncPrepareLink;else{var a={data:{id:0}};r(0,a);hpmd.trackEvent=a.hpmd.trackEvent;hpmd.trackLink=a.hpmd.trackLink;hpmd.prepareLink=a.hpmd.prepareLink;hpmd.asyncPrepareLink=a.hpmd.asyncPrepareLink}hpmd.getSegment=H}};(function(){var a=1,b=location.host.split(".").length,
d;do{t=location.host.split(".").splice(b-a,b).join(".");d=Math.random();f.cookie="hpmd_tmp="+d+"; path=/; domain="+t;if(-1<f.cookie.indexOf("hpmd_tmp="+d))return;a++}while(a<=b);t=location.host})();(function(){for(var a=f.getElementsByTagName("script"),b=0;b<a.length;b++)if(a[b].hasAttribute("src")&&-1!=a[b].getAttribute("src").indexOf(".hpmdnetwork.ru")){var d=/client\/(\d+)\.(min\.)?js/.exec(a[b].getAttribute("src"));if(d&&d[1]){k=parseInt(d[1]);break}}})();(function(){var a;if(a=/hpmd_demo=(\d+)\.([a-f0-9]{40})(\.\w+)?/.exec(location.href))p=
{banner_id:parseInt(a[1]),hash:a[2]},a[3]&&(p.extra=a[3].substring(1,1E3));if(a=/hpmd_bind_native=([012])/.exec(location.href))"0"==a[1]?w("hpmd_bind","",-86400):(u=parseInt(a[1]),w("hpmd_bind",a[1]));else if(a=/hpmd_bind=([012])/.exec(f.cookie))u=parseInt(a[1])})();(function(){var a;if(a=/hpmd_uid2=(\d+)(;|$)/.exec(f.cookie))l=parseInt(a[1])})();da();(function(){if(v.length)for(var a=0;a<v.length;a++)if(v[a])switch(typeof v[a]){case "string":0==v[a].indexOf("s/")&&(s=parseInt(v[a].substring(2,1E3)));
break;case "function":K(v[a])}})();U||ea()}})(window,document,function(){return function(g){return eval("(function(hpmd){"+g+"})")}}());
