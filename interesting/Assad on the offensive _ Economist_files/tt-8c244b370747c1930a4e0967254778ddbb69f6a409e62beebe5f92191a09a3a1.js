(function(){if(!Array.prototype.indexOf)Array.prototype.indexOf=function(obj,fromIndex){if(fromIndex==null)fromIndex=0;else if(fromIndex<0)fromIndex=Math.max(0,this.length+fromIndex);for(var i=fromIndex,j=this.length;i<j;i++)if(this[i]===obj)return i;return-1};var ttDiv=document.createElement("div");ttDiv["id"]="totaltagdiv";var tt_scripts=document.getElementsByTagName("script");var tt_index=tt_scripts.length-1;var tt_myScript=tt_scripts[tt_index];if(tt_myScript!=null)tt_myScript.parentNode.insertBefore(ttDiv,
tt_myScript);var referrerToAssetUrl={"http://economist.com/":{"html":2396319},"http://discover.economist.com/index.html":{"html":2396318},"http://discover.economist.com/":{"html":2396316},"http://economist.com/subscriptions/thankyou":{"html":2396320},"https://subscriptions.economist.com/asia/reg/mon/brdrtg/index.php":{"html":2396322},"https://subscriptions.economist.com/asia/reg/qtr/brdrtg/index.php":{"html":2396323},"https://subscriptions.economist.com/CEMEA/EI/brd_rmkt/":{"html":2396324},"https://subscriptions.economist.com/CEMEA/EI/brd_rmkt/#step1":{"html":2396325},
"https://subscriptions.economist.com/CEMEA/EI/brd_rmkt/index.php":{"html":2396326},"https://subscriptions.economist.com/LA/DISP/Re_Brd/":{"html":2396327},"https://subscriptions.economist.com/LA/DISP/Re_Brd/#step1":{"html":2396328},"https://subscriptions.economist.com/LA/DISP/Re_Brd/index.php":{"html":2396329},"https://subscriptions.economist.com/uk/brd1014rtrgtg/":{"html":2396330},"https://subscriptions.economist.com/uk/brd1014rtrgtg/index.php":{"html":2396331},"https://subscriptions.economist.com/US/DISP/GDA/BRrt/":{"html":2396332},
"https://subscriptions.economist.com/US/DISP/GDA/BRrt/#step1":{"html":2396333},"https://subscriptions.economist.com/US/DISP/GDA/BRrt/index.php":{"html":2396334}};var wildcardToAssetUrl={"^http://.*business.*$":{"html":2396307},"^http://.*politics.*$":{"html":2396311},"^http://.*finance.*$":{"html":2396310},"^http://.*education.*$":{"html":2396309},"^http://.*economics.*$":{"html":2396308},"^http://.*technology.*$":{"html":2396315},"^http://.*subscriptions.*$":{"html":2396314},"^http://.*school.*$":{"html":2396313},
"^http://.*register.*$":{"html":2396312},"^http://discover\\.economist\\.com/\\#.*$":{"html":2396317},"^http://registration.*$":{"html":2396321}};var allowedParams=[];var expectedDomains=["discover.economist.com","economist.com","stage.economist.com","subscriptions.economist.com"];function totaltag(url){var totalTagDiv=document.getElementById("totaltagdiv");totalTagDiv.innerHTML="";var tempUrl=url.replace(/ /,"").replace(/\|/,"%7C");tempUrl=tempUrl.replace(/^(https?):\/\/(www\.)?/i,"$1://").replace(/;jsessionid=[^;?]*/,
"");var urlparts=tempUrl.split("?");if(urlparts.length>=2&&allowedParams.length!=0){var parameterArray=[];for(var param in allowedParams){var urlParameter=encodeURIComponent(allowedParams[param])+"\x3d";var pars=urlparts[1].split(/[&;]/g);for(var i=pars.length;i-- >0;)if(pars[i].indexOf(urlParameter,0)==0){parameterArray.push(pars[i]);break}if(parameterArray.length>0)tempUrl=urlparts[0]+"?"+parameterArray.sort().join("\x26");else tempUrl=urlparts[0]}}else tempUrl=urlparts[0];var urlDomain,assetUrl,
isInvalidUrl=false,domainValid=true;try{urlDomain=urlparts[0].match(/:\/\/(.[^\/]+)/)[1]}catch(err){urlDomain=tempUrl;isInvalidUrl=true}if(expectedDomains.length!=0&&expectedDomains.indexOf(urlDomain)==-1)domainValid=false;if(domainValid){if(!isInvalidUrl){var tempA=document.createElement("a");tempA.href=tempUrl;tempUrl=tempA.href}assetUrl=referrerToAssetUrl[tempUrl];var tt_regex=/([^\?]*)(\?.*)/;var match=tt_regex.exec(tt_myScript.src);var tt_queryParams=match!=null?match[2]:"";var extraParams=[];
if(document.referrer!="")extraParams.push("httpReferrer\x3d"+encodeURIComponent(document.referrer));extraParams.push("httpLocation\x3d"+encodeURIComponent(url));if(typeof prop11!=="undefined")extraParams.push("prop11\x3d"+prop11);if(extraParams.length>0)if(tt_queryParams==="")tt_queryParams="?"+extraParams.join("\x26");else tt_queryParams=tt_queryParams+"\x26"+extraParams.join("\x26");var source;if(assetUrl!=null){var htmlAsset=assetUrl["html"];if(htmlAsset!=null){source="//tt.mbww.com/tt-8c244b370747c1930a4e0967254778ddbb69f6a409e62beebe5f92191a09a3a1/15415/"+
htmlAsset+".html"+tt_queryParams;populateDynamiciFrame(source,totalTagDiv)}var jsAsset=assetUrl["js"];if(jsAsset!=null){source="//tt.mbww.com/tt-8c244b370747c1930a4e0967254778ddbb69f6a409e62beebe5f92191a09a3a1/15415/"+jsAsset+".js"+tt_queryParams;loadEmbeddedScript(source,totalTagDiv)}}for(var w in wildcardToAssetUrl){var asset=wildcardToAssetUrl[w];re=new RegExp(w,"i");if(tempUrl.match(re)){assetUrl=asset;var htmlWAsset=assetUrl["html"];if(htmlWAsset!=null){source="//tt.mbww.com/tt-8c244b370747c1930a4e0967254778ddbb69f6a409e62beebe5f92191a09a3a1/15415/"+
htmlWAsset+".html"+tt_queryParams;populateDynamiciFrame(source,totalTagDiv)}var jsWAsset=assetUrl["js"];if(jsWAsset!=null){source="//tt.mbww.com/tt-8c244b370747c1930a4e0967254778ddbb69f6a409e62beebe5f92191a09a3a1/15415/"+jsWAsset+".js"+tt_queryParams;loadEmbeddedScript(source,totalTagDiv)}}}source="//tt.mbww.com/tt-8c244b370747c1930a4e0967254778ddbb69f6a409e62beebe5f92191a09a3a1/15415/global.html"+tt_queryParams;populateDynamiciFrame(source,totalTagDiv)}}function loadEmbeddedScript(source,totalTagDiv){var s=
document.createElement("script"),e=document.getElementsByTagName("script")[0];s.type="text/javascript";s.async=true;s.src=source;e.parentNode.insertBefore(s,e)}function populateDynamiciFrame(sourceUrl,tdiv){var iFrame=document.createElement("iframe");tdiv.appendChild(iFrame);iFrame["src"]=sourceUrl;iFrame.style.display="none";return true}totaltag(document.location.href);window["totaltag"]=totaltag})();
